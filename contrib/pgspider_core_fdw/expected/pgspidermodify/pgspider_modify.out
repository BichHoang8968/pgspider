\set ECHO none
--Testcase 1:
SET datestyle = ISO;
--Testcase 2:
SET timezone = 'UTC';
--Testcase 3:
DELETE FROM pg_spd_node_info;
--Testcase 4:
CREATE EXTENSION pgspider_core_fdw;
--Testcase 5:
CREATE SERVER pgspider_svr FOREIGN DATA WRAPPER pgspider_core_fdw OPTIONS (host :PGSPIDER_SERVER1);
--Testcase 6:
CREATE USER MAPPING FOR CURRENT_USER SERVER pgspider_svr;
-- Extensions
--Testcase 7:
CREATE EXTENSION postgres_fdw;
--Testcase 8:
CREATE EXTENSION sqlite_fdw;
--Testcase 9:
CREATE EXTENSION tinybrace_fdw;
--Testcase 10:
CREATE EXTENSION mysql_fdw;
--Testcase 11:
CREATE EXTENSION oracle_fdw;
--Testcase 12:
CREATE EXTENSION odbc_fdw;
--Testcase 13:
CREATE EXTENSION jdbc_fdw;
--Testcase 14:
CREATE EXTENSION griddb_fdw;
--Testcase 15:
CREATE EXTENSION mongo_fdw;
--Testcase 16:
CREATE EXTENSION dynamodb_fdw;
--Testcase 17:
CREATE EXTENSION file_fdw;
-- Used data sources
-- Data sources
-- tntbl1: postgres_svr, mysql_svr, tiny_svr, oracle_svr, sqlite_svr
-- key: c1, c2
--Testcase 18:
CREATE SERVER postgres_svr FOREIGN DATA WRAPPER postgres_fdw OPTIONS (host :POSTGRES_SERVER, port :POSTGRES_PORT, dbname 'pg_modify_db');
--Testcase 19:
CREATE USER mapping for public SERVER postgres_svr OPTIONS(user :POSTGRES_USER, password :POSTGRES_PASS);
--Testcase 20:
CREATE SERVER mysql_svr FOREIGN DATA WRAPPER mysql_fdw OPTIONS (host :MYSQL1_SERVER, port :MYSQL_PORT);
--Testcase 21:
CREATE USER mapping for public SERVER mysql_svr OPTIONS(username :MYSQL_USER, password :MYSQL_PASS);
--Testcase 22:
CREATE SERVER tiny_svr FOREIGN DATA WRAPPER tinybrace_fdw OPTIONS (host :TINYBRACE_SERVER, port :TINYBRACE_PORT, dbname 'pgmodifytest.db');
--Testcase 23:
CREATE USER mapping for public SERVER tiny_svr OPTIONS(username :TINYBRACE_USER, password :TINYBRACE_PASS);
--Testcase 24:
CREATE SERVER oracle_svr FOREIGN DATA WRAPPER oracle_fdw OPTIONS (dbserver :ORACLE_SERVER, isolation_level 'read_committed', nchar 'true');
--Testcase 25:
CREATE USER MAPPING FOR public SERVER oracle_svr OPTIONS (user :ORACLE_USER, password :ORACLE_PASS);
--Testcase 26:
CREATE SERVER sqlite_svr FOREIGN DATA WRAPPER sqlite_fdw OPTIONS (database '/tmp/pgmodifytest.db');
-- tntbl2: odbc_post_svr, jdbc_mysql_svr, griddb_svr, mongo_svr, dynamodb_svr
-- key: _id
--Testcase 27:
CREATE SERVER odbc_mysql_svr FOREIGN DATA WRAPPER odbc_fdw OPTIONS (odbc_DRIVER :ODBC_MYSQL_DRIVERNAME, odbc_SERVER :ODBC_MYSQL_SERVER, odbc_port :ODBC_MYSQL_PORT, odbc_DATABASE :ODBC_DATABASE);
--Testcase 28:
CREATE USER mapping for public SERVER odbc_mysql_svr OPTIONS(odbc_UID :ODBC_MYSQL_USER, odbc_PWD :ODBC_MYSQL_PASS);
--Testcase 29:
CREATE SERVER odbc_post_svr FOREIGN DATA WRAPPER odbc_fdw OPTIONS (odbc_DRIVER :ODBC_POSTGRES_DRIVERNAME, odbc_SERVER :ODBC_POSTGRES_SERVER, odbc_port :ODBC_POSTGRES_PORT, odbc_DATABASE :ODBC_DATABASE);
--Testcase 30:
CREATE USER mapping for public SERVER odbc_post_svr OPTIONS(odbc_UID :ODBC_POSTGRES_USER, odbc_PWD :ODBC_POSTGRES_PASS);
--Testcase 31:
CREATE SERVER jdbc_mysql_svr FOREIGN DATA WRAPPER jdbc_fdw OPTIONS(
drivername :JDBC_MYSQL_DRIVERNAME,
url :JDBC_MYSQL_URL,
querytimeout '15',
jarfile :JDBC_MYSQL_DRIVERPATH,
maxheapsize '600'
);
--Testcase 32:
CREATE USER MAPPING FOR public SERVER jdbc_mysql_svr OPTIONS(username :JDBC_MYSQL_USER, password :JDBC_MYSQL_PASS);
--Testcase 33:
CREATE SERVER jdbc_post_svr FOREIGN DATA WRAPPER jdbc_fdw OPTIONS(
drivername :JDBC_POSTGRES_DRIVERNAME,
url :JDBC_POSTGRES_URL,
querytimeout '15',
jarfile :JDBC_POSTGRES_DRIVERPATH,
maxheapsize '600'
);
--Testcase 34:
CREATE USER MAPPING FOR public SERVER jdbc_post_svr OPTIONS(username :JDBC_POSTGRES_USER, password :JDBC_POSTGRES_PASS);
--Testcase 35:
CREATE SERVER griddb_svr FOREIGN DATA WRAPPER griddb_fdw OPTIONS (host :GRIDDB_HOST, port :GRIDDB_PORT, clustername 'griddbfdwTestCluster');
--Testcase 36:
CREATE USER MAPPING FOR public SERVER griddb_svr OPTIONS (username :GRIDDB_USER, password :GRIDDB_PASS);
-- --Testcase 37:
CREATE SERVER mongo_svr FOREIGN DATA WRAPPER mongo_fdw
  OPTIONS (address :MONGO_HOST, port :MONGO_PORT);
--Testcase 38:
CREATE USER MAPPING FOR public SERVER mongo_svr OPTIONS (username :MONGO_USER, password :MONGO_PASS);
--Testcase 39:
CREATE SERVER dynamodb_svr FOREIGN DATA WRAPPER dynamodb_fdw
  OPTIONS (endpoint :DYNAMODB_ENDPOINT1);
--Testcase 40:
CREATE USER MAPPING FOR public SERVER dynamodb_svr
  OPTIONS (user :DYNAMODB_USER, password :DYNAMODB_PASS);
--Testcase 41:
CREATE SERVER postgres_svr_1 FOREIGN DATA WRAPPER postgres_fdw OPTIONS (host :POSTGRES_1_SERVER, port :POSTGRES_1_PORT, dbname 'pg_modify_db');
--Testcase 42:
CREATE USER mapping for public SERVER postgres_svr_1 OPTIONS(user :POSTGRES_1_USER, password :POSTGRES_1_PASS);
-- tntbl3: postgres_svr, mysql_svr, tiny_svr, oracle_svr, sqlite_svr, odbc_mysql_svr, jdbc_post_svr, griddb_svr, mongo_svr, dynamodb_svr, postgres_svr_1
-- key: _id
--Testcase 43:
CREATE SERVER postgres_svr_2 FOREIGN DATA WRAPPER postgres_fdw OPTIONS (host :POSTGRES_2_SERVER, port :POSTGRES_2_PORT, dbname 'pg_modify_db');
--Testcase 44:
CREATE USER mapping for public SERVER postgres_svr_2 OPTIONS(user :POSTGRES_2_USER, password :POSTGRES_2_PASS);
-- tntbl4: postgres_svr, postgres_svr_2
-- key: c1
-- tntbl5: file_svr, file_svr_2
-- key: c1
--Testcase 45:
CREATE SERVER file_svr FOREIGN DATA WRAPPER file_fdw;
--Testcase 46:
CREATE SERVER file_svr_2 FOREIGN DATA WRAPPER file_fdw;
-- Create multi tenant tables
-- tntbl1
--Testcase 47:
CREATE FOREIGN TABLE tntbl1 (c1 int, c2 smallint, c3 float, c4 double precision, c5 bigint, c6 timestamp, c7 timestamp with time zone, c8 char(255), c9 varchar(255), __spd_url text) SERVER pgspider_svr;
-- tntbl2
--Testcase 48:
CREATE FOREIGN TABLE tntbl2 (_id text, c1 int, c2 text, c3 boolean, c4 double precision, c5 bigint, __spd_url text) SERVER pgspider_svr;
-- tntbl3
--Testcase 49:
CREATE FOREIGN TABLE tntbl3 (_id text, c1 int, c2 real, c3 double precision, c4 bigint, __spd_url text) SERVER pgspider_svr;
-- tntbl4
--Testcase 50:
CREATE FOREIGN TABLE tntbl4 (c1 int, c2 text, c3 boolean, c4 double precision, c5 bigint, c6 char(255), c7 varchar(255), c8 float8, c9 smallint, c10 timestamp, c11 timestamp with time zone, c12 date, c13 json, c14 jsonb, c15 uuid, c16 point, c17 bytea, c18 bit(10), c19 varbit(10), c20 interval, __spd_url text) SERVER pgspider_svr;
-- tntbl5
--Testcase 51:
CREATE FOREIGN TABLE tntbl5 (c1 int, c2 text, __spd_url text) SERVER pgspider_svr;
-- Foreign tables
--Testcase 52:
CREATE FOREIGN TABLE tntbl1__postgres_svr__0 (c1 int, c2 smallint, c3 float, c4 double precision, c5 bigint, c6 timestamp, c7 timestamp with time zone, c8 char(255), c9 varchar(255)) SERVER postgres_svr OPTIONS (table_name 'tntbl1');
--Testcase 53:
CREATE FOREIGN TABLE tntbl1__mysql_svr__0 (c1 int OPTIONS (key 'true'), c2 smallint, c3 float, c4 double precision, c5 bigint, c6 timestamp, c7 timestamp with time zone, c8 char(255), c9 varchar(255)) SERVER mysql_svr OPTIONS (dbname :MYSQL_DB_NAME1, table_name 'tntbl1');
--Testcase 54:
CREATE FOREIGN TABLE tntbl1__tiny_svr__0 (c1 int OPTIONS (key 'true'), c2 smallint, c3 float, c4 double precision, c5 bigint, c6 timestamp, c7 timestamp with time zone, c8 char(255), c9 varchar(255)) SERVER tiny_svr OPTIONS (table_name 'tntbl1');
--Testcase 55:
CREATE FOREIGN TABLE tntbl1__oracle_svr__0 (c1 int OPTIONS (key 'yes') NOT NULL, c2 smallint, c3 float, c4 double precision, c5 bigint, c6 timestamp, c7 timestamp with time zone, c8 char(255), c9 varchar(255)) SERVER oracle_svr OPTIONS (table 'TNTBL1');
--Testcase 56:
CREATE FOREIGN TABLE tntbl1__sqlite_svr__0 (c1 int OPTIONS (key 'true'), c2 smallint, c3 float, c4 double precision, c5 bigint, c6 timestamp, c7 timestamp with time zone, c8 char(255), c9 varchar(255)) SERVER sqlite_svr OPTIONS (table 'tntbl1');
--Testcase 57:
CREATE FOREIGN TABLE tntbl2__odbc_post_svr__0 (_id text OPTIONS (key 'true'), c1 int, c2 text, c3 boolean, c4 double precision, c5 bigint) SERVER odbc_post_svr OPTIONS (table 'tntbl2');
--Testcase 58:
CREATE FOREIGN TABLE tntbl2__jdbc_mysql_svr__0 (_id text OPTIONS (key 'true'), c1 int, c2 text, c3 boolean, c4 double precision, c5 bigint) SERVER jdbc_mysql_svr OPTIONS (table_name 'tntbl2');
--Testcase 59:
CREATE FOREIGN TABLE tntbl2__mongo_svr__0 (_id text, c1 int, c2 text, c3 boolean, c4 double precision, c5 bigint) SERVER mongo_svr OPTIONS (database 'mongo_pg_modify', collection 'tntbl2');
--Testcase 60:
CREATE FOREIGN TABLE tntbl2__dynamodb_svr__0 (_id text, c1 int, c2 text, c3 boolean, c4 double precision, c5 bigint) SERVER dynamodb_svr OPTIONS (table_name 'tntbl2', partition_key '_id');
--Testcase 61:
CREATE FOREIGN TABLE tntbl2__griddb_svr__0 (_id text OPTIONS (rowkey 'true'), c1 int, c2 text, c3 boolean, c4 double precision, c5 bigint) SERVER griddb_svr OPTIONS (table_name 'tntbl2');
--Testcase 62:
CREATE FOREIGN TABLE tntbl3__jdbc_post_svr__0 (_id text OPTIONS (key 'true'), c1 int, c2 real, c3 double precision, c4 bigint) SERVER jdbc_post_svr OPTIONS (table_name 'tntbl3');
--Testcase 63:
CREATE FOREIGN TABLE tntbl3__odbc_mysql_svr__0 (_id text OPTIONS (key 'true'), c1 int, c2 real, c3 double precision, c4 bigint) SERVER odbc_mysql_svr OPTIONS (schema :ODBC_DB_SCHEMA, table 'tntbl3');
--Testcase 64:
CREATE FOREIGN TABLE tntbl3__mongo_svr__0 (_id text, c1 int, c2 real, c3 double precision, c4 bigint) SERVER mongo_svr OPTIONS (database 'mongo_pg_modify', collection 'tntbl3');
--Testcase 65:
CREATE FOREIGN TABLE tntbl3__dynamodb_svr__0 (_id text, c1 int, c2 real, c3 double precision, c4 bigint) SERVER dynamodb_svr OPTIONS (table_name 'tntbl3', partition_key '_id');
--Testcase 66:
CREATE FOREIGN TABLE tntbl3__griddb_svr__0 (_id text OPTIONS (rowkey 'true'), c1 int, c2 real, c3 double precision, c4 bigint) SERVER griddb_svr OPTIONS (table_name 'tntbl3');
--Testcase 67:
CREATE FOREIGN TABLE tntbl3__postgres_svr__0 (_id text, c1 int, c2 real, c3 double precision, c4 bigint) SERVER postgres_svr OPTIONS (table_name 'tntbl3');
--Testcase 68:
CREATE FOREIGN TABLE tntbl3__mysql_svr__0 (_id text, c1 int, c2 real, c3 double precision, c4 bigint) SERVER mysql_svr OPTIONS (dbname :MYSQL_DB_NAME1, table_name 'tntbl3');
--Testcase 69:
CREATE FOREIGN TABLE tntbl3__tiny_svr__0 (_id text OPTIONS (key 'true'), c1 int, c2 real, c3 double precision, c4 bigint) SERVER tiny_svr OPTIONS (table_name 'tntbl3');
--Testcase 70:
CREATE FOREIGN TABLE tntbl3__oracle_svr__0 (_id text OPTIONS (key 'yes', column_name 'ID_ID') NOT NULL, c1 int, c2 real, c3 double precision, c4 bigint) SERVER oracle_svr OPTIONS (table 'TNTBL3');
--Testcase 71:
CREATE FOREIGN TABLE tntbl3__sqlite_svr__0 (_id text OPTIONS (key 'true'), c1 int, c2 real, c3 double precision, c4 bigint) SERVER sqlite_svr OPTIONS (table 'tntbl3');
--Testcase 72:
-- CREATE FOREIGN TABLE tntbl3__postgres_svr__1 (_id text, c1 int, c2 real, c3 double precision, c4 bigint) SERVER postgres_svr_1 OPTIONS (table_name 'tntbl3');
--Testcase 73:
CREATE FOREIGN TABLE tntbl4__postgres_svr__0 (c1 int, c2 text, c3 boolean, c4 double precision, c5 bigint, c6 char(255), c7 varchar(255), c8 float8, c9 smallint, c10 timestamp, c11 timestamp with time zone, c12 date, c13 json, c14 jsonb, c15 uuid, c16 point, c17 bytea, c18 bit(10), c19 varbit(10), c20 interval) SERVER postgres_svr OPTIONS (table_name 'tntbl4');
--Testcase 74:
CREATE FOREIGN TABLE tntbl4__postgres_svr_2__0 (c1 int, c2 text, c3 boolean, c4 double precision, c5 bigint, c6 char(255), c7 varchar(255), c8 float8, c9 smallint, c10 timestamp, c11 timestamp with time zone, c12 date, c13 json, c14 jsonb, c15 uuid, c16 point, c17 bytea, c18 bit(10), c19 varbit(10), c20 interval) SERVER postgres_svr_2 OPTIONS (table_name 'tntbl4');
--Testcase 75:
CREATE FOREIGN TABLE tntbl5__file_svr__0 (c1 int, c2 text) SERVER file_svr OPTIONS (filename '/tmp/pg_modify_file1.csv', format 'csv');
--Testcase 76:
CREATE FOREIGN TABLE tntbl5__file_svr__2 (c1 int, c2 text) SERVER file_svr_2 OPTIONS (filename '/tmp/pg_modify_file2.csv', format 'csv');
-- SELECT FROM table if there is any record
--Testcase 77:
SELECT * FROM tntbl1 ORDER BY 1, 2, 3;
  c1  | c2 | c3 | c4  |  c5  |         c6          |           c7           |                                                                                                                               c8                                                                                                                                |          c9          |   __spd_url    
------+----+----+-----+------+---------------------+------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------+----------------
  -20 |  0 |  1 | 100 | 1000 | 2022-06-22 14:00:00 | 2017-08-07 12:00:00+00 | char array                                                                                                                                                                                                                                                      | varchar array        | /oracle_svr/
    1 |  0 |  1 | 100 | 1000 | 2022-06-22 14:00:00 | 2022-06-22 07:00:00+00 | char array                                                                                                                                                                                                                                                      | varchar array        | /postgres_svr/
  100 |  0 |  1 | 100 | 1000 | 2022-06-22 14:00:00 | 2022-06-22 07:00:00+00 | tiny array                                                                                                                                                                                                                                                      | tiny varchar array   | /tiny_svr/
 1000 |  0 |  1 | 100 | 1000 | 2022-06-22 14:00:00 | 2022-06-22 07:00:00+00 | sqlite char array                                                                                                                                                                                                                                               | sqlite varchar array | /sqlite_svr/
(4 rows)

--Testcase 78:
SELECT c1, c2, c3, c4, c5, __spd_url FROM tntbl2 ORDER BY 1, 2, 3, 4, 5, 6;
 c1 |    c2     | c3 |    c4     |  c5   |    __spd_url    
----+-----------+----+-----------+-------+-----------------
  1 | foo       | t  | -1928.121 |  1000 | /mongo_svr/
  1 | odbc text | t  |       100 | 10000 | /odbc_post_svr/
  2 | varchar   | f  |      2000 |  2000 | /mongo_svr/
(3 rows)

--Testcase 79:
Set pgspider_core_fdw.throw_error_ifdead to false;
SELECT c1, c2, c3, c4, __spd_url FROM tntbl3 ORDER BY 1, 2, 3, 4, 5;
 c1 |  c2   |  c3  |  c4   |    __spd_url    
----+-------+------+-------+-----------------
  1 | -19.1 |      |       | /mongo_svr/
  1 |     1 |  100 |  1000 | /postgres_svr/
  1 |     1 |  100 |  1000 | /sqlite_svr/
  1 |     1 |  100 |  1000 | /tiny_svr/
  2 |    20 |      |       | /mongo_svr/
 10 |    10 | 1000 | 10000 | /jdbc_post_svr/
(6 rows)

Set pgspider_core_fdw.throw_error_ifdead to true;
--Testcase 80:
SELECT * FROM tntbl4 ORDER BY 1, 2, 3;
 c1 |    c2    | c3 | c4  |  c5   |                                                                                                                               c6                                                                                                                                |      c7       | c8 | c9 |         c10         |          c11           |    c12     |                 c13                 |                                   c14                                   |                 c15                  |   c16   |         c17          |    c18     |  c19  |           c20            |    __spd_url     
----+----------+----+-----+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+----+----+---------------------+------------------------+------------+-------------------------------------+-------------------------------------------------------------------------+--------------------------------------+---------+----------------------+------------+-------+--------------------------+------------------
 10 | text     | t  |  10 |  1000 | char array                                                                                                                                                                                                                                                      | varchar array | -1 | 12 | 2004-10-19 10:23:54 | 2004-10-19 08:23:54+00 | 2001-01-01 | {"product": "test","quantity": 1}   | {"name": "paintings", "tags": ["Scene", "Portrait"], "finished": true}  | 2f404849-f62c-4234-b0c8-e230bd694045 | (1,-45) | \xa7a8a9aaabacadaeaf | 1111111111 | 10101 | @ 1 year 3 hours 20 mins | /postgres_svr/
 20 | texttext | f  | -10 | -1000 | char array                                                                                                                                                                                                                                                      | varchar array |  1 |  1 | 2005-10-19 10:23:54 | 2005-10-19 08:23:54+00 | 2001-01-01 | {"product": "sample","quantity": 1} | {"name": "paintings", "tags": ["Scene", "Portrait"], "finished": false} | 2f404849-f62c-4234-b0c8-e230bd694045 | (1,-45) | \xa7a8a9aaabacadaeaf | 1111111111 | 10101 | @ 1 year 3 hours 20 mins | /postgres_svr_2/
(2 rows)

--Testcase 81:
SELECT * FROM tntbl5 ORDER BY 1, 2, 3;
 c1 |  c2  |  __spd_url   
----+------+--------------
 10 | test | /file_svr/
 40 | foo1 | /file_svr_2/
(2 rows)

--------------------------------------------------------------------------------
-- *** Start test for tntbl1 *** --
--
-- INSERT
-- insert with DEFAULT in the target_list
--
--Testcase 82:
INSERT INTO tntbl1 (c1, c2, c3, c4, c5, c6, c7, c8, c9) VALUES (5, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT);
--Testcase 83:
INSERT INTO tntbl1 (c1, c2) VALUES (1, DEFAULT);
--Testcase 84:
INSERT INTO tntbl1 (c1, c2, c3) VALUES (6, 5, DEFAULT);
--Testcase 85:
INSERT INTO tntbl1 VALUES (7, 6, 2.6, 5453.454, 5989, '2001-01-01 04:05:02');
--Testcase 86:
INSERT INTO tntbl1 VALUES (8, 7);
--Testcase 87:
SELECT * FROM tntbl1 ORDER BY 1, 2, 3;
  c1  | c2 | c3  |    c4    |  c5  |         c6          |           c7           |                                                                                                                               c8                                                                                                                                |          c9          |   __spd_url    
------+----+-----+----------+------+---------------------+------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------+----------------
  -20 |  0 |   1 |      100 | 1000 | 2022-06-22 14:00:00 | 2017-08-07 12:00:00+00 | char array                                                                                                                                                                                                                                                      | varchar array        | /oracle_svr/
    1 |  0 |   1 |      100 | 1000 | 2022-06-22 14:00:00 | 2022-06-22 07:00:00+00 | char array                                                                                                                                                                                                                                                      | varchar array        | /postgres_svr/
    1 |    |     |          |      |                     |                        |                                                                                                                                                                                                                                                                 |                      | /oracle_svr/
    5 |    |     |          |      |                     |                        |                                                                                                                                                                                                                                                                 |                      | /mysql_svr/
    6 |  5 |     |          |      |                     |                        |                                                                                                                                                                                                                                                                 |                      | /postgres_svr/
    7 |  6 | 2.6 | 5453.454 | 5989 | 2001-01-01 04:05:02 |                        |                                                                                                                                                                                                                                                                 |                      | /sqlite_svr/
    8 |  7 |     |          |      |                     |                        |                                                                                                                                                                                                                                                                 |                      | /tiny_svr/
  100 |  0 |   1 |      100 | 1000 | 2022-06-22 14:00:00 | 2022-06-22 07:00:00+00 | tiny array                                                                                                                                                                                                                                                      | tiny varchar array   | /tiny_svr/
 1000 |  0 |   1 |      100 | 1000 | 2022-06-22 14:00:00 | 2022-06-22 07:00:00+00 | sqlite char array                                                                                                                                                                                                                                               | sqlite varchar array | /sqlite_svr/
(9 rows)

--
-- insert with similar expression / target_list VALUES (all fail)
--
--Testcase 88:
INSERT INTO tntbl1 (c1, c2, c3, c4, c5, c6, c7, c8, c9) VALUES (10, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT);
ERROR:  INSERT has more target columns than expressions
LINE 1: ...SERT INTO tntbl1 (c1, c2, c3, c4, c5, c6, c7, c8, c9) VALUES...
                                                             ^
--Testcase 89:
INSERT INTO tntbl1 (c1, c2, c3) VALUES (2, DEFAULT);
ERROR:  INSERT has more target columns than expressions
LINE 1: INSERT INTO tntbl1 (c1, c2, c3) VALUES (2, DEFAULT);
                                    ^
--Testcase 90:
INSERT INTO tntbl1 (c1, c2) VALUES (3, 2, 5);
ERROR:  INSERT has more expressions than target columns
LINE 1: INSERT INTO tntbl1 (c1, c2) VALUES (3, 2, 5);
                                                  ^
--Testcase 91:
INSERT INTO tntbl1 (c1, c2) VALUES (11, DEFAULT, 6);
ERROR:  INSERT has more expressions than target columns
LINE 1: INSERT INTO tntbl1 (c1, c2) VALUES (11, DEFAULT, 6);
                                                         ^
--Testcase 92:
SELECT * FROM tntbl1 ORDER BY 1, 2, 3;
  c1  | c2 | c3  |    c4    |  c5  |         c6          |           c7           |                                                                                                                               c8                                                                                                                                |          c9          |   __spd_url    
------+----+-----+----------+------+---------------------+------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------+----------------
  -20 |  0 |   1 |      100 | 1000 | 2022-06-22 14:00:00 | 2017-08-07 12:00:00+00 | char array                                                                                                                                                                                                                                                      | varchar array        | /oracle_svr/
    1 |  0 |   1 |      100 | 1000 | 2022-06-22 14:00:00 | 2022-06-22 07:00:00+00 | char array                                                                                                                                                                                                                                                      | varchar array        | /postgres_svr/
    1 |    |     |          |      |                     |                        |                                                                                                                                                                                                                                                                 |                      | /oracle_svr/
    5 |    |     |          |      |                     |                        |                                                                                                                                                                                                                                                                 |                      | /mysql_svr/
    6 |  5 |     |          |      |                     |                        |                                                                                                                                                                                                                                                                 |                      | /postgres_svr/
    7 |  6 | 2.6 | 5453.454 | 5989 | 2001-01-01 04:05:02 |                        |                                                                                                                                                                                                                                                                 |                      | /sqlite_svr/
    8 |  7 |     |          |      |                     |                        |                                                                                                                                                                                                                                                                 |                      | /tiny_svr/
  100 |  0 |   1 |      100 | 1000 | 2022-06-22 14:00:00 | 2022-06-22 07:00:00+00 | tiny array                                                                                                                                                                                                                                                      | tiny varchar array   | /tiny_svr/
 1000 |  0 |   1 |      100 | 1000 | 2022-06-22 14:00:00 | 2022-06-22 07:00:00+00 | sqlite char array                                                                                                                                                                                                                                               | sqlite varchar array | /sqlite_svr/
(9 rows)

--
-- VALUES test
--
--Testcase 93:
INSERT INTO tntbl1 VALUES (10, 20, 3.0, 452.254, 599, '2037-01-19 03:14:07', '2004-10-19 10:23:54+02', '40', 'abc'), (-1, 2, DEFAULT, DEFAULT, 69845, '2004-10-19 10:23:54', '1972-01-01 00:00:01', 'Beera', 'John Does'),
    ((SELECT 2), (SELECT i FROM (VALUES(3)) as foo (i)), 4.0, 656.212, 5944, '2007-10-19 10:23:54', '2007-10-19 10:23:54+02', 'VALUES are fun!', 'foo');
--Testcase 94:
SELECT * FROM tntbl1 ORDER BY 1, 2, 3;
  c1  | c2 | c3  |    c4    |  c5   |         c6          |           c7           |                                                                                                                               c8                                                                                                                                |          c9          |   __spd_url    
------+----+-----+----------+-------+---------------------+------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------+----------------
  -20 |  0 |   1 |      100 |  1000 | 2022-06-22 14:00:00 | 2017-08-07 12:00:00+00 | char array                                                                                                                                                                                                                                                      | varchar array        | /oracle_svr/
   -1 |  2 |     |          | 69845 | 2004-10-19 10:23:54 | 1972-01-01 00:00:01+00 | Beera                                                                                                                                                                                                                                                           | John Does            | /oracle_svr/
    1 |  0 |   1 |      100 |  1000 | 2022-06-22 14:00:00 | 2022-06-22 07:00:00+00 | char array                                                                                                                                                                                                                                                      | varchar array        | /postgres_svr/
    1 |    |     |          |       |                     |                        |                                                                                                                                                                                                                                                                 |                      | /oracle_svr/
    2 |  3 |   4 |  656.212 |  5944 | 2007-10-19 10:23:54 | 2007-10-19 08:23:54+00 | VALUES are fun!                                                                                                                                                                                                                                                 | foo                  | /postgres_svr/
    5 |    |     |          |       |                     |                        |                                                                                                                                                                                                                                                                 |                      | /mysql_svr/
    6 |  5 |     |          |       |                     |                        |                                                                                                                                                                                                                                                                 |                      | /postgres_svr/
    7 |  6 | 2.6 | 5453.454 |  5989 | 2001-01-01 04:05:02 |                        |                                                                                                                                                                                                                                                                 |                      | /sqlite_svr/
    8 |  7 |     |          |       |                     |                        |                                                                                                                                                                                                                                                                 |                      | /tiny_svr/
   10 | 20 |   3 |  452.254 |   599 | 2037-01-19 03:14:07 | 2004-10-19 08:23:54+00 | 40                                                                                                                                                                                                                                                              | abc                  | /mysql_svr/
  100 |  0 |   1 |      100 |  1000 | 2022-06-22 14:00:00 | 2022-06-22 07:00:00+00 | tiny array                                                                                                                                                                                                                                                      | tiny varchar array   | /tiny_svr/
 1000 |  0 |   1 |      100 |  1000 | 2022-06-22 14:00:00 | 2022-06-22 07:00:00+00 | sqlite char array                                                                                                                                                                                                                                               | sqlite varchar array | /sqlite_svr/
(12 rows)

--
-- TOASTed value test
--
--Testcase 95:
INSERT INTO tntbl1 VALUES (9, 9, 902.12, 9545.03, 3122, '2030-02-20 03:00:07', '2005-10-20 10:20:54+02', repeat('x', 25), repeat('a', 25));
--Testcase 96:
SELECT c1, c2, c3, c4, c8, c9 FROM tntbl1 ORDER BY 1, 2, 3;
  c1  | c2 |   c3   |    c4    |                                                                                                                               c8                                                                                                                                |            c9             
------+----+--------+----------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------
  -20 |  0 |      1 |      100 | char array                                                                                                                                                                                                                                                      | varchar array
   -1 |  2 |        |          | Beera                                                                                                                                                                                                                                                           | John Does
    1 |  0 |      1 |      100 | char array                                                                                                                                                                                                                                                      | varchar array
    1 |    |        |          |                                                                                                                                                                                                                                                                 | 
    2 |  3 |      4 |  656.212 | VALUES are fun!                                                                                                                                                                                                                                                 | foo
    5 |    |        |          |                                                                                                                                                                                                                                                                 | 
    6 |  5 |        |          |                                                                                                                                                                                                                                                                 | 
    7 |  6 |    2.6 | 5453.454 |                                                                                                                                                                                                                                                                 | 
    8 |  7 |        |          |                                                                                                                                                                                                                                                                 | 
    9 |  9 | 902.12 |  9545.03 | xxxxxxxxxxxxxxxxxxxxxxxxx                                                                                                                                                                                                                                       | aaaaaaaaaaaaaaaaaaaaaaaaa
   10 | 20 |      3 |  452.254 | 40                                                                                                                                                                                                                                                              | abc
  100 |  0 |      1 |      100 | tiny array                                                                                                                                                                                                                                                      | tiny varchar array
 1000 |  0 |      1 |      100 | sqlite char array                                                                                                                                                                                                                                               | sqlite varchar array
(13 rows)

--
-- INSERT with IN feature
--
--Testcase 97:
INSERT INTO tntbl1 IN ('/postgres_svr/') VALUES (-10, 20, 82.21, 213.12, 9565, '2003-10-19 10:23:54', '1971-01-01 00:00:01+07', 'One', 'OneOne');
--Testcase 98:
INSERT INTO tntbl1 IN ('/oracle_svr/', '/tiny_svr/') VALUES (650, 120, 73.265, 78523.5, 5421659, '2002-10-19 10:23:54', '1972-01-01 00:00:01+07', 'Two', 'TwoTwo');
--
-- UPDATE
--
--Testcase 99:
SELECT c1, c2, c3, c4, c5, c6, c7, c8, c9 FROM tntbl1 ORDER BY 1, 2, 3, 4, 5, 6, 7;
  c1  | c2  |   c3   |    c4    |   c5    |         c6          |           c7           |                                                                                                                               c8                                                                                                                                |            c9             
------+-----+--------+----------+---------+---------------------+------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------
  -20 |   0 |      1 |      100 |    1000 | 2022-06-22 14:00:00 | 2017-08-07 12:00:00+00 | char array                                                                                                                                                                                                                                                      | varchar array
  -10 |  20 |  82.21 |   213.12 |    9565 | 2003-10-19 10:23:54 | 1970-12-31 17:00:01+00 | One                                                                                                                                                                                                                                                             | OneOne
   -1 |   2 |        |          |   69845 | 2004-10-19 10:23:54 | 1972-01-01 00:00:01+00 | Beera                                                                                                                                                                                                                                                           | John Does
    1 |   0 |      1 |      100 |    1000 | 2022-06-22 14:00:00 | 2022-06-22 07:00:00+00 | char array                                                                                                                                                                                                                                                      | varchar array
    1 |     |        |          |         |                     |                        |                                                                                                                                                                                                                                                                 | 
    2 |   3 |      4 |  656.212 |    5944 | 2007-10-19 10:23:54 | 2007-10-19 08:23:54+00 | VALUES are fun!                                                                                                                                                                                                                                                 | foo
    5 |     |        |          |         |                     |                        |                                                                                                                                                                                                                                                                 | 
    6 |   5 |        |          |         |                     |                        |                                                                                                                                                                                                                                                                 | 
    7 |   6 |    2.6 | 5453.454 |    5989 | 2001-01-01 04:05:02 |                        |                                                                                                                                                                                                                                                                 | 
    8 |   7 |        |          |         |                     |                        |                                                                                                                                                                                                                                                                 | 
    9 |   9 | 902.12 |  9545.03 |    3122 | 2030-02-20 03:00:07 | 2005-10-20 08:20:54+00 | xxxxxxxxxxxxxxxxxxxxxxxxx                                                                                                                                                                                                                                       | aaaaaaaaaaaaaaaaaaaaaaaaa
   10 |  20 |      3 |  452.254 |     599 | 2037-01-19 03:14:07 | 2004-10-19 08:23:54+00 | 40                                                                                                                                                                                                                                                              | abc
  100 |   0 |      1 |      100 |    1000 | 2022-06-22 14:00:00 | 2022-06-22 07:00:00+00 | tiny array                                                                                                                                                                                                                                                      | tiny varchar array
  650 | 120 | 73.265 |  78523.5 | 5421659 | 2002-10-19 10:23:54 | 1971-12-31 17:00:01+00 | Two                                                                                                                                                                                                                                                             | TwoTwo
 1000 |   0 |      1 |      100 |    1000 | 2022-06-22 14:00:00 | 2022-06-22 07:00:00+00 | sqlite char array                                                                                                                                                                                                                                               | sqlite varchar array
(15 rows)

--Testcase 100:
UPDATE tntbl1 SET c6 = DEFAULT, c4 = DEFAULT;
--Testcase 101:
SELECT c1, c2, c3, c4, c5, c6, c7, c8, c9 FROM tntbl1 ORDER BY 1, 2, 3, 4, 5, 6, 7;
  c1  | c2  |   c3   | c4 |   c5    | c6 |           c7           |                                                                                                                               c8                                                                                                                                |            c9             
------+-----+--------+----+---------+----+------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------
  -20 |   0 |      1 |    |    1000 |    | 2017-08-07 12:00:00+00 | char array                                                                                                                                                                                                                                                      | varchar array
  -10 |  20 |  82.21 |    |    9565 |    | 1970-12-31 17:00:01+00 | One                                                                                                                                                                                                                                                             | OneOne
   -1 |   2 |        |    |   69845 |    | 1972-01-01 00:00:01+00 | Beera                                                                                                                                                                                                                                                           | John Does
    1 |   0 |      1 |    |    1000 |    | 2022-06-22 07:00:00+00 | char array                                                                                                                                                                                                                                                      | varchar array
    1 |     |        |    |         |    |                        |                                                                                                                                                                                                                                                                 | 
    2 |   3 |      4 |    |    5944 |    | 2007-10-19 08:23:54+00 | VALUES are fun!                                                                                                                                                                                                                                                 | foo
    5 |     |        |    |         |    |                        |                                                                                                                                                                                                                                                                 | 
    6 |   5 |        |    |         |    |                        |                                                                                                                                                                                                                                                                 | 
    7 |   6 |    2.6 |    |    5989 |    |                        |                                                                                                                                                                                                                                                                 | 
    8 |   7 |        |    |         |    |                        |                                                                                                                                                                                                                                                                 | 
    9 |   9 | 902.12 |    |    3122 |    | 2005-10-20 08:20:54+00 | xxxxxxxxxxxxxxxxxxxxxxxxx                                                                                                                                                                                                                                       | aaaaaaaaaaaaaaaaaaaaaaaaa
   10 |  20 |      3 |    |     599 |    | 2004-10-19 08:23:54+00 | 40                                                                                                                                                                                                                                                              | abc
  100 |   0 |      1 |    |    1000 |    | 2022-06-22 07:00:00+00 | tiny array                                                                                                                                                                                                                                                      | tiny varchar array
  650 | 120 | 73.265 |    | 5421659 |    | 1971-12-31 17:00:01+00 | Two                                                                                                                                                                                                                                                             | TwoTwo
 1000 |   0 |      1 |    |    1000 |    | 2022-06-22 07:00:00+00 | sqlite char array                                                                                                                                                                                                                                               | sqlite varchar array
(15 rows)

-- aliases for the UPDATE target table
--Testcase 102:
UPDATE tntbl1 AS t SET c1 = 10 WHERE t.c3 = 902.12;
--Testcase 103:
SELECT c1, c2, c3, c4, c5, c6, c7, c8, c9 FROM tntbl1 ORDER BY 1, 2, 3, 4, 5, 6, 7;
  c1  | c2  |   c3   | c4 |   c5    | c6 |           c7           |                                                                                                                               c8                                                                                                                                |            c9             
------+-----+--------+----+---------+----+------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------
  -20 |   0 |      1 |    |    1000 |    | 2017-08-07 12:00:00+00 | char array                                                                                                                                                                                                                                                      | varchar array
  -10 |  20 |  82.21 |    |    9565 |    | 1970-12-31 17:00:01+00 | One                                                                                                                                                                                                                                                             | OneOne
   -1 |   2 |        |    |   69845 |    | 1972-01-01 00:00:01+00 | Beera                                                                                                                                                                                                                                                           | John Does
    1 |   0 |      1 |    |    1000 |    | 2022-06-22 07:00:00+00 | char array                                                                                                                                                                                                                                                      | varchar array
    1 |     |        |    |         |    |                        |                                                                                                                                                                                                                                                                 | 
    2 |   3 |      4 |    |    5944 |    | 2007-10-19 08:23:54+00 | VALUES are fun!                                                                                                                                                                                                                                                 | foo
    5 |     |        |    |         |    |                        |                                                                                                                                                                                                                                                                 | 
    6 |   5 |        |    |         |    |                        |                                                                                                                                                                                                                                                                 | 
    7 |   6 |    2.6 |    |    5989 |    |                        |                                                                                                                                                                                                                                                                 | 
    8 |   7 |        |    |         |    |                        |                                                                                                                                                                                                                                                                 | 
   10 |   9 | 902.12 |    |    3122 |    | 2005-10-20 08:20:54+00 | xxxxxxxxxxxxxxxxxxxxxxxxx                                                                                                                                                                                                                                       | aaaaaaaaaaaaaaaaaaaaaaaaa
   10 |  20 |      3 |    |     599 |    | 2004-10-19 08:23:54+00 | 40                                                                                                                                                                                                                                                              | abc
  100 |   0 |      1 |    |    1000 |    | 2022-06-22 07:00:00+00 | tiny array                                                                                                                                                                                                                                                      | tiny varchar array
  650 | 120 | 73.265 |    | 5421659 |    | 1971-12-31 17:00:01+00 | Two                                                                                                                                                                                                                                                             | TwoTwo
 1000 |   0 |      1 |    |    1000 |    | 2022-06-22 07:00:00+00 | sqlite char array                                                                                                                                                                                                                                               | sqlite varchar array
(15 rows)

--Testcase 104:
UPDATE tntbl1 t SET c1 = t.c1 + 10 WHERE t.c3 = 3.0;
--Testcase 105:
SELECT c1, c2, c3, c4, c5, c6, c7, c8, c9 FROM tntbl1 ORDER BY 1, 2, 3, 4, 5, 6, 7;
  c1  | c2  |   c3   | c4 |   c5    | c6 |           c7           |                                                                                                                               c8                                                                                                                                |            c9             
------+-----+--------+----+---------+----+------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------
  -20 |   0 |      1 |    |    1000 |    | 2017-08-07 12:00:00+00 | char array                                                                                                                                                                                                                                                      | varchar array
  -10 |  20 |  82.21 |    |    9565 |    | 1970-12-31 17:00:01+00 | One                                                                                                                                                                                                                                                             | OneOne
   -1 |   2 |        |    |   69845 |    | 1972-01-01 00:00:01+00 | Beera                                                                                                                                                                                                                                                           | John Does
    1 |   0 |      1 |    |    1000 |    | 2022-06-22 07:00:00+00 | char array                                                                                                                                                                                                                                                      | varchar array
    1 |     |        |    |         |    |                        |                                                                                                                                                                                                                                                                 | 
    2 |   3 |      4 |    |    5944 |    | 2007-10-19 08:23:54+00 | VALUES are fun!                                                                                                                                                                                                                                                 | foo
    5 |     |        |    |         |    |                        |                                                                                                                                                                                                                                                                 | 
    6 |   5 |        |    |         |    |                        |                                                                                                                                                                                                                                                                 | 
    7 |   6 |    2.6 |    |    5989 |    |                        |                                                                                                                                                                                                                                                                 | 
    8 |   7 |        |    |         |    |                        |                                                                                                                                                                                                                                                                 | 
   10 |   9 | 902.12 |    |    3122 |    | 2005-10-20 08:20:54+00 | xxxxxxxxxxxxxxxxxxxxxxxxx                                                                                                                                                                                                                                       | aaaaaaaaaaaaaaaaaaaaaaaaa
   20 |  20 |      3 |    |     599 |    | 2004-10-19 08:23:54+00 | 40                                                                                                                                                                                                                                                              | abc
  100 |   0 |      1 |    |    1000 |    | 2022-06-22 07:00:00+00 | tiny array                                                                                                                                                                                                                                                      | tiny varchar array
  650 | 120 | 73.265 |    | 5421659 |    | 1971-12-31 17:00:01+00 | Two                                                                                                                                                                                                                                                             | TwoTwo
 1000 |   0 |      1 |    |    1000 |    | 2022-06-22 07:00:00+00 | sqlite char array                                                                                                                                                                                                                                               | sqlite varchar array
(15 rows)

--
-- Test VALUES in FROM
--
--Testcase 106:
UPDATE tntbl1 SET c1=v.i FROM (VALUES(20, 0)) AS v(i, j)
  WHERE tntbl1.c2 = v.j;
--Testcase 107:
SELECT c1, c2, c3, c4, c5, c6, c7, c8, c9 FROM tntbl1 ORDER BY 1, 2, 3, 4, 5, 6, 7, 8, 9;
 c1  | c2  |   c3   | c4 |   c5    | c6 |           c7           |                                                                                                                               c8                                                                                                                                |            c9             
-----+-----+--------+----+---------+----+------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------
 -10 |  20 |  82.21 |    |    9565 |    | 1970-12-31 17:00:01+00 | One                                                                                                                                                                                                                                                             | OneOne
  -1 |   2 |        |    |   69845 |    | 1972-01-01 00:00:01+00 | Beera                                                                                                                                                                                                                                                           | John Does
   1 |     |        |    |         |    |                        |                                                                                                                                                                                                                                                                 | 
   2 |   3 |      4 |    |    5944 |    | 2007-10-19 08:23:54+00 | VALUES are fun!                                                                                                                                                                                                                                                 | foo
   5 |     |        |    |         |    |                        |                                                                                                                                                                                                                                                                 | 
   6 |   5 |        |    |         |    |                        |                                                                                                                                                                                                                                                                 | 
   7 |   6 |    2.6 |    |    5989 |    |                        |                                                                                                                                                                                                                                                                 | 
   8 |   7 |        |    |         |    |                        |                                                                                                                                                                                                                                                                 | 
  10 |   9 | 902.12 |    |    3122 |    | 2005-10-20 08:20:54+00 | xxxxxxxxxxxxxxxxxxxxxxxxx                                                                                                                                                                                                                                       | aaaaaaaaaaaaaaaaaaaaaaaaa
  20 |   0 |      1 |    |    1000 |    | 2017-08-07 12:00:00+00 | char array                                                                                                                                                                                                                                                      | varchar array
  20 |   0 |      1 |    |    1000 |    | 2022-06-22 07:00:00+00 | char array                                                                                                                                                                                                                                                      | varchar array
  20 |   0 |      1 |    |    1000 |    | 2022-06-22 07:00:00+00 | sqlite char array                                                                                                                                                                                                                                               | sqlite varchar array
  20 |   0 |      1 |    |    1000 |    | 2022-06-22 07:00:00+00 | tiny array                                                                                                                                                                                                                                                      | tiny varchar array
  20 |  20 |      3 |    |     599 |    | 2004-10-19 08:23:54+00 | 40                                                                                                                                                                                                                                                              | abc
 650 | 120 | 73.265 |    | 5421659 |    | 1971-12-31 17:00:01+00 | Two                                                                                                                                                                                                                                                             | TwoTwo
(15 rows)

-- fail, wrong data type:
--Testcase 108:
UPDATE tntbl1 SET c1 = v.* FROM (VALUES(30, 0)) AS v(i, j)
  WHERE tntbl1.c2 = v.j;
ERROR:  column "c1" is of type integer but expression is of type record
LINE 1: UPDATE tntbl1 SET c1 = v.* FROM (VALUES(30, 0)) AS v(i, j)
                               ^
HINT:  You will need to rewrite or cast the expression.
--
-- Test multiple-set-clause syntax
--
--Testcase 109:
-- oracle_fdw issue skip/report
-- INSERT INTO tntbl1 SELECT c1+20, c2+50, c3 FROM tntbl1;
--Testcase 110:
SELECT c1, c2, c3, c4, c5, c6, c7, c8, c9 FROM tntbl1 ORDER BY 1, 2, 3, 4, 5, 6, 7, 8, 9;
 c1  | c2  |   c3   | c4 |   c5    | c6 |           c7           |                                                                                                                               c8                                                                                                                                |            c9             
-----+-----+--------+----+---------+----+------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------
 -10 |  20 |  82.21 |    |    9565 |    | 1970-12-31 17:00:01+00 | One                                                                                                                                                                                                                                                             | OneOne
  -1 |   2 |        |    |   69845 |    | 1972-01-01 00:00:01+00 | Beera                                                                                                                                                                                                                                                           | John Does
   1 |     |        |    |         |    |                        |                                                                                                                                                                                                                                                                 | 
   2 |   3 |      4 |    |    5944 |    | 2007-10-19 08:23:54+00 | VALUES are fun!                                                                                                                                                                                                                                                 | foo
   5 |     |        |    |         |    |                        |                                                                                                                                                                                                                                                                 | 
   6 |   5 |        |    |         |    |                        |                                                                                                                                                                                                                                                                 | 
   7 |   6 |    2.6 |    |    5989 |    |                        |                                                                                                                                                                                                                                                                 | 
   8 |   7 |        |    |         |    |                        |                                                                                                                                                                                                                                                                 | 
  10 |   9 | 902.12 |    |    3122 |    | 2005-10-20 08:20:54+00 | xxxxxxxxxxxxxxxxxxxxxxxxx                                                                                                                                                                                                                                       | aaaaaaaaaaaaaaaaaaaaaaaaa
  20 |   0 |      1 |    |    1000 |    | 2017-08-07 12:00:00+00 | char array                                                                                                                                                                                                                                                      | varchar array
  20 |   0 |      1 |    |    1000 |    | 2022-06-22 07:00:00+00 | char array                                                                                                                                                                                                                                                      | varchar array
  20 |   0 |      1 |    |    1000 |    | 2022-06-22 07:00:00+00 | sqlite char array                                                                                                                                                                                                                                               | sqlite varchar array
  20 |   0 |      1 |    |    1000 |    | 2022-06-22 07:00:00+00 | tiny array                                                                                                                                                                                                                                                      | tiny varchar array
  20 |  20 |      3 |    |     599 |    | 2004-10-19 08:23:54+00 | 40                                                                                                                                                                                                                                                              | abc
 650 | 120 | 73.265 |    | 5421659 |    | 1971-12-31 17:00:01+00 | Two                                                                                                                                                                                                                                                             | TwoTwo
(15 rows)

--Testcase 111:
UPDATE tntbl1 SET (c8,c1,c2) = ('bugle', c1+11, DEFAULT) WHERE c9 = 'foo';
--Testcase 112:
SELECT c1, c2, c3, c4, c5, c6, c7, c8, c9 FROM tntbl1 ORDER BY 1, 2, 3, 4, 5, 6, 7, 8, 9;
 c1  | c2  |   c3   | c4 |   c5    | c6 |           c7           |                                                                                                                               c8                                                                                                                                |            c9             
-----+-----+--------+----+---------+----+------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------
 -10 |  20 |  82.21 |    |    9565 |    | 1970-12-31 17:00:01+00 | One                                                                                                                                                                                                                                                             | OneOne
  -1 |   2 |        |    |   69845 |    | 1972-01-01 00:00:01+00 | Beera                                                                                                                                                                                                                                                           | John Does
   1 |     |        |    |         |    |                        |                                                                                                                                                                                                                                                                 | 
   5 |     |        |    |         |    |                        |                                                                                                                                                                                                                                                                 | 
   6 |   5 |        |    |         |    |                        |                                                                                                                                                                                                                                                                 | 
   7 |   6 |    2.6 |    |    5989 |    |                        |                                                                                                                                                                                                                                                                 | 
   8 |   7 |        |    |         |    |                        |                                                                                                                                                                                                                                                                 | 
  10 |   9 | 902.12 |    |    3122 |    | 2005-10-20 08:20:54+00 | xxxxxxxxxxxxxxxxxxxxxxxxx                                                                                                                                                                                                                                       | aaaaaaaaaaaaaaaaaaaaaaaaa
  13 |     |      4 |    |    5944 |    | 2007-10-19 08:23:54+00 | bugle                                                                                                                                                                                                                                                           | foo
  20 |   0 |      1 |    |    1000 |    | 2017-08-07 12:00:00+00 | char array                                                                                                                                                                                                                                                      | varchar array
  20 |   0 |      1 |    |    1000 |    | 2022-06-22 07:00:00+00 | char array                                                                                                                                                                                                                                                      | varchar array
  20 |   0 |      1 |    |    1000 |    | 2022-06-22 07:00:00+00 | sqlite char array                                                                                                                                                                                                                                               | sqlite varchar array
  20 |   0 |      1 |    |    1000 |    | 2022-06-22 07:00:00+00 | tiny array                                                                                                                                                                                                                                                      | tiny varchar array
  20 |  20 |      3 |    |     599 |    | 2004-10-19 08:23:54+00 | 40                                                                                                                                                                                                                                                              | abc
 650 | 120 | 73.265 |    | 5421659 |    | 1971-12-31 17:00:01+00 | Two                                                                                                                                                                                                                                                             | TwoTwo
(15 rows)

--Testcase 113:
UPDATE tntbl1 SET (c9,c4) = ('car', c1+c3), c1 = c1 + 1 WHERE c5 = 3122;
--Testcase 114:
SELECT c1, c2, c3, c4, c5, c6, c7, c8, c9 FROM tntbl1 ORDER BY 1, 2, 3, 4, 5, 6, 7, 8, 9;
 c1  | c2  |   c3   |   c4   |   c5    | c6 |           c7           |                                                                                                                               c8                                                                                                                                |          c9          
-----+-----+--------+--------+---------+----+------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------
 -10 |  20 |  82.21 |        |    9565 |    | 1970-12-31 17:00:01+00 | One                                                                                                                                                                                                                                                             | OneOne
  -1 |   2 |        |        |   69845 |    | 1972-01-01 00:00:01+00 | Beera                                                                                                                                                                                                                                                           | John Does
   1 |     |        |        |         |    |                        |                                                                                                                                                                                                                                                                 | 
   5 |     |        |        |         |    |                        |                                                                                                                                                                                                                                                                 | 
   6 |   5 |        |        |         |    |                        |                                                                                                                                                                                                                                                                 | 
   7 |   6 |    2.6 |        |    5989 |    |                        |                                                                                                                                                                                                                                                                 | 
   8 |   7 |        |        |         |    |                        |                                                                                                                                                                                                                                                                 | 
  11 |   9 | 902.12 | 912.12 |    3122 |    | 2005-10-20 08:20:54+00 | xxxxxxxxxxxxxxxxxxxxxxxxx                                                                                                                                                                                                                                       | car
  13 |     |      4 |        |    5944 |    | 2007-10-19 08:23:54+00 | bugle                                                                                                                                                                                                                                                           | foo
  20 |   0 |      1 |        |    1000 |    | 2017-08-07 12:00:00+00 | char array                                                                                                                                                                                                                                                      | varchar array
  20 |   0 |      1 |        |    1000 |    | 2022-06-22 07:00:00+00 | char array                                                                                                                                                                                                                                                      | varchar array
  20 |   0 |      1 |        |    1000 |    | 2022-06-22 07:00:00+00 | sqlite char array                                                                                                                                                                                                                                               | sqlite varchar array
  20 |   0 |      1 |        |    1000 |    | 2022-06-22 07:00:00+00 | tiny array                                                                                                                                                                                                                                                      | tiny varchar array
  20 |  20 |      3 |        |     599 |    | 2004-10-19 08:23:54+00 | 40                                                                                                                                                                                                                                                              | abc
 650 | 120 | 73.265 |        | 5421659 |    | 1971-12-31 17:00:01+00 | Two                                                                                                                                                                                                                                                             | TwoTwo
(15 rows)

-- fail, multi assignment to same column:
--Testcase 115:
UPDATE tntbl1 SET (c9,c5) = ('car', c1+c5), c5 = c1 + 1 WHERE c2 = 20;
ERROR:  multiple assignments to same column "c5"
-- uncorrelated sub-SELECT:
--Testcase 116:
UPDATE tntbl1
  SET (c2,c3) = (SELECT c2,c3 FROM tntbl1 where c3 = 3 and c9 = 'abc')
  WHERE c2 = 6 AND c2 = 2.6;
--Testcase 117:
SELECT c1, c2, c3, c4, c5, c6, c7, c8, c9 FROM tntbl1 ORDER BY 1, 2, 3, 4, 5, 6, 7, 8, 9;
 c1  | c2  |   c3   |   c4   |   c5    | c6 |           c7           |                                                                                                                               c8                                                                                                                                |          c9          
-----+-----+--------+--------+---------+----+------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------
 -10 |  20 |  82.21 |        |    9565 |    | 1970-12-31 17:00:01+00 | One                                                                                                                                                                                                                                                             | OneOne
  -1 |   2 |        |        |   69845 |    | 1972-01-01 00:00:01+00 | Beera                                                                                                                                                                                                                                                           | John Does
   1 |     |        |        |         |    |                        |                                                                                                                                                                                                                                                                 | 
   5 |     |        |        |         |    |                        |                                                                                                                                                                                                                                                                 | 
   6 |   5 |        |        |         |    |                        |                                                                                                                                                                                                                                                                 | 
   7 |   6 |    2.6 |        |    5989 |    |                        |                                                                                                                                                                                                                                                                 | 
   8 |   7 |        |        |         |    |                        |                                                                                                                                                                                                                                                                 | 
  11 |   9 | 902.12 | 912.12 |    3122 |    | 2005-10-20 08:20:54+00 | xxxxxxxxxxxxxxxxxxxxxxxxx                                                                                                                                                                                                                                       | car
  13 |     |      4 |        |    5944 |    | 2007-10-19 08:23:54+00 | bugle                                                                                                                                                                                                                                                           | foo
  20 |   0 |      1 |        |    1000 |    | 2017-08-07 12:00:00+00 | char array                                                                                                                                                                                                                                                      | varchar array
  20 |   0 |      1 |        |    1000 |    | 2022-06-22 07:00:00+00 | char array                                                                                                                                                                                                                                                      | varchar array
  20 |   0 |      1 |        |    1000 |    | 2022-06-22 07:00:00+00 | sqlite char array                                                                                                                                                                                                                                               | sqlite varchar array
  20 |   0 |      1 |        |    1000 |    | 2022-06-22 07:00:00+00 | tiny array                                                                                                                                                                                                                                                      | tiny varchar array
  20 |  20 |      3 |        |     599 |    | 2004-10-19 08:23:54+00 | 40                                                                                                                                                                                                                                                              | abc
 650 | 120 | 73.265 |        | 5421659 |    | 1971-12-31 17:00:01+00 | Two                                                                                                                                                                                                                                                             | TwoTwo
(15 rows)

-- correlated sub-SELECT:
--Testcase 118:
-- issue of pgspider_core_fdw, report/skip
-- UPDATE tntbl1 o
--   SET (c4,c5) = (SELECT c4+1,c5 FROM tntbl1 i
--                where i.c4=o.c3 and i.c5=o.c5 and i.c5 is not distinct FROM o.c5);
--Testcase 119:
SELECT c1, c2, c3, c4, c5, c6, c7, c8, c9 FROM tntbl1 ORDER BY 1, 2, 3, 4, 5, 6, 7, 8, 9;
 c1  | c2  |   c3   |   c4   |   c5    | c6 |           c7           |                                                                                                                               c8                                                                                                                                |          c9          
-----+-----+--------+--------+---------+----+------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------
 -10 |  20 |  82.21 |        |    9565 |    | 1970-12-31 17:00:01+00 | One                                                                                                                                                                                                                                                             | OneOne
  -1 |   2 |        |        |   69845 |    | 1972-01-01 00:00:01+00 | Beera                                                                                                                                                                                                                                                           | John Does
   1 |     |        |        |         |    |                        |                                                                                                                                                                                                                                                                 | 
   5 |     |        |        |         |    |                        |                                                                                                                                                                                                                                                                 | 
   6 |   5 |        |        |         |    |                        |                                                                                                                                                                                                                                                                 | 
   7 |   6 |    2.6 |        |    5989 |    |                        |                                                                                                                                                                                                                                                                 | 
   8 |   7 |        |        |         |    |                        |                                                                                                                                                                                                                                                                 | 
  11 |   9 | 902.12 | 912.12 |    3122 |    | 2005-10-20 08:20:54+00 | xxxxxxxxxxxxxxxxxxxxxxxxx                                                                                                                                                                                                                                       | car
  13 |     |      4 |        |    5944 |    | 2007-10-19 08:23:54+00 | bugle                                                                                                                                                                                                                                                           | foo
  20 |   0 |      1 |        |    1000 |    | 2017-08-07 12:00:00+00 | char array                                                                                                                                                                                                                                                      | varchar array
  20 |   0 |      1 |        |    1000 |    | 2022-06-22 07:00:00+00 | char array                                                                                                                                                                                                                                                      | varchar array
  20 |   0 |      1 |        |    1000 |    | 2022-06-22 07:00:00+00 | sqlite char array                                                                                                                                                                                                                                               | sqlite varchar array
  20 |   0 |      1 |        |    1000 |    | 2022-06-22 07:00:00+00 | tiny array                                                                                                                                                                                                                                                      | tiny varchar array
  20 |  20 |      3 |        |     599 |    | 2004-10-19 08:23:54+00 | 40                                                                                                                                                                                                                                                              | abc
 650 | 120 | 73.265 |        | 5421659 |    | 1971-12-31 17:00:01+00 | Two                                                                                                                                                                                                                                                             | TwoTwo
(15 rows)

-- fail, multiple rows supplied:
--Testcase 120:
UPDATE tntbl1 SET (c2,c3) = (SELECT c3+1,c2 FROM tntbl1);
ERROR:  more than one row returned by a subquery used as an expression
-- set to null if no rows supplied:
--Testcase 121:
UPDATE tntbl1 SET (c4,c5) = (SELECT c4+1,c5 FROM tntbl1 where c5 = 1000)
  WHERE c5 = 11;
--Testcase 122:
SELECT c1, c2, c3, c4, c5, c6, c7, c8, c9 FROM tntbl1 ORDER BY 1, 2, 3, 4, 5, 6, 7, 8, 9;
 c1  | c2  |   c3   |   c4   |   c5    | c6 |           c7           |                                                                                                                               c8                                                                                                                                |          c9          
-----+-----+--------+--------+---------+----+------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------
 -10 |  20 |  82.21 |        |    9565 |    | 1970-12-31 17:00:01+00 | One                                                                                                                                                                                                                                                             | OneOne
  -1 |   2 |        |        |   69845 |    | 1972-01-01 00:00:01+00 | Beera                                                                                                                                                                                                                                                           | John Does
   1 |     |        |        |         |    |                        |                                                                                                                                                                                                                                                                 | 
   5 |     |        |        |         |    |                        |                                                                                                                                                                                                                                                                 | 
   6 |   5 |        |        |         |    |                        |                                                                                                                                                                                                                                                                 | 
   7 |   6 |    2.6 |        |    5989 |    |                        |                                                                                                                                                                                                                                                                 | 
   8 |   7 |        |        |         |    |                        |                                                                                                                                                                                                                                                                 | 
  11 |   9 | 902.12 | 912.12 |    3122 |    | 2005-10-20 08:20:54+00 | xxxxxxxxxxxxxxxxxxxxxxxxx                                                                                                                                                                                                                                       | car
  13 |     |      4 |        |    5944 |    | 2007-10-19 08:23:54+00 | bugle                                                                                                                                                                                                                                                           | foo
  20 |   0 |      1 |        |    1000 |    | 2017-08-07 12:00:00+00 | char array                                                                                                                                                                                                                                                      | varchar array
  20 |   0 |      1 |        |    1000 |    | 2022-06-22 07:00:00+00 | char array                                                                                                                                                                                                                                                      | varchar array
  20 |   0 |      1 |        |    1000 |    | 2022-06-22 07:00:00+00 | sqlite char array                                                                                                                                                                                                                                               | sqlite varchar array
  20 |   0 |      1 |        |    1000 |    | 2022-06-22 07:00:00+00 | tiny array                                                                                                                                                                                                                                                      | tiny varchar array
  20 |  20 |      3 |        |     599 |    | 2004-10-19 08:23:54+00 | 40                                                                                                                                                                                                                                                              | abc
 650 | 120 | 73.265 |        | 5421659 |    | 1971-12-31 17:00:01+00 | Two                                                                                                                                                                                                                                                             | TwoTwo
(15 rows)

-- *-expansion should work in this context:
--Testcase 123:
UPDATE tntbl1 SET (c2,c3) = ROW(v.*) FROM (VALUES(2, 100)) AS v(i, j)
  WHERE tntbl1.c2 = v.i;
-- you might expect this to work, but syntactically it's not a RowExpr:
--Testcase 124:
UPDATE tntbl1 SET (c2,c3) = (v.*) FROM (VALUES(2, 101)) AS v(i, j)
  WHERE tntbl1.c2 = v.i;
ERROR:  source for a multiple-column UPDATE item must be a sub-SELECT or ROW() expression
LINE 1: UPDATE tntbl1 SET (c2,c3) = (v.*) FROM (VALUES(2, 101)) AS v...
                                     ^
-- if an alias for the target table is specified, don't allow references
-- to the original table name
--Testcase 125:
UPDATE tntbl1 AS t SET c2 = tntbl1.c2 + 10 WHERE t.c2 = 10;
ERROR:  invalid reference to FROM-clause entry for table "tntbl1"
LINE 1: UPDATE tntbl1 AS t SET c2 = tntbl1.c2 + 10 WHERE t.c2 = 10;
                                    ^
HINT:  Perhaps you meant to reference the table alias "t".
-- Make sure that we can update to a TOASTed value.
--Testcase 126:
UPDATE tntbl1 SET c9 = repeat('x', 25) WHERE c9 = 'car';
--Testcase 127:
SELECT c1, c2, c9 FROM tntbl1 ORDER BY 1, 2, 3;
 c1  | c2  |            c9             
-----+-----+---------------------------
 -10 |  20 | OneOne
  -1 |   2 | John Does
   1 |     | 
   5 |     | 
   6 |   5 | 
   7 |   6 | 
   8 |   7 | 
  11 |   9 | xxxxxxxxxxxxxxxxxxxxxxxxx
  13 |     | foo
  20 |   0 | sqlite varchar array
  20 |   0 | tiny varchar array
  20 |   0 | varchar array
  20 |   0 | varchar array
  20 |  20 | abc
 650 | 120 | TwoTwo
(15 rows)

-- Check multi-assignment with a Result node to handle a one-time filter.
--Testcase 128:
EXPLAIN (VERBOSE, COSTS OFF)
UPDATE tntbl1 t
  SET (c2, c3) = (SELECT c3, c2 FROM tntbl1 s WHERE s.c2 = t.c2)
  WHERE CURRENT_USER = SESSION_USER;
                                                                        QUERY PLAN                                                                        
----------------------------------------------------------------------------------------------------------------------------------------------------------
 Update on public.tntbl1 t
   Node: mysql_svr / Status: Alive
     Remote query: UPDATE `pg_modify_db1`.`tntbl1` SET `c2` = ?, `c3` = ? WHERE c1 = ?
   Node: oracle_svr / Status: Alive
     Oracle statement: UPDATE "TNTBL1" SET "C2" = :p2, "C3" = :p3 WHERE "C1" = :k1
   Node: postgres_svr / Status: Alive
     Remote SQL: UPDATE public.tntbl1 SET c2 = $2, c3 = $3 WHERE ctid = $1
   Node: sqlite_svr / Status: Alive
   Node: tiny_svr / Status: Alive
   ->  Result
         Output: (($1)::smallint), (($2)::double precision), ((SubPlan 1 (returns $1,$2))), t.c1, t.c1, t.ctid, t.c1, t.c1, t.__spd_url, t.*
         One-Time Filter: (CURRENT_USER = SESSION_USER)
         ->  Foreign Scan on public.tntbl1 t
               Output: $1, $2, (SubPlan 1 (returns $1,$2)), t.c1, t.c1, t.ctid, t.c1, t.c1, t.__spd_url, t.*
               Filter: (CURRENT_USER = SESSION_USER)
               Node: mysql_svr / Status: Alive
                 Remote query: SELECT `c1`, `c2`, `c3`, `c4`, `c5`, `c6`, `c7`, `c8`, `c9` FROM `pg_modify_db1`.`tntbl1` FOR UPDATE
               Node: oracle_svr / Status: Alive
                 Oracle query: SELECT /*303b20419872781a0e0c0a407ccd7e5d*/ "C1", "C2", "C3", "C4", "C5", "C6", "C7", "C8", "C9" FROM  "TNTBL1" FOR UPDATE
                 Oracle plan: SELECT STATEMENT
                 Oracle plan:   FOR UPDATE
                 Oracle plan:     BUFFER SORT
                 Oracle plan:       TABLE ACCESS FULL TNTBL1
               Node: postgres_svr / Status: Alive
                 Remote SQL: SELECT c1, c2, c3, c4, c5, c6, c7, c8, c9, ctid FROM public.tntbl1 FOR UPDATE
               Node: sqlite_svr / Status: Alive
                 SQLite query: SELECT `c1`, `c2`, `c3`, `c4`, `c5`, `c6`, `c7`, `c8`, `c9` FROM main."tntbl1"
               Node: tiny_svr / Status: Alive
                 TinyBrace query: SELECT `c1`, `c2`, `c3`, `c4`, `c5`, `c6`, `c7`, `c8`, `c9` FROM "tntbl1"
                 TinyBrace plan: SCAN TABLE tntbl1 (~1000000 rows)
               SubPlan 1 (returns $1,$2)
                 ->  Foreign Scan on public.tntbl1 s
                       Output: s.c3, s.c2
                       Node: mysql_svr / Status: Alive
                         Remote query: SELECT `c2`, `c3` FROM `pg_modify_db1`.`tntbl1` WHERE ((`c2` = ?))
                       Node: oracle_svr / Status: Alive
                         Oracle query: SELECT /*5b6adb24865a6e5576ed745be5061195*/ "C2", "C3" FROM  "TNTBL1" WHERE ("C2" = :p1)
                         Oracle plan: SELECT STATEMENT
                         Oracle plan:   TABLE ACCESS FULL TNTBL1  (filter "C2"=TO_NUMBER(:P1))
                       Node: postgres_svr / Status: Alive
                         Remote SQL: SELECT c2, c3 FROM public.tntbl1 WHERE ((c2 = $1::smallint))
                       Node: sqlite_svr / Status: Alive
                         SQLite query: SELECT `c2`, `c3` FROM main."tntbl1" WHERE ((`c2` = ?))
                       Node: tiny_svr / Status: Alive
                         TinyBrace query: SELECT `c2`, `c3` FROM "tntbl1" WHERE ((`c2` = ?))
                         TinyBrace plan: SCAN TABLE tntbl1 (~100000 rows)
(46 rows)

-- Crash issue/report
--Testcase 129:
-- UPDATE tntbl1 t
--   SET (c2, c3) = (SELECT c3, c2 FROM tntbl1 s WHERE s.c2 = t.c2)
--   WHERE CURRENT_USER = SESSION_USER;
--Testcase 130:
SELECT c2, c3, c9 FROM tntbl1 order by 1, 2, 3;
 c2  |   c3   |            c9             
-----+--------+---------------------------
   0 |      1 | sqlite varchar array
   0 |      1 | tiny varchar array
   0 |      1 | varchar array
   0 |      1 | varchar array
   2 |    100 | John Does
   5 |        | 
   6 |    2.6 | 
   7 |        | 
   9 | 902.12 | xxxxxxxxxxxxxxxxxxxxxxxxx
  20 |      3 | abc
  20 |  82.21 | OneOne
 120 | 73.265 | TwoTwo
     |      4 | foo
     |        | 
     |        | 
(15 rows)

--
-- UPDATE with IN feature
--
--Testcase 131:
UPDATE tntbl1 IN ('/tiny_svr/') SET c4 = 56563.1212;
--Testcase 132:
UPDATE tntbl1 IN ('/postgres_svr/', '/sqlite_svr/') SET c3 = 22.2;
--
-- DELETE
--
-- allow an alias to be specified for DELETE's target table
--Testcase 133:
DELETE FROM tntbl1 AS dt WHERE dt.c1 > 75;
-- if an alias is specified, don't allow the original table name
-- to be referenced
--Testcase 134:
DELETE FROM tntbl1 dt WHERE tntbl1.c1 > 25;
ERROR:  invalid reference to FROM-clause entry for table "tntbl1"
LINE 1: DELETE FROM tntbl1 dt WHERE tntbl1.c1 > 25;
                                    ^
HINT:  Perhaps you meant to reference the table alias "dt".
--Testcase 135:
SELECT c1, c2, c9 FROM tntbl1 ORDER BY 1, 2, 3;
 c1  | c2 |            c9             
-----+----+---------------------------
 -10 | 20 | OneOne
  -1 |  2 | John Does
   1 |    | 
   5 |    | 
   6 |  5 | 
   7 |  6 | 
   8 |  7 | 
  11 |  9 | xxxxxxxxxxxxxxxxxxxxxxxxx
  13 |    | foo
  20 |  0 | sqlite varchar array
  20 |  0 | tiny varchar array
  20 |  0 | varchar array
  20 |  0 | varchar array
  20 | 20 | abc
(14 rows)

-- delete a row with a TOASTed value
--Testcase 136:
DELETE FROM tntbl1 WHERE c2 > 2;
--Testcase 137:
SELECT c1, c2, c9 FROM tntbl1 ORDER BY 1, 2, 3;
 c1 | c2 |          c9          
----+----+----------------------
 -1 |  2 | John Does
  1 |    | 
  5 |    | 
 13 |    | foo
 20 |  0 | sqlite varchar array
 20 |  0 | tiny varchar array
 20 |  0 | varchar array
 20 |  0 | varchar array
(8 rows)

--
-- DELETE with IN feature
--
--Testcase 138:
DELETE FROM tntbl1 IN ('/oracle_svr/') WHERE c1 = 20;
SELECT * FROM tntbl1 ORDER BY 1, 2, 3, 4, 5, 6, 7, 8;
 c1 | c2 |  c3  |     c4     |  c5   | c6 |           c7           |                                                                                                                               c8                                                                                                                                |          c9          |   __spd_url    
----+----+------+------------+-------+----+------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------+----------------
 -1 |  2 |  100 |            | 69845 |    | 1972-01-01 00:00:01+00 | Beera                                                                                                                                                                                                                                                           | John Does            | /oracle_svr/
  1 |    |      |            |       |    |                        |                                                                                                                                                                                                                                                                 |                      | /oracle_svr/
  5 |    |      |            |       |    |                        |                                                                                                                                                                                                                                                                 |                      | /mysql_svr/
 13 |    | 22.2 |            |  5944 |    | 2007-10-19 08:23:54+00 | bugle                                                                                                                                                                                                                                                           | foo                  | /postgres_svr/
 20 |  0 |    1 | 56563.1212 |  1000 |    | 2022-06-22 07:00:00+00 | tiny array                                                                                                                                                                                                                                                      | tiny varchar array   | /tiny_svr/
 20 |  0 | 22.2 |            |  1000 |    | 2022-06-22 07:00:00+00 | char array                                                                                                                                                                                                                                                      | varchar array        | /postgres_svr/
 20 |  0 | 22.2 |            |  1000 |    | 2022-06-22 07:00:00+00 | sqlite char array                                                                                                                                                                                                                                               | sqlite varchar array | /sqlite_svr/
(7 rows)

--Testcase 139:
DELETE FROM tntbl1 IN ('/sqlite_svr/', '/tiny_svr/', '/mysql_svr/') WHERE c5 = 1000;
SELECT * FROM tntbl1 ORDER BY 1, 2, 3, 4, 5, 6, 7, 8;
 c1 | c2 |  c3  | c4 |  c5   | c6 |           c7           |                                                                                                                               c8                                                                                                                                |      c9       |   __spd_url    
----+----+------+----+-------+----+------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+----------------
 -1 |  2 |  100 |    | 69845 |    | 1972-01-01 00:00:01+00 | Beera                                                                                                                                                                                                                                                           | John Does     | /oracle_svr/
  1 |    |      |    |       |    |                        |                                                                                                                                                                                                                                                                 |               | /oracle_svr/
  5 |    |      |    |       |    |                        |                                                                                                                                                                                                                                                                 |               | /mysql_svr/
 13 |    | 22.2 |    |  5944 |    | 2007-10-19 08:23:54+00 | bugle                                                                                                                                                                                                                                                           | foo           | /postgres_svr/
 20 |  0 | 22.2 |    |  1000 |    | 2022-06-22 07:00:00+00 | char array                                                                                                                                                                                                                                                      | varchar array | /postgres_svr/
(5 rows)

-- *** Finish test for tntbl1 *** --
-----------------------------------------------------------------------------------
-- *** Start test for tntbl2 *** --
--
-- INSERT
-- insert with DEFAULT in the target_list
--
--Testcase 140:
INSERT INTO tntbl2 (_id, c1, c2, c3, c4, c5) VALUES (' ', DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT);
--Testcase 141:
INSERT INTO tntbl2 (_id, c2, c3) VALUES ('3', DEFAULT, DEFAULT);
--Testcase 142:
INSERT INTO tntbl2 (_id, c1, c2, c3) VALUES ('4', DEFAULT, '3q', DEFAULT);
--Testcase 143:
INSERT INTO tntbl2 VALUES ('DEFAULT', DEFAULT, 'test', true, 4654.0, 4000);
--Testcase 144:
INSERT INTO tntbl2 VALUES ('test', DEFAULT, 'test', false);
--Testcase 145:
SELECT c1, c2, c3, c4, c5, __spd_url FROM tntbl2 ORDER BY 1, 2, 3, 4, 5, 6;
 c1 |    c2     | c3 |    c4     |  c5   |    __spd_url     
----+-----------+----+-----------+-------+------------------
  1 | foo       | t  | -1928.121 |  1000 | /mongo_svr/
  1 | odbc text | t  |       100 | 10000 | /odbc_post_svr/
  2 | varchar   | f  |      2000 |  2000 | /mongo_svr/
    | 3q        |    |           |       | /jdbc_mysql_svr/
    | test      | f  |           |       | /odbc_post_svr/
    | test      | t  |      4654 |  4000 | /mongo_svr/
    |           |    |           |       | /dynamodb_svr/
    |           |    |           |       | /griddb_svr/
(8 rows)

--
-- insert with similar expression / target_list VALUES (all fail)
--
--Testcase 146:
INSERT INTO tntbl2 (_id, c1, c2, c3) VALUES ('121', DEFAULT, DEFAULT);
ERROR:  INSERT has more target columns than expressions
LINE 1: INSERT INTO tntbl2 (_id, c1, c2, c3) VALUES ('121', DEFAULT,...
                                         ^
--Testcase 147:
INSERT INTO tntbl2 (_id, c1, c2, c3) VALUES ('122', 1, '2');
ERROR:  INSERT has more target columns than expressions
LINE 1: INSERT INTO tntbl2 (_id, c1, c2, c3) VALUES ('122', 1, '2');
                                         ^
--Testcase 148:
INSERT INTO tntbl2 (_id, c1) VALUES ('a', 1, '3');
ERROR:  INSERT has more expressions than target columns
LINE 1: INSERT INTO tntbl2 (_id, c1) VALUES ('a', 1, '3');
                                                     ^
--Testcase 149:
INSERT INTO tntbl2 (_id, c1) VALUES ('b', DEFAULT, DEFAULT);
ERROR:  INSERT has more expressions than target columns
LINE 1: INSERT INTO tntbl2 (_id, c1) VALUES ('b', DEFAULT, DEFAULT);
                                                           ^
--Testcase 150:
SELECT c1, c2, c3, c4, c5, __spd_url FROM tntbl2 ORDER BY 1, 2, 3, 4, 5, 6;
 c1 |    c2     | c3 |    c4     |  c5   |    __spd_url     
----+-----------+----+-----------+-------+------------------
  1 | foo       | t  | -1928.121 |  1000 | /mongo_svr/
  1 | odbc text | t  |       100 | 10000 | /odbc_post_svr/
  2 | varchar   | f  |      2000 |  2000 | /mongo_svr/
    | 3q        |    |           |       | /jdbc_mysql_svr/
    | test      | f  |           |       | /odbc_post_svr/
    | test      | t  |      4654 |  4000 | /mongo_svr/
    |           |    |           |       | /dynamodb_svr/
    |           |    |           |       | /griddb_svr/
(8 rows)

--
-- VALUES test
--
--Testcase 151:
INSERT INTO tntbl2 VALUES('value1', 10, 'foo', false, 40.0, 5000), ('value2', -1, 'foo1', true, 2.0, DEFAULT),
    ((SELECT 'abc'), (SELECT 2), 'VALUES are fun!', true, (SELECT i FROM (VALUES(3.0)) as foo (i)), 1000);
--Testcase 152:
SELECT c1, c2, c3, c4, c5, __spd_url FROM tntbl2 ORDER BY 1, 2, 3, 4, 5, 6;
 c1 |       c2        | c3 |    c4     |  c5   |    __spd_url     
----+-----------------+----+-----------+-------+------------------
 -1 | foo1            | t  |         2 |       | /griddb_svr/
  1 | foo             | t  | -1928.121 |  1000 | /mongo_svr/
  1 | odbc text       | t  |       100 | 10000 | /odbc_post_svr/
  2 | VALUES are fun! | t  |         3 |  1000 | /jdbc_mysql_svr/
  2 | varchar         | f  |      2000 |  2000 | /mongo_svr/
 10 | foo             | f  |        40 |  5000 | /dynamodb_svr/
    | 3q              |    |           |       | /jdbc_mysql_svr/
    | test            | f  |           |       | /odbc_post_svr/
    | test            | t  |      4654 |  4000 | /mongo_svr/
    |                 |    |           |       | /dynamodb_svr/
    |                 |    |           |       | /griddb_svr/
(11 rows)

--
-- TOASTed value test
--
--Testcase 153:
INSERT INTO tntbl2 VALUES(repeat('a', 25), 30, repeat('x', 25), true, 512.0, 2000);
--Testcase 154:
SELECT c1, c3, char_length(_id), char_length(c2) FROM tntbl2 ORDER BY 1, 2, 3, 4;
 c1 | c3 | char_length | char_length 
----+----+-------------+-------------
 -1 | t  |           6 |           4
  1 | t  |           4 |           9
  1 | t  |          24 |           3
  2 | f  |          24 |           7
  2 | t  |           3 |          15
 10 | f  |           6 |           3
 30 | t  |          24 |          25
    | f  |           4 |           4
    | t  |          24 |           4
    |    |           1 |           2
    |    |           1 |            
    |    |           1 |            
(12 rows)

--
-- UPDATE
--
--Testcase 157:
SELECT char_length(_id), c1, char_length(c2), c3, c4, c5 FROM tntbl2 ORDER BY 1, 2, 3;
 char_length | c1 | char_length | c3 |    c4     |  c5   
-------------+----+-------------+----+-----------+-------
           1 |    |           2 |    |           |      
           1 |    |             |    |           |      
           1 |    |             |    |           |      
           3 |  2 |          15 | t  |         3 |  1000
           4 |  1 |           9 | t  |       100 | 10000
           4 |    |           4 | f  |           |      
           6 | -1 |           4 | t  |         2 |      
           6 | 10 |           3 | f  |        40 |  5000
          24 |  1 |           3 | t  | -1928.121 |  1000
          24 |  2 |           7 | f  |      2000 |  2000
          24 | 30 |          25 | t  |       512 |  2000
          24 |    |           4 | t  |      4654 |  4000
(12 rows)

--Testcase 158:
UPDATE tntbl2 SET c4 = DEFAULT;
--Testcase 159:
SELECT char_length(_id), c1, char_length(c2), c3, c4, c5 FROM tntbl2 ORDER BY 1, 2, 3;
 char_length | c1 | char_length | c3 | c4 |  c5   
-------------+----+-------------+----+----+-------
           1 |    |           2 |    |    |      
           1 |    |             |    |    |      
           1 |    |             |    |    |      
           3 |  2 |          15 | t  |    |  1000
           4 |  1 |           9 | t  |    | 10000
           4 |    |           4 | f  |    |      
           6 | -1 |           4 | t  |    |      
           6 | 10 |           3 | f  |    |  5000
          24 |  1 |           3 | t  |    |  1000
          24 |  2 |           7 | f  |    |  2000
          24 | 30 |          25 | t  |    |  2000
          24 |    |           4 | t  |    |  4000
(12 rows)

-- aliases for the UPDATE target table
--Testcase 160:
UPDATE tntbl2 AS t SET c1 = 10 WHERE t.c5 = 1000;
--Testcase 161:
SELECT char_length(_id), c1, char_length(c2), c3, c4, c5 FROM tntbl2 ORDER BY 1, 2, 3;
 char_length | c1 | char_length | c3 | c4 |  c5   
-------------+----+-------------+----+----+-------
           1 |    |           2 |    |    |      
           1 |    |             |    |    |      
           1 |    |             |    |    |      
           3 | 10 |          15 | t  |    |  1000
           4 |  1 |           9 | t  |    | 10000
           4 |    |           4 | f  |    |      
           6 | -1 |           4 | t  |    |      
           6 | 10 |           3 | f  |    |  5000
          24 |  2 |           7 | f  |    |  2000
          24 | 10 |           3 | t  |    |  1000
          24 | 30 |          25 | t  |    |  2000
          24 |    |           4 | t  |    |  4000
(12 rows)

--Testcase 162:
UPDATE tntbl2 t SET c1 = t.c1 + 10 WHERE t.c5 = 1000;
--Testcase 163:
SELECT char_length(_id), c1, char_length(c2), c3, c4, c5 FROM tntbl2 ORDER BY 1, 2, 3;
 char_length | c1 | char_length | c3 | c4 |  c5   
-------------+----+-------------+----+----+-------
           1 |    |           2 |    |    |      
           1 |    |             |    |    |      
           1 |    |             |    |    |      
           3 | 20 |          15 | t  |    |  1000
           4 |  1 |           9 | t  |    | 10000
           4 |    |           4 | f  |    |      
           6 | -1 |           4 | t  |    |      
           6 | 10 |           3 | f  |    |  5000
          24 |  2 |           7 | f  |    |  2000
          24 | 20 |           3 | t  |    |  1000
          24 | 30 |          25 | t  |    |  2000
          24 |    |           4 | t  |    |  4000
(12 rows)

--
-- Test VALUES in FROM
--
--Testcase 164:
UPDATE tntbl2 SET c1=v.i FROM (VALUES(10, 1000)) AS v(i, j)
  WHERE tntbl2.c5 = v.j;
--Testcase 165:
SELECT char_length(_id), c1, char_length(c2), c3, c4, c5 FROM tntbl2 ORDER BY 1, 2, 3, 4, 5, 6;
 char_length | c1 | char_length | c3 | c4 |  c5   
-------------+----+-------------+----+----+-------
           1 |    |           2 |    |    |      
           1 |    |             |    |    |      
           1 |    |             |    |    |      
           3 | 10 |          15 | t  |    |  1000
           4 |  1 |           9 | t  |    | 10000
           4 |    |           4 | f  |    |      
           6 | -1 |           4 | t  |    |      
           6 | 10 |           3 | f  |    |  5000
          24 |  2 |           7 | f  |    |  2000
          24 | 10 |           3 | t  |    |  1000
          24 | 30 |          25 | t  |    |  2000
          24 |    |           4 | t  |    |  4000
(12 rows)

-- fail, wrong data type:
--Testcase 166:
UPDATE tntbl2 SET c1 = v.* FROM (VALUES(1000, 10)) AS v(i, j)
  WHERE tntbl2.c5 = v.j;
ERROR:  column "c1" is of type integer but expression is of type record
LINE 1: UPDATE tntbl2 SET c1 = v.* FROM (VALUES(1000, 10)) AS v(i, j...
                               ^
HINT:  You will need to rewrite or cast the expression.
--
-- Test multiple-set-clause syntax
--
--Testcase 167:
INSERT INTO tntbl2 (SELECT _id || 's#', c1 + 1, c2 || '@@' FROM tntbl2 ORDER BY 1, 2, 3);
--Testcase 168:
SELECT char_length(_id), c1, char_length(c2), c3, c4, c5 FROM tntbl2 ORDER BY 1, 2, 3, 4, 5, 6;
 char_length | c1 | char_length | c3 | c4 |  c5   
-------------+----+-------------+----+----+-------
           1 |    |           2 |    |    |      
           1 |    |             |    |    |      
           1 |    |             |    |    |      
           3 | 10 |          15 | t  |    |  1000
           3 |    |           4 |    |    |      
           3 |    |             |    |    |      
           3 |    |             |    |    |      
           4 |  1 |           9 | t  |    | 10000
           4 |    |           4 | f  |    |      
           5 | 11 |          17 |    |    |      
           6 | -1 |           4 | t  |    |      
           6 |  2 |          11 |    |    |      
           6 | 10 |           3 | f  |    |  5000
           8 |  0 |           6 |    |    |      
           8 | 11 |           5 |    |    |      
          24 |  2 |           7 | f  |    |  2000
          24 | 10 |           3 | t  |    |  1000
          24 | 30 |          25 | t  |    |  2000
          24 |    |           4 | t  |    |  4000
          24 |    |           6 |    |    |      
          24 |    |           6 |    |    |      
          26 |  3 |           9 |    |    |      
          26 | 11 |           5 |    |    |      
          26 | 31 |          27 |    |    |      
(24 rows)

--Bug of PGSpider master branch
-- --Testcase 169:
-- UPDATE tntbl2 SET (c2, c1, c3) = ('bugle', c1+11, DEFAULT) WHERE c3 = true;
--Testcase 170:
SELECT char_length(_id), c1, char_length(c2), c3, c4, c5 FROM tntbl2 ORDER BY 1, 2, 3, 4, 5, 6;
 char_length | c1 | char_length | c3 | c4 |  c5   
-------------+----+-------------+----+----+-------
           1 |    |           2 |    |    |      
           1 |    |             |    |    |      
           1 |    |             |    |    |      
           3 | 10 |          15 | t  |    |  1000
           3 |    |           4 |    |    |      
           3 |    |             |    |    |      
           3 |    |             |    |    |      
           4 |  1 |           9 | t  |    | 10000
           4 |    |           4 | f  |    |      
           5 | 11 |          17 |    |    |      
           6 | -1 |           4 | t  |    |      
           6 |  2 |          11 |    |    |      
           6 | 10 |           3 | f  |    |  5000
           8 |  0 |           6 |    |    |      
           8 | 11 |           5 |    |    |      
          24 |  2 |           7 | f  |    |  2000
          24 | 10 |           3 | t  |    |  1000
          24 | 30 |          25 | t  |    |  2000
          24 |    |           4 | t  |    |  4000
          24 |    |           6 |    |    |      
          24 |    |           6 |    |    |      
          26 |  3 |           9 |    |    |      
          26 | 11 |           5 |    |    |      
          26 | 31 |          27 |    |    |      
(24 rows)

--Testcase 171:
UPDATE tntbl2 SET (c2, c1) = ('car', c1 + c5), c4 = c4 + 10.0 WHERE c1 = 10;
--Testcase 172:
SELECT char_length(_id), c1, char_length(c2), c3, c4, c5 FROM tntbl2 ORDER BY 1, 2, 3, 4, 5, 6;
 char_length |  c1  | char_length | c3 | c4 |  c5   
-------------+------+-------------+----+----+-------
           1 |      |           2 |    |    |      
           1 |      |             |    |    |      
           1 |      |             |    |    |      
           3 | 1010 |           3 | t  |    |  1000
           3 |      |           4 |    |    |      
           3 |      |             |    |    |      
           3 |      |             |    |    |      
           4 |    1 |           9 | t  |    | 10000
           4 |      |           4 | f  |    |      
           5 |   11 |          17 |    |    |      
           6 |   -1 |           4 | t  |    |      
           6 |    2 |          11 |    |    |      
           6 | 5010 |           3 | f  |    |  5000
           8 |    0 |           6 |    |    |      
           8 |   11 |           5 |    |    |      
          24 |    2 |           7 | f  |    |  2000
          24 |   30 |          25 | t  |    |  2000
          24 | 1010 |           3 | t  |    |  1000
          24 |      |           4 | t  |    |  4000
          24 |      |           6 |    |    |      
          24 |      |           6 |    |    |      
          26 |    3 |           9 |    |    |      
          26 |   11 |           5 |    |    |      
          26 |   31 |          27 |    |    |      
(24 rows)

-- fail, multi assignment to same column:
--Testcase 173:
UPDATE tntbl2 SET (c2, c4) = ('car', c1 + c4), c4 = c1 + 1 WHERE c1 = 10;
ERROR:  multiple assignments to same column "c4"
-- uncorrelated sub-SELECT:
--Testcase 174:
UPDATE tntbl2
  SET (c2, c3) = (SELECT c2, c3 FROM tntbl2 where c1 = 5010)
  WHERE c5 = 1000 AND c1 = 1010;
--Testcase 175:
SELECT char_length(_id), c1, char_length(c2), c3, c4, c5 FROM tntbl2 ORDER BY 1, 2, 3, 4, 5, 6;
 char_length |  c1  | char_length | c3 | c4 |  c5   
-------------+------+-------------+----+----+-------
           1 |      |           2 |    |    |      
           1 |      |             |    |    |      
           1 |      |             |    |    |      
           3 | 1010 |           3 | f  |    |  1000
           3 |      |           4 |    |    |      
           3 |      |             |    |    |      
           3 |      |             |    |    |      
           4 |    1 |           9 | t  |    | 10000
           4 |      |           4 | f  |    |      
           5 |   11 |          17 |    |    |      
           6 |   -1 |           4 | t  |    |      
           6 |    2 |          11 |    |    |      
           6 | 5010 |           3 | f  |    |  5000
           8 |    0 |           6 |    |    |      
           8 |   11 |           5 |    |    |      
          24 |    2 |           7 | f  |    |  2000
          24 |   30 |          25 | t  |    |  2000
          24 | 1010 |           3 | f  |    |  1000
          24 |      |           4 | t  |    |  4000
          24 |      |           6 |    |    |      
          24 |      |           6 |    |    |      
          26 |    3 |           9 |    |    |      
          26 |   11 |           5 |    |    |      
          26 |   31 |          27 |    |    |      
(24 rows)

-- correlated sub-SELECT:
--Testcase 176:
UPDATE tntbl2 o
  SET (c5, c1) = (SELECT c1+1, c5 FROM tntbl2 i
               where i.c1=o.c1 and i.c5=o.c5 and i.c2 is not distinct FROM o.c2 and char_length(i._id) = 24);
--Testcase 177:
SELECT char_length(_id), c1, char_length(c2), c3, c4, c5 FROM tntbl2 ORDER BY 1, 2, 3, 4, 5;
 char_length |  c1  | char_length | c3 | c4 |  c5  
-------------+------+-------------+----+----+------
           1 |      |           2 |    |    |     
           1 |      |             |    |    |     
           1 |      |             |    |    |     
           3 |      |           3 | f  |    |     
           3 |      |           4 |    |    |     
           3 |      |             |    |    |     
           3 |      |             |    |    |     
           4 |      |           4 | f  |    |     
           4 |      |           9 | t  |    |     
           5 |      |          17 |    |    |     
           6 |      |           3 | f  |    |     
           6 |      |           4 | t  |    |     
           6 |      |          11 |    |    |     
           8 |      |           5 |    |    |     
           8 |      |           6 |    |    |     
          24 | 1000 |           3 | f  |    | 1011
          24 | 2000 |           7 | f  |    |    3
          24 | 2000 |          25 | t  |    |   31
          24 |      |           4 | t  |    |     
          24 |      |           6 |    |    |     
          24 |      |           6 |    |    |     
          26 |      |           5 |    |    |     
          26 |      |           9 |    |    |     
          26 |      |          27 |    |    |     
(24 rows)

-- fail, multiple rows supplied:
--Testcase 178:
UPDATE tntbl2 SET (c5, c1) = (SELECT c1+1, c5 FROM tntbl2);
ERROR:  more than one row returned by a subquery used as an expression
-- set to null if no rows supplied:
--Testcase 179:
UPDATE tntbl2 SET (c5 , c1) = (SELECT c1+1, c5 FROM tntbl2 where c4 = 10.0)
  WHERE c4 = 50.0;
--Testcase 180:
SELECT char_length(_id), c1, char_length(c2), c3, c4, c5 FROM tntbl2 ORDER BY 1, 2, 3, 4, 5;
 char_length |  c1  | char_length | c3 | c4 |  c5  
-------------+------+-------------+----+----+------
           1 |      |           2 |    |    |     
           1 |      |             |    |    |     
           1 |      |             |    |    |     
           3 |      |           3 | f  |    |     
           3 |      |           4 |    |    |     
           3 |      |             |    |    |     
           3 |      |             |    |    |     
           4 |      |           4 | f  |    |     
           4 |      |           9 | t  |    |     
           5 |      |          17 |    |    |     
           6 |      |           3 | f  |    |     
           6 |      |           4 | t  |    |     
           6 |      |          11 |    |    |     
           8 |      |           5 |    |    |     
           8 |      |           6 |    |    |     
          24 | 1000 |           3 | f  |    | 1011
          24 | 2000 |           7 | f  |    |    3
          24 | 2000 |          25 | t  |    |   31
          24 |      |           4 | t  |    |     
          24 |      |           6 |    |    |     
          24 |      |           6 |    |    |     
          26 |      |           5 |    |    |     
          26 |      |           9 |    |    |     
          26 |      |          27 |    |    |     
(24 rows)

-- *-expansion should work in this context:
--Testcase 181:
UPDATE tntbl2 SET (c1, c5) = ROW(v.*) FROM (VALUES(20, 3)) AS v(i, j)
  WHERE tntbl2.c1 = v.j;
-- you might expect this to work, but syntactically it's not a RowExpr:
--Testcase 182:
UPDATE tntbl2 SET (c1, c5) = (v.*) FROM (VALUES(20, 3)) AS v(i, j)
  WHERE tntbl2.c1 = v.j;
ERROR:  source for a multiple-column UPDATE item must be a sub-SELECT or ROW() expression
LINE 1: UPDATE tntbl2 SET (c1, c5) = (v.*) FROM (VALUES(20, 3)) AS v...
                                      ^
-- if an alias for the target table is specified, don't allow references
-- to the original table name
--Testcase 183:
UPDATE tntbl2 AS t SET c4 = tntbl2.c4 + 10 WHERE t.c1 = 10;
ERROR:  invalid reference to FROM-clause entry for table "tntbl2"
LINE 1: UPDATE tntbl2 AS t SET c4 = tntbl2.c4 + 10 WHERE t.c1 = 10;
                                    ^
HINT:  Perhaps you meant to reference the table alias "t".
-- Make sure that we can update to a TOASTed value.
--Testcase 184:
UPDATE tntbl2 SET c2 = repeat('x', 25) WHERE c2 = 'car';
--Testcase 185:
SELECT c1, char_length(c2), char_length(_id) FROM tntbl2 ORDER BY 1, 2, 3;
  c1  | char_length | char_length 
------+-------------+-------------
 1000 |          25 |          24
 2000 |           7 |          24
 2000 |          25 |          24
      |           2 |           1
      |           4 |           3
      |           4 |           4
      |           4 |           6
      |           4 |          24
      |           5 |           8
      |           5 |          26
      |           6 |           8
      |           6 |          24
      |           6 |          24
      |           9 |           4
      |           9 |          26
      |          11 |           6
      |          17 |           5
      |          25 |           3
      |          25 |           6
      |          27 |          26
      |             |           1
      |             |           1
      |             |           3
      |             |           3
(24 rows)

-- Check multi-assignment with a Result node to handle a one-time filter.
--Testcase 186:
EXPLAIN (VERBOSE, COSTS OFF)
UPDATE tntbl2 t
  SET (c1, c5) = (SELECT c5, c1 FROM tntbl2 s WHERE s.c1 = t.c1)
  WHERE CURRENT_USER = SESSION_USER;
                                                                                                                             QUERY PLAN                                                                                                                              
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Update on public.tntbl2 t
   Node: dynamodb_svr / Status: Alive
     Remote SQL: UPDATE tntbl2 SET c1 = ? SET c5 = ? WHERE _id = ?
   Node: griddb_svr / Status: Alive
   Node: jdbc_mysql_svr / Status: Alive
     Remote SQL: UPDATE tntbl2 SET c1 = ?, c5 = ? WHERE _id=?
   Node: mongo_svr / Status: Alive
     Foreign Namespace: mongo_pg_modify.tntbl2
   Node: odbc_post_svr / Status: Alive
     Remote SQL: UPDATE public.tntbl2 SET c1 = ?, c5 = ? WHERE _id = ?
   ->  Result
         Output: (($1)::integer), (($2)::bigint), ((SubPlan 1 (returns $1,$2))), t._id, t._id, t._id, t._id, t._id, t.__spd_url, t.*
         One-Time Filter: (CURRENT_USER = SESSION_USER)
         ->  Foreign Scan on public.tntbl2 t
               Output: $1, $2, (SubPlan 1 (returns $1,$2)), t._id, t._id, t._id, t._id, t._id, t.__spd_url, t.*
               Filter: (CURRENT_USER = SESSION_USER)
               Node: dynamodb_svr / Status: Alive
                 Remote SQL: SELECT _id, c1, c2, c3, c4, c5 FROM tntbl2
               Node: griddb_svr / Status: Alive
                 Remote SQL: SELECT  *  FROM tntbl2
               Node: jdbc_mysql_svr / Status: Alive
                 Remote SQL: SELECT _id, c1, c2, c3, c4, c5 FROM tntbl2
               Node: mongo_svr / Status: Alive
                 Foreign Namespace: mongo_pg_modify.tntbl2
                 Query document: { "pipeline" : [ { "$project" : { "_id" : { "$numberInt" : "1" }, "c1" : { "$numberInt" : "1" }, "c2" : { "$numberInt" : "1" }, "c3" : { "$numberInt" : "1" }, "c4" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" } } } ] }
               Node: odbc_post_svr / Status: Alive
                 Remote SQL: SELECT _id, c1, c2, c3, c4, c5 FROM public.tntbl2
               SubPlan 1 (returns $1,$2)
                 ->  Foreign Scan on public.tntbl2 s
                       Output: s.c5, s.c1
                       Filter: (s.c1 = t.c1)
                       Node: dynamodb_svr / Status: Alive
                         Remote SQL: SELECT c1, c5 FROM tntbl2
                       Node: griddb_svr / Status: Alive
                         Remote SQL: SELECT  *  FROM tntbl2
                       Node: jdbc_mysql_svr / Status: Alive
                         Remote SQL: SELECT c1, c5 FROM tntbl2
                       Node: mongo_svr / Status: Alive
                         Foreign Namespace: mongo_pg_modify.tntbl2
                         Query document: { "pipeline" : [ { "$project" : { "c1" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" } } } ] }
                       Node: odbc_post_svr / Status: Alive
                         Remote SQL: SELECT c1, c5 FROM public.tntbl2
(42 rows)

--Testcase 187:
UPDATE tntbl2 t
  SET (c1, c5) = (SELECT c5, c1 FROM tntbl2 s WHERE s.c1 = t.c1)
  WHERE CURRENT_USER = SESSION_USER;
ERROR:  more than one row returned by a subquery used as an expression
--Testcase 188:
SELECT c1, c5, char_length(c2) FROM tntbl2 ORDER BY 1, 2, 3;
  c1  |  c5  | char_length 
------+------+-------------
 1011 | 1000 |          25
 2000 |    3 |           7
 2000 |   31 |          25
      |      |           2
      |      |           4
      |      |           4
      |      |           4
      |      |           4
      |      |           5
      |      |           5
      |      |           6
      |      |           6
      |      |           6
      |      |           9
      |      |           9
      |      |          11
      |      |          17
      |      |          25
      |      |          25
      |      |          27
      |      |            
      |      |            
      |      |            
      |      |            
(24 rows)

--
-- UPDATE with IN feature
--
--Testcase 189:
UPDATE tntbl2 IN ('/dynamodb_svr/') SET c4 = 56563.1212;
--Testcase 190:
UPDATE tntbl2 IN ('/odbc_post_svr/', '/jdbc_mysql_svr/') SET c4 = 22.2;
--
-- INSERT with IN feature
--
--Testcase 155:
INSERT INTO tntbl2 IN ('/griddb_svr/') VALUES ('in1', 10, 'tst_in_feature', false, 5.0, 5000);
--Testcase 156:
INSERT INTO tntbl2 IN ('/dynamodb_svr/', '/mongo_svr/') VALUES ('in2', 20, 'tst_in_feature', true, 6.0, 6000);
--
-- DELETE
--
-- allow an alias to be specified for DELETE's target table
--Testcase 191:
DELETE FROM tntbl2 AS dt WHERE dt.c1 > 75;
-- if an alias is specified, don't allow the original table name
-- to be referenced
--Testcase 192:
DELETE FROM tntbl2 dt WHERE tntbl2.c1 > 25;
ERROR:  invalid reference to FROM-clause entry for table "tntbl2"
LINE 1: DELETE FROM tntbl2 dt WHERE tntbl2.c1 > 25;
                                    ^
HINT:  Perhaps you meant to reference the table alias "dt".
--Testcase 193:
SELECT char_length(_id), c1, char_length(c2) FROM tntbl2 ORDER BY 1, 2, 3;
 char_length | c1 | char_length 
-------------+----+-------------
           1 |    |           2
           1 |    |            
           1 |    |            
           3 | 10 |          14
           3 |    |           4
           3 |    |          25
           3 |    |            
           3 |    |            
           4 |    |           4
           4 |    |           9
           5 |    |          17
           6 |    |           4
           6 |    |          11
           6 |    |          25
           8 |    |           5
           8 |    |           6
          24 | 20 |          14
          24 |    |           4
          24 |    |           6
          24 |    |           6
          26 |    |           5
          26 |    |           9
          26 |    |          27
(23 rows)

-- delete a row with a TOASTed value
--Testcase 194:
DELETE FROM tntbl2 WHERE c2 = 'car';
--Testcase 195:
SELECT c1, char_length(_id) FROM tntbl2 ORDER BY 1, 2;
 c1 | char_length 
----+-------------
 10 |           3
 20 |          24
    |           1
    |           1
    |           1
    |           3
    |           3
    |           3
    |           3
    |           4
    |           4
    |           5
    |           6
    |           6
    |           6
    |           8
    |           8
    |          24
    |          24
    |          24
    |          26
    |          26
    |          26
(23 rows)

--
-- DELETE with IN feature
--
--Testcase 196:
DELETE FROM tntbl2 IN ('/mongo_svr/') WHERE c1 = 10;
--Testcase 197:
DELETE FROM tntbl2 IN ('/dynamodb_svr/', '/odbc_post_svr/', '/griddb_svr/') WHERE c5 = 4000;
-- *** Finish test for tntbl2 *** --
-----------------------------------------------------------------------------------
-- *** Start test for tntbl3 *** --
--
-- INSERT
-- insert with DEFAULT in the target_list
--
--Testcase 198:
Set pgspider_core_fdw.throw_error_ifdead to false;
INSERT INTO tntbl3 (_id, c1, c2, c3, c4) VALUES ('@', DEFAULT, DEFAULT, DEFAULT, DEFAULT);
--Testcase 199:
INSERT INTO tntbl3 (_id, c2, c3) VALUES ('_3', 3.0, DEFAULT);
--Testcase 200:
INSERT INTO tntbl3 (_id, c1, c2, c3) VALUES ('_4', DEFAULT, 5.0, DEFAULT);
--Testcase 201:
INSERT INTO tntbl3 VALUES ('test1', DEFAULT, 5.0, 600.0, 1000);
--Testcase 202:
INSERT INTO tntbl3 VALUES ('test2', DEFAULT, 7.0);
--Testcase 203:
SELECT c1, c2, c3, c4, __spd_url FROM tntbl3 ORDER BY 1, 2, 3, 4, 5;
 c1 |  c2   |  c3  |  c4   |    __spd_url    
----+-------+------+-------+-----------------
  1 | -19.1 |      |       | /mongo_svr/
  1 |     1 |  100 |  1000 | /postgres_svr/
  1 |     1 |  100 |  1000 | /sqlite_svr/
  1 |     1 |  100 |  1000 | /tiny_svr/
  2 |    20 |      |       | /mongo_svr/
 10 |    10 | 1000 | 10000 | /jdbc_post_svr/
    |     3 |      |       | /griddb_svr/
    |     5 |  600 |  1000 | /mongo_svr/
    |     5 |      |       | /jdbc_post_svr/
    |     7 |      |       | /mysql_svr/
    |       |      |       | /dynamodb_svr/
(11 rows)

--
-- insert with similar expression / target_list VALUES (all fail)
--
--Testcase 204:
INSERT INTO tntbl3 (_id, c1, c2, c3) VALUES ('wrong1', DEFAULT, DEFAULT);
ERROR:  INSERT has more target columns than expressions
LINE 1: INSERT INTO tntbl3 (_id, c1, c2, c3) VALUES ('wrong1', DEFAU...
                                         ^
--Testcase 205:
INSERT INTO tntbl3 (_id, c1, c2, c3) VALUES ('wrong2', 1, 2.0);
ERROR:  INSERT has more target columns than expressions
LINE 1: INSERT INTO tntbl3 (_id, c1, c2, c3) VALUES ('wrong2', 1, 2....
                                         ^
--Testcase 206:
INSERT INTO tntbl3 (_id, c1) VALUES ('wrong3', 1, 2);
ERROR:  INSERT has more expressions than target columns
LINE 1: INSERT INTO tntbl3 (_id, c1) VALUES ('wrong3', 1, 2);
                                                          ^
--Testcase 207:
INSERT INTO tntbl3 (_id, c1) VALUES ('wrong4',DEFAULT, DEFAULT);
ERROR:  INSERT has more expressions than target columns
LINE 1: ...RT INTO tntbl3 (_id, c1) VALUES ('wrong4',DEFAULT, DEFAULT);
                                                              ^
--Testcase 208:
SELECT c1, c2, c3, c4, __spd_url FROM tntbl3 ORDER BY 1, 2, 3, 4, 5;
 c1 |  c2   |  c3  |  c4   |    __spd_url    
----+-------+------+-------+-----------------
  1 | -19.1 |      |       | /mongo_svr/
  1 |     1 |  100 |  1000 | /postgres_svr/
  1 |     1 |  100 |  1000 | /sqlite_svr/
  1 |     1 |  100 |  1000 | /tiny_svr/
  2 |    20 |      |       | /mongo_svr/
 10 |    10 | 1000 | 10000 | /jdbc_post_svr/
    |     3 |      |       | /griddb_svr/
    |     5 |  600 |  1000 | /mongo_svr/
    |     5 |      |       | /jdbc_post_svr/
    |     7 |      |       | /mysql_svr/
    |       |      |       | /dynamodb_svr/
(11 rows)

--
-- VALUES test
--
--Testcase 209:
INSERT INTO tntbl3 VALUES('test11', 10, 2.0, 20.0, 2000), ('test22', -1, 2.0, DEFAULT, 3000),
    ((SELECT 'test33'), (SELECT 90), (SELECT i FROM (VALUES(3.0)) as foo (i)), 30.0, 4000);
--Testcase 210:
SELECT c1, c2, c3, c4, __spd_url FROM tntbl3 ORDER BY 1, 2, 3, 4, 5;
 c1 |  c2   |  c3  |  c4   |    __spd_url     
----+-------+------+-------+------------------
 -1 |     2 |      |  3000 | /oracle_svr/
  1 | -19.1 |      |       | /mongo_svr/
  1 |     1 |  100 |  1000 | /postgres_svr/
  1 |     1 |  100 |  1000 | /sqlite_svr/
  1 |     1 |  100 |  1000 | /tiny_svr/
  2 |    20 |      |       | /mongo_svr/
 10 |     2 |   20 |  2000 | /odbc_mysql_svr/
 10 |    10 | 1000 | 10000 | /jdbc_post_svr/
 90 |     3 |   30 |  4000 | /postgres_svr/
    |     3 |      |       | /griddb_svr/
    |     5 |  600 |  1000 | /mongo_svr/
    |     5 |      |       | /jdbc_post_svr/
    |     7 |      |       | /mysql_svr/
    |       |      |       | /dynamodb_svr/
(14 rows)

--
-- TOASTed value test
--
--Testcase 211:
INSERT INTO tntbl3 VALUES(repeat('x', 25), 20, 4.0, 40.0, 5000);
--Testcase 212:
SELECT c1, c2 FROM tntbl3 ORDER BY 1, 2;
 c1 |  c2   
----+-------
 -1 |     2
  1 | -19.1
  1 |     1
  1 |     1
  1 |     1
  2 |    20
 10 |     2
 10 |    10
 20 |     4
 90 |     3
    |     3
    |     5
    |     5
    |     7
    |      
(15 rows)

--
-- INSERT with IN feature
--
--Testcase 213:
INSERT INTO tntbl3 IN ('/sqlite_svr/') VALUES ('_test', 10, 5.0, 50.0, 5000);
--Testcase 214:
INSERT INTO tntbl3 IN ('/dynamodb_svr/', '/mongo_svr/', '/griddb_svr/', '/mysql_svr/', '/postgres_svr/', '/postgres_svr_1/') VALUES ('_infea', 20, 6.0, 60.0, 6000);
--
-- UPDATE
--
--Testcase 215:
SELECT c1, c2, c3, c4 FROM tntbl3 ORDER BY 1, 2, 3;
 c1 |  c2   |  c3  |  c4   
----+-------+------+-------
 -1 |     2 |      |  3000
  1 | -19.1 |      |      
  1 |     1 |  100 |  1000
  1 |     1 |  100 |  1000
  1 |     1 |  100 |  1000
  2 |    20 |      |      
 10 |     2 |   20 |  2000
 10 |     5 |   50 |  5000
 10 |    10 | 1000 | 10000
 20 |     4 |   40 |  5000
 20 |     6 |   60 |  6000
 90 |     3 |   30 |  4000
    |     3 |      |      
    |     5 |  600 |  1000
    |     5 |      |      
    |     7 |      |      
    |       |      |      
(17 rows)

--Testcase 216:
UPDATE tntbl3 SET c3 = DEFAULT, c4 = DEFAULT;
--Testcase 217:
SELECT c1, c2, c3, c4 FROM tntbl3 ORDER BY 1, 2, 3;
 c1 |  c2   | c3 | c4 
----+-------+----+----
 -1 |     2 |    |   
  1 | -19.1 |    |   
  1 |     1 |    |   
  1 |     1 |    |   
  1 |     1 |    |   
  2 |    20 |    |   
 10 |     2 |    |   
 10 |     5 |    |   
 10 |    10 |    |   
 20 |     4 |    |   
 20 |     6 |    |   
 90 |     3 |    |   
    |     3 |    |   
    |     5 |    |   
    |     5 |    |   
    |     7 |    |   
    |       |    |   
(17 rows)

-- aliases for the UPDATE target table
--Testcase 218:
UPDATE tntbl3 AS t SET c1 = 10 WHERE t.c2 = 2.0;
--Testcase 219:
SELECT c1, c2, c3, c4 FROM tntbl3 ORDER BY 1, 2, 3;
 c1 |  c2   | c3 | c4 
----+-------+----+----
  1 | -19.1 |    |   
  1 |     1 |    |   
  1 |     1 |    |   
  1 |     1 |    |   
  2 |    20 |    |   
 10 |     2 |    |   
 10 |     2 |    |   
 10 |     5 |    |   
 10 |    10 |    |   
 20 |     4 |    |   
 20 |     6 |    |   
 90 |     3 |    |   
    |     3 |    |   
    |     5 |    |   
    |     5 |    |   
    |     7 |    |   
    |       |    |   
(17 rows)

--Testcase 220:
UPDATE tntbl3 t SET c1 = t.c1 + 10 WHERE t.c2 = 4.0;
--Testcase 221:
SELECT c1, c2, c3, c4 FROM tntbl3 ORDER BY 1, 2, 3;
 c1 |  c2   | c3 | c4 
----+-------+----+----
  1 | -19.1 |    |   
  1 |     1 |    |   
  1 |     1 |    |   
  1 |     1 |    |   
  2 |    20 |    |   
 10 |     2 |    |   
 10 |     2 |    |   
 10 |     5 |    |   
 10 |    10 |    |   
 20 |     6 |    |   
 30 |     4 |    |   
 90 |     3 |    |   
    |     3 |    |   
    |     5 |    |   
    |     5 |    |   
    |     7 |    |   
    |       |    |   
(17 rows)

--
-- Test VALUES in FROM
--
--Testcase 222:
UPDATE tntbl3 SET c1=v.i FROM (VALUES(100, 5)) AS v(i, j)
  WHERE tntbl3.c1 = v.j;
--Testcase 223:
SELECT c1, c2, c3, c4 FROM tntbl3 ORDER BY 1, 2, 3;
 c1 |  c2   | c3 | c4 
----+-------+----+----
  1 | -19.1 |    |   
  1 |     1 |    |   
  1 |     1 |    |   
  1 |     1 |    |   
  2 |    20 |    |   
 10 |     2 |    |   
 10 |     2 |    |   
 10 |     5 |    |   
 10 |    10 |    |   
 20 |     6 |    |   
 30 |     4 |    |   
 90 |     3 |    |   
    |     3 |    |   
    |     5 |    |   
    |     5 |    |   
    |     7 |    |   
    |       |    |   
(17 rows)

-- fail, wrong data type:
--Testcase 224:
UPDATE tntbl3 SET c1 = v.* FROM (VALUES(100, 2000)) AS v(i, j)
  WHERE tntbl3.c4 = v.j;
ERROR:  column "c1" is of type integer but expression is of type record
LINE 1: UPDATE tntbl3 SET c1 = v.* FROM (VALUES(100, 2000)) AS v(i, ...
                               ^
HINT:  You will need to rewrite or cast the expression.
--
-- Test multiple-set-clause syntax
--
--Testcase 225:
-- oracle_fdw issue skip/report
-- INSERT INTO tntbl3 SELECT _id || '1', c1 + 1, c2 + 1, c3 FROM tntbl3;
--Testcase 226:
SELECT c1, c2, c3, c4 FROM tntbl3 ORDER BY 1, 2, 3;
 c1 |  c2   | c3 | c4 
----+-------+----+----
  1 | -19.1 |    |   
  1 |     1 |    |   
  1 |     1 |    |   
  1 |     1 |    |   
  2 |    20 |    |   
 10 |     2 |    |   
 10 |     2 |    |   
 10 |     5 |    |   
 10 |    10 |    |   
 20 |     6 |    |   
 30 |     4 |    |   
 90 |     3 |    |   
    |     3 |    |   
    |     5 |    |   
    |     5 |    |   
    |     7 |    |   
    |       |    |   
(17 rows)

--Testcase 227:
UPDATE tntbl3 SET (c1, c2) = (c1 + 11, DEFAULT) WHERE c2 = 2.0;
--Testcase 228:
SELECT c1, c2, c3, c4 FROM tntbl3 ORDER BY 1, 2, 3;
 c1 |  c2   | c3 | c4 
----+-------+----+----
  1 | -19.1 |    |   
  1 |     1 |    |   
  1 |     1 |    |   
  1 |     1 |    |   
  2 |    20 |    |   
 10 |     5 |    |   
 10 |    10 |    |   
 20 |     6 |    |   
 21 |       |    |   
 21 |       |    |   
 30 |     4 |    |   
 90 |     3 |    |   
    |     3 |    |   
    |     5 |    |   
    |     5 |    |   
    |     7 |    |   
    |       |    |   
(17 rows)

-- fail, multi assignment to same column:
--Testcase 229:
UPDATE tntbl3 SET (c3) = (c2 + c3), c1 = c1 + 1 WHERE c1 = 10;
ERROR:  source for a multiple-column UPDATE item must be a sub-SELECT or ROW() expression
LINE 1: UPDATE tntbl3 SET (c3) = (c2 + c3), c1 = c1 + 1 WHERE c1 = 1...
                                  ^
--Testcase 230:
SELECT c1, c2, c3, c4 FROM tntbl3 ORDER BY 1, 2, 3;
 c1 |  c2   | c3 | c4 
----+-------+----+----
  1 | -19.1 |    |   
  1 |     1 |    |   
  1 |     1 |    |   
  1 |     1 |    |   
  2 |    20 |    |   
 10 |     5 |    |   
 10 |    10 |    |   
 20 |     6 |    |   
 21 |       |    |   
 21 |       |    |   
 30 |     4 |    |   
 90 |     3 |    |   
    |     3 |    |   
    |     5 |    |   
    |     5 |    |   
    |     7 |    |   
    |       |    |   
(17 rows)

--Testcase 231:
UPDATE tntbl3 SET (c2) = (c2 + c3), c2 = c1 + 1 WHERE c4 = 3000;
ERROR:  source for a multiple-column UPDATE item must be a sub-SELECT or ROW() expression
LINE 1: UPDATE tntbl3 SET (c2) = (c2 + c3), c2 = c1 + 1 WHERE c4 = 3...
                                  ^
-- uncorrelated sub-SELECT:
--Testcase 232:
UPDATE tntbl3
  SET (c2, c3) = (SELECT c3, c2 FROM tntbl3 where c1 = 11 and _id = 'car1')
  WHERE c2 = 2.0 AND c3 = 20.0;
--Testcase 233:
SELECT c1, c2, c3, c4 FROM tntbl3 ORDER BY 1, 2, 3;
 c1 |  c2   | c3 | c4 
----+-------+----+----
  1 | -19.1 |    |   
  1 |     1 |    |   
  1 |     1 |    |   
  1 |     1 |    |   
  2 |    20 |    |   
 10 |     5 |    |   
 10 |    10 |    |   
 20 |     6 |    |   
 21 |       |    |   
 21 |       |    |   
 30 |     4 |    |   
 90 |     3 |    |   
    |     3 |    |   
    |     5 |    |   
    |     5 |    |   
    |     7 |    |   
    |       |    |   
(17 rows)

-- correlated sub-SELECT:
--Testcase 234:
-- Bug of pgspider_core_fdw / commented out
-- UPDATE tntbl3 o
--   SET (c2, c3) = (SELECT c3+1, c2 FROM tntbl3 i
--                where i.c3 = o.c3 and i.c2 = o.c2 and i.c1 is not distinct FROM o.c1);
--Testcase 235:
SELECT c1, c2, c3, c4 FROM tntbl3 ORDER BY 1, 2, 3;
 c1 |  c2   | c3 | c4 
----+-------+----+----
  1 | -19.1 |    |   
  1 |     1 |    |   
  1 |     1 |    |   
  1 |     1 |    |   
  2 |    20 |    |   
 10 |     5 |    |   
 10 |    10 |    |   
 20 |     6 |    |   
 21 |       |    |   
 21 |       |    |   
 30 |     4 |    |   
 90 |     3 |    |   
    |     3 |    |   
    |     5 |    |   
    |     5 |    |   
    |     7 |    |   
    |       |    |   
(17 rows)

-- fail, multiple rows supplied:
--Testcase 236:
UPDATE tntbl3 SET (c3, c2) = (SELECT c2 + 1 , c3 FROM tntbl3);
ERROR:  more than one row returned by a subquery used as an expression
-- set to null if no rows supplied:
--Testcase 237:
UPDATE tntbl3 SET (c3, c2) = (SELECT c2 + 1, c3 FROM tntbl3 where c4 = 1000)
  WHERE c1 = 11;
--Testcase 238:
SELECT c1, c2, c3, c4 FROM tntbl3 ORDER BY 1, 2, 3, 4;
 c1 |  c2   | c3 | c4 
----+-------+----+----
  1 | -19.1 |    |   
  1 |     1 |    |   
  1 |     1 |    |   
  1 |     1 |    |   
  2 |    20 |    |   
 10 |     5 |    |   
 10 |    10 |    |   
 20 |     6 |    |   
 21 |       |    |   
 21 |       |    |   
 30 |     4 |    |   
 90 |     3 |    |   
    |     3 |    |   
    |     5 |    |   
    |     5 |    |   
    |     7 |    |   
    |       |    |   
(17 rows)

-- *-expansion should work in this context:
--Testcase 239:
UPDATE tntbl3 SET (c1, c3) = ROW(v.*) FROM (VALUES(11, 20)) AS v(i, j)
  WHERE tntbl3.c1 = v.i;
-- you might expect this to work, but syntactically it's not a RowExpr:
--Testcase 240:
UPDATE tntbl3 SET (c1, c3) = (v.*) FROM (VALUES(11, 20)) AS v(i, j)
  WHERE tntbl3.c1 = v.i;
ERROR:  source for a multiple-column UPDATE item must be a sub-SELECT or ROW() expression
LINE 1: UPDATE tntbl3 SET (c1, c3) = (v.*) FROM (VALUES(11, 20)) AS ...
                                      ^
-- if an alias for the target table is specified, don't allow references
-- to the original table name
--Testcase 241:
UPDATE tntbl3 AS t SET c1 = tntbl3.c1 + 10 WHERE t.c2 = 2.0;
ERROR:  invalid reference to FROM-clause entry for table "tntbl3"
LINE 1: UPDATE tntbl3 AS t SET c1 = tntbl3.c1 + 10 WHERE t.c2 = 2.0;
                                    ^
HINT:  Perhaps you meant to reference the table alias "t".
-- Check multi-assignment with a Result node to handle a one-time filter.
--Testcase 244:
-- Crash issue/report
-- EXPLAIN (VERBOSE, COSTS OFF)
-- UPDATE tntbl3 t
--   SET (c2, c3) = (SELECT c3, c2 FROM tntbl3 s WHERE s.c2 = t.c2)
--   WHERE CURRENT_USER = SESSION_USER;
--Testcase 245:
-- UPDATE tntbl3 t
--   SET (c2, c3) = (SELECT c3, c2 FROM tntbl3 s WHERE s.c2 = t.c2)
--   WHERE CURRENT_USER = SESSION_USER;
--Testcase 246:
SELECT c1, c2, c3, c4 FROM tntbl3 ORDER BY 1, 2, 3;
 c1 |  c2   | c3 | c4 
----+-------+----+----
  1 | -19.1 |    |   
  1 |     1 |    |   
  1 |     1 |    |   
  1 |     1 |    |   
  2 |    20 |    |   
 10 |     5 |    |   
 10 |    10 |    |   
 20 |     6 |    |   
 21 |       |    |   
 21 |       |    |   
 30 |     4 |    |   
 90 |     3 |    |   
    |     3 |    |   
    |     5 |    |   
    |     5 |    |   
    |     7 |    |   
    |       |    |   
(17 rows)

--
-- UPDATE with IN feature
--
--Testcase 247:
UPDATE tntbl3 IN ('/tiny_svr/') SET c3 = 56563.0;
--Testcase 248:
UPDATE tntbl3 IN ('/jdbc_post_svr/', '/odbc_mysql_svr/', '/oracle_svr/') SET c3 = 222.0;
--
-- DELETE
--
-- allow an alias to be specified for DELETE's target table
--Testcase 249:
DELETE FROM tntbl3 AS dt WHERE dt.c1 > 35;
-- if an alias is specified, don't allow the original table name
-- to be referenced
--Testcase 250:
DELETE FROM tntbl3 dt WHERE tntbl3.c1 > 25;
ERROR:  invalid reference to FROM-clause entry for table "tntbl3"
LINE 1: DELETE FROM tntbl3 dt WHERE tntbl3.c1 > 25;
                                    ^
HINT:  Perhaps you meant to reference the table alias "dt".
--Testcase 251:
SELECT c1, c3 FROM tntbl3 ORDER BY 1, 2;
 c1 |  c3   
----+-------
  1 | 56563
  1 |      
  1 |      
  1 |      
  2 |      
 10 |   222
 10 |      
 20 |      
 21 |   222
 21 |   222
 30 |      
    |   222
    |      
    |      
    |      
    |      
(16 rows)

-- delete a row with a TOASTed value
--Testcase 252:
DELETE FROM tntbl3 WHERE c1 > 10;
--Testcase 253:
SELECT c1, c3 FROM tntbl3 ORDER BY 1, 2;
 c1 |  c3   
----+-------
  1 | 56563
  1 |      
  1 |      
  1 |      
  2 |      
 10 |   222
 10 |      
    |   222
    |      
    |      
    |      
    |      
(12 rows)

--
-- DELETE with IN feature
--
--Testcase 254:
DELETE FROM tntbl3 IN ('/mongo_svr/') WHERE c1 = 10;
--Testcase 255:
DELETE FROM tntbl3 IN ('/dynamodb_svr/', '/odbc_mysql_svr/', '/griddb_svr/', '/oracle_svr/', '/tiny_svr/') WHERE c4 = 3000;
Set pgspider_core_fdw.throw_error_ifdead to true;
-- *** Finish test for tntbl3 *** --
-----------------------------------------------------------------------------------
-- *** Start test for tntbl4 *** --
--
-- insert with DEFAULT in the target_list
--
--Testcase 256:
INSERT INTO tntbl4 (c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, c14, c15, c16, c17, c18, c19, c20) VALUES (DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT);
--Testcase 257:
INSERT INTO tntbl4 (c1, c2, c3) VALUES (3, DEFAULT, DEFAULT);
--Testcase 258:
INSERT INTO tntbl4 (c1, c2, c3) VALUES (4, 'ANC#$', DEFAULT);
--Testcase 259:
INSERT INTO tntbl4 VALUES (5, DEFAULT, true, 10.0, 1000, 'char array', 'char varying', 100.0, 127, '2004-10-19 10:23:54', '2004-10-19 10:23:54+02', '0001-01-01', '{ "customer": "John Does"}', '{"tags": ["tag1", "tag2"], "finished": true }', '2f404849-f62c-4234-b0c8-e230bd694045', point '(1,-45)', E'\\xa7a8a9aaabacadaeaf', B'1111111111', B'10101', interval '6 years 5 months 4 days 3 hours 2 minutes 1 second');
--Testcase 260:
INSERT INTO tntbl4 VALUES (6, 'test', false, DEFAULT, 2000, 'test', 'test', 200.0, 0);
--Testcase 261:
SELECT * FROM tntbl4 ORDER BY 1, 2, 3;
 c1 |    c2    | c3 | c4  |  c5   |                                                                                                                               c6                                                                                                                                |      c7       | c8  | c9  |         c10         |          c11           |    c12     |                 c13                 |                                   c14                                   |                 c15                  |   c16   |         c17          |    c18     |  c19  |                     c20                      |    __spd_url     
----+----------+----+-----+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+-----+-----+---------------------+------------------------+------------+-------------------------------------+-------------------------------------------------------------------------+--------------------------------------+---------+----------------------+------------+-------+----------------------------------------------+------------------
  3 |          |    |     |       |                                                                                                                                                                                                                                                                 |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       |                                              | /postgres_svr/
  4 | ANC#$    |    |     |       |                                                                                                                                                                                                                                                                 |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       |                                              | /postgres_svr_2/
  5 |          | t  |  10 |  1000 | char array                                                                                                                                                                                                                                                      | char varying  | 100 | 127 | 2004-10-19 10:23:54 | 2004-10-19 08:23:54+00 | 0001-01-01 | { "customer": "John Does"}          | {"tags": ["tag1", "tag2"], "finished": true}                            | 2f404849-f62c-4234-b0c8-e230bd694045 | (1,-45) | \xa7a8a9aaabacadaeaf | 1111111111 | 10101 | @ 6 years 5 mons 4 days 3 hours 2 mins 1 sec | /postgres_svr/
  6 | test     | f  |     |  2000 | test                                                                                                                                                                                                                                                            | test          | 200 |   0 |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       |                                              | /postgres_svr_2/
 10 | text     | t  |  10 |  1000 | char array                                                                                                                                                                                                                                                      | varchar array |  -1 |  12 | 2004-10-19 10:23:54 | 2004-10-19 08:23:54+00 | 2001-01-01 | {"product": "test","quantity": 1}   | {"name": "paintings", "tags": ["Scene", "Portrait"], "finished": true}  | 2f404849-f62c-4234-b0c8-e230bd694045 | (1,-45) | \xa7a8a9aaabacadaeaf | 1111111111 | 10101 | @ 1 year 3 hours 20 mins                     | /postgres_svr/
 20 | texttext | f  | -10 | -1000 | char array                                                                                                                                                                                                                                                      | varchar array |   1 |   1 | 2005-10-19 10:23:54 | 2005-10-19 08:23:54+00 | 2001-01-01 | {"product": "sample","quantity": 1} | {"name": "paintings", "tags": ["Scene", "Portrait"], "finished": false} | 2f404849-f62c-4234-b0c8-e230bd694045 | (1,-45) | \xa7a8a9aaabacadaeaf | 1111111111 | 10101 | @ 1 year 3 hours 20 mins                     | /postgres_svr_2/
    |          |    |     |       |                                                                                                                                                                                                                                                                 |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       |                                              | /postgres_svr_2/
(7 rows)

--
-- insert with similar expression / target_list VALUES (all fail)
--
--Testcase 262:
INSERT INTO tntbl4 (c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, c14, c15, c16, c17, c18, c19, c20) VALUES (DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT);
ERROR:  INSERT has more target columns than expressions
LINE 1: ...c10, c11, c12, c13, c14, c15, c16, c17, c18, c19, c20) VALUE...
                                                             ^
--Testcase 263:
INSERT INTO tntbl4 (c1, c2, c3) VALUES (1, 'ex');
ERROR:  INSERT has more target columns than expressions
LINE 1: INSERT INTO tntbl4 (c1, c2, c3) VALUES (1, 'ex');
                                    ^
--Testcase 264:
INSERT INTO tntbl4 (c1) VALUES (1, 2);
ERROR:  INSERT has more expressions than target columns
LINE 1: INSERT INTO tntbl4 (c1) VALUES (1, 2);
                                           ^
--Testcase 265:
INSERT INTO tntbl4 (c1) VALUES (DEFAULT, DEFAULT);
ERROR:  INSERT has more expressions than target columns
LINE 1: INSERT INTO tntbl4 (c1) VALUES (DEFAULT, DEFAULT);
                                                 ^
--Testcase 266:
SELECT * FROM tntbl4 ORDER BY 1, 2, 3;
 c1 |    c2    | c3 | c4  |  c5   |                                                                                                                               c6                                                                                                                                |      c7       | c8  | c9  |         c10         |          c11           |    c12     |                 c13                 |                                   c14                                   |                 c15                  |   c16   |         c17          |    c18     |  c19  |                     c20                      |    __spd_url     
----+----------+----+-----+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+-----+-----+---------------------+------------------------+------------+-------------------------------------+-------------------------------------------------------------------------+--------------------------------------+---------+----------------------+------------+-------+----------------------------------------------+------------------
  3 |          |    |     |       |                                                                                                                                                                                                                                                                 |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       |                                              | /postgres_svr/
  4 | ANC#$    |    |     |       |                                                                                                                                                                                                                                                                 |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       |                                              | /postgres_svr_2/
  5 |          | t  |  10 |  1000 | char array                                                                                                                                                                                                                                                      | char varying  | 100 | 127 | 2004-10-19 10:23:54 | 2004-10-19 08:23:54+00 | 0001-01-01 | { "customer": "John Does"}          | {"tags": ["tag1", "tag2"], "finished": true}                            | 2f404849-f62c-4234-b0c8-e230bd694045 | (1,-45) | \xa7a8a9aaabacadaeaf | 1111111111 | 10101 | @ 6 years 5 mons 4 days 3 hours 2 mins 1 sec | /postgres_svr/
  6 | test     | f  |     |  2000 | test                                                                                                                                                                                                                                                            | test          | 200 |   0 |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       |                                              | /postgres_svr_2/
 10 | text     | t  |  10 |  1000 | char array                                                                                                                                                                                                                                                      | varchar array |  -1 |  12 | 2004-10-19 10:23:54 | 2004-10-19 08:23:54+00 | 2001-01-01 | {"product": "test","quantity": 1}   | {"name": "paintings", "tags": ["Scene", "Portrait"], "finished": true}  | 2f404849-f62c-4234-b0c8-e230bd694045 | (1,-45) | \xa7a8a9aaabacadaeaf | 1111111111 | 10101 | @ 1 year 3 hours 20 mins                     | /postgres_svr/
 20 | texttext | f  | -10 | -1000 | char array                                                                                                                                                                                                                                                      | varchar array |   1 |   1 | 2005-10-19 10:23:54 | 2005-10-19 08:23:54+00 | 2001-01-01 | {"product": "sample","quantity": 1} | {"name": "paintings", "tags": ["Scene", "Portrait"], "finished": false} | 2f404849-f62c-4234-b0c8-e230bd694045 | (1,-45) | \xa7a8a9aaabacadaeaf | 1111111111 | 10101 | @ 1 year 3 hours 20 mins                     | /postgres_svr_2/
    |          |    |     |       |                                                                                                                                                                                                                                                                 |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       |                                              | /postgres_svr_2/
(7 rows)

--
-- VALUES test
--
--Testcase 267:
INSERT INTO tntbl4 VALUES(1, '40', true, 2.0, 2000, 'value 1'), (-1, DEFAULT, true, 4.0, 4000, 'value 2'),
    ((SELECT 2), 'fun!', false, (SELECT i FROM (VALUES(3.0)) as foo (i)), 3000, 'VALUES are fun!');
--Testcase 268:
SELECT * FROM tntbl4 ORDER BY 1, 2, 3;
 c1 |    c2    | c3 | c4  |  c5   |                                                                                                                               c6                                                                                                                                |      c7       | c8  | c9  |         c10         |          c11           |    c12     |                 c13                 |                                   c14                                   |                 c15                  |   c16   |         c17          |    c18     |  c19  |                     c20                      |    __spd_url     
----+----------+----+-----+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+-----+-----+---------------------+------------------------+------------+-------------------------------------+-------------------------------------------------------------------------+--------------------------------------+---------+----------------------+------------+-------+----------------------------------------------+------------------
 -1 |          | t  |   4 |  4000 | value 2                                                                                                                                                                                                                                                         |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       |                                              | /postgres_svr_2/
  1 | 40       | t  |   2 |  2000 | value 1                                                                                                                                                                                                                                                         |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       |                                              | /postgres_svr/
  2 | fun!     | f  |   3 |  3000 | VALUES are fun!                                                                                                                                                                                                                                                 |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       |                                              | /postgres_svr/
  3 |          |    |     |       |                                                                                                                                                                                                                                                                 |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       |                                              | /postgres_svr/
  4 | ANC#$    |    |     |       |                                                                                                                                                                                                                                                                 |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       |                                              | /postgres_svr_2/
  5 |          | t  |  10 |  1000 | char array                                                                                                                                                                                                                                                      | char varying  | 100 | 127 | 2004-10-19 10:23:54 | 2004-10-19 08:23:54+00 | 0001-01-01 | { "customer": "John Does"}          | {"tags": ["tag1", "tag2"], "finished": true}                            | 2f404849-f62c-4234-b0c8-e230bd694045 | (1,-45) | \xa7a8a9aaabacadaeaf | 1111111111 | 10101 | @ 6 years 5 mons 4 days 3 hours 2 mins 1 sec | /postgres_svr/
  6 | test     | f  |     |  2000 | test                                                                                                                                                                                                                                                            | test          | 200 |   0 |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       |                                              | /postgres_svr_2/
 10 | text     | t  |  10 |  1000 | char array                                                                                                                                                                                                                                                      | varchar array |  -1 |  12 | 2004-10-19 10:23:54 | 2004-10-19 08:23:54+00 | 2001-01-01 | {"product": "test","quantity": 1}   | {"name": "paintings", "tags": ["Scene", "Portrait"], "finished": true}  | 2f404849-f62c-4234-b0c8-e230bd694045 | (1,-45) | \xa7a8a9aaabacadaeaf | 1111111111 | 10101 | @ 1 year 3 hours 20 mins                     | /postgres_svr/
 20 | texttext | f  | -10 | -1000 | char array                                                                                                                                                                                                                                                      | varchar array |   1 |   1 | 2005-10-19 10:23:54 | 2005-10-19 08:23:54+00 | 2001-01-01 | {"product": "sample","quantity": 1} | {"name": "paintings", "tags": ["Scene", "Portrait"], "finished": false} | 2f404849-f62c-4234-b0c8-e230bd694045 | (1,-45) | \xa7a8a9aaabacadaeaf | 1111111111 | 10101 | @ 1 year 3 hours 20 mins                     | /postgres_svr_2/
    |          |    |     |       |                                                                                                                                                                                                                                                                 |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       |                                              | /postgres_svr_2/
(10 rows)

--
-- TOASTed value test
--
--Testcase 269:
INSERT INTO tntbl4 VALUES(30, repeat('x', 25));
--Testcase 270:
SELECT c1, c3, char_length(c2) FROM tntbl4 ORDER BY 1, 2, 3;
 c1 | c3 | char_length 
----+----+-------------
 -1 | t  |            
  1 | t  |           2
  2 | f  |           4
  3 |    |            
  4 |    |           5
  5 | t  |            
  6 | f  |           4
 10 | t  |           4
 20 | f  |           8
 30 |    |          25
    |    |            
(11 rows)

--
-- INSERT with IN feature
--
--Testcase 271:
INSERT INTO tntbl4 IN ('/postgres_svr/') VALUES (12, '_test', true, 5.0, 5000);
--Testcase 272:
INSERT INTO tntbl4 IN ('/postgres_svr/', '/postgres_svr_2/') VALUES (13, '_infea', true, 6.0, 6000);
--
-- UPDATE
--
--Testcase 273:
SELECT c1, char_length(c2), c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, c14, c15, c16, c17, c18, c19, c20 FROM tntbl4 ORDER BY 1, 2, 3, 4, 5, 6, 7, 8, 9, 10;
 c1 | char_length | c3 | c4  |  c5   |                                                                                                                               c6                                                                                                                                |      c7       | c8  | c9  |         c10         |          c11           |    c12     |                 c13                 |                                   c14                                   |                 c15                  |   c16   |         c17          |    c18     |  c19  |                     c20                      
----+-------------+----+-----+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+-----+-----+---------------------+------------------------+------------+-------------------------------------+-------------------------------------------------------------------------+--------------------------------------+---------+----------------------+------------+-------+----------------------------------------------
 -1 |             | t  |   4 |  4000 | value 2                                                                                                                                                                                                                                                         |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  1 |           2 | t  |   2 |  2000 | value 1                                                                                                                                                                                                                                                         |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  2 |           4 | f  |   3 |  3000 | VALUES are fun!                                                                                                                                                                                                                                                 |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  3 |             |    |     |       |                                                                                                                                                                                                                                                                 |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  4 |           5 |    |     |       |                                                                                                                                                                                                                                                                 |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  5 |             | t  |  10 |  1000 | char array                                                                                                                                                                                                                                                      | char varying  | 100 | 127 | 2004-10-19 10:23:54 | 2004-10-19 08:23:54+00 | 0001-01-01 | { "customer": "John Does"}          | {"tags": ["tag1", "tag2"], "finished": true}                            | 2f404849-f62c-4234-b0c8-e230bd694045 | (1,-45) | \xa7a8a9aaabacadaeaf | 1111111111 | 10101 | @ 6 years 5 mons 4 days 3 hours 2 mins 1 sec
  6 |           4 | f  |     |  2000 | test                                                                                                                                                                                                                                                            | test          | 200 |   0 |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 10 |           4 | t  |  10 |  1000 | char array                                                                                                                                                                                                                                                      | varchar array |  -1 |  12 | 2004-10-19 10:23:54 | 2004-10-19 08:23:54+00 | 2001-01-01 | {"product": "test","quantity": 1}   | {"name": "paintings", "tags": ["Scene", "Portrait"], "finished": true}  | 2f404849-f62c-4234-b0c8-e230bd694045 | (1,-45) | \xa7a8a9aaabacadaeaf | 1111111111 | 10101 | @ 1 year 3 hours 20 mins
 12 |           5 | t  |   5 |  5000 |                                                                                                                                                                                                                                                                 |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 13 |           6 | t  |   6 |  6000 |                                                                                                                                                                                                                                                                 |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 20 |           8 | f  | -10 | -1000 | char array                                                                                                                                                                                                                                                      | varchar array |   1 |   1 | 2005-10-19 10:23:54 | 2005-10-19 08:23:54+00 | 2001-01-01 | {"product": "sample","quantity": 1} | {"name": "paintings", "tags": ["Scene", "Portrait"], "finished": false} | 2f404849-f62c-4234-b0c8-e230bd694045 | (1,-45) | \xa7a8a9aaabacadaeaf | 1111111111 | 10101 | @ 1 year 3 hours 20 mins
 30 |          25 |    |     |       |                                                                                                                                                                                                                                                                 |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
    |             |    |     |       |                                                                                                                                                                                                                                                                 |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
(13 rows)

--Testcase 274:
UPDATE tntbl4 SET c3 = DEFAULT, c6 = DEFAULT;
--Testcase 275:
SELECT c1, char_length(c2), c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, c14, c15, c16, c17, c18, c19, c20 FROM tntbl4 ORDER BY 1, 2, 3, 4, 5, 6, 7, 8, 9, 10;
 c1 | char_length | c3 | c4  |  c5   | c6 |      c7       | c8  | c9  |         c10         |          c11           |    c12     |                 c13                 |                                   c14                                   |                 c15                  |   c16   |         c17          |    c18     |  c19  |                     c20                      
----+-------------+----+-----+-------+----+---------------+-----+-----+---------------------+------------------------+------------+-------------------------------------+-------------------------------------------------------------------------+--------------------------------------+---------+----------------------+------------+-------+----------------------------------------------
 -1 |             |    |   4 |  4000 |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  1 |           2 |    |   2 |  2000 |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  2 |           4 |    |   3 |  3000 |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  3 |             |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  4 |           5 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  5 |             |    |  10 |  1000 |    | char varying  | 100 | 127 | 2004-10-19 10:23:54 | 2004-10-19 08:23:54+00 | 0001-01-01 | { "customer": "John Does"}          | {"tags": ["tag1", "tag2"], "finished": true}                            | 2f404849-f62c-4234-b0c8-e230bd694045 | (1,-45) | \xa7a8a9aaabacadaeaf | 1111111111 | 10101 | @ 6 years 5 mons 4 days 3 hours 2 mins 1 sec
  6 |           4 |    |     |  2000 |    | test          | 200 |   0 |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 10 |           4 |    |  10 |  1000 |    | varchar array |  -1 |  12 | 2004-10-19 10:23:54 | 2004-10-19 08:23:54+00 | 2001-01-01 | {"product": "test","quantity": 1}   | {"name": "paintings", "tags": ["Scene", "Portrait"], "finished": true}  | 2f404849-f62c-4234-b0c8-e230bd694045 | (1,-45) | \xa7a8a9aaabacadaeaf | 1111111111 | 10101 | @ 1 year 3 hours 20 mins
 12 |           5 |    |   5 |  5000 |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 13 |           6 |    |   6 |  6000 |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 20 |           8 |    | -10 | -1000 |    | varchar array |   1 |   1 | 2005-10-19 10:23:54 | 2005-10-19 08:23:54+00 | 2001-01-01 | {"product": "sample","quantity": 1} | {"name": "paintings", "tags": ["Scene", "Portrait"], "finished": false} | 2f404849-f62c-4234-b0c8-e230bd694045 | (1,-45) | \xa7a8a9aaabacadaeaf | 1111111111 | 10101 | @ 1 year 3 hours 20 mins
 30 |          25 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
    |             |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
(13 rows)

-- aliases for the UPDATE target table
--Testcase 276:
UPDATE tntbl4 AS t SET c5 = 10000 WHERE t.c1 = 20;
--Testcase 277:
SELECT c1, char_length(c2), c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, c14, c15, c16, c17, c18, c19, c20 FROM tntbl4 ORDER BY 1, 2, 3, 4, 5, 6, 7, 8, 9, 10;
 c1 | char_length | c3 | c4  |  c5   | c6 |      c7       | c8  | c9  |         c10         |          c11           |    c12     |                 c13                 |                                   c14                                   |                 c15                  |   c16   |         c17          |    c18     |  c19  |                     c20                      
----+-------------+----+-----+-------+----+---------------+-----+-----+---------------------+------------------------+------------+-------------------------------------+-------------------------------------------------------------------------+--------------------------------------+---------+----------------------+------------+-------+----------------------------------------------
 -1 |             |    |   4 |  4000 |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  1 |           2 |    |   2 |  2000 |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  2 |           4 |    |   3 |  3000 |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  3 |             |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  4 |           5 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  5 |             |    |  10 |  1000 |    | char varying  | 100 | 127 | 2004-10-19 10:23:54 | 2004-10-19 08:23:54+00 | 0001-01-01 | { "customer": "John Does"}          | {"tags": ["tag1", "tag2"], "finished": true}                            | 2f404849-f62c-4234-b0c8-e230bd694045 | (1,-45) | \xa7a8a9aaabacadaeaf | 1111111111 | 10101 | @ 6 years 5 mons 4 days 3 hours 2 mins 1 sec
  6 |           4 |    |     |  2000 |    | test          | 200 |   0 |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 10 |           4 |    |  10 |  1000 |    | varchar array |  -1 |  12 | 2004-10-19 10:23:54 | 2004-10-19 08:23:54+00 | 2001-01-01 | {"product": "test","quantity": 1}   | {"name": "paintings", "tags": ["Scene", "Portrait"], "finished": true}  | 2f404849-f62c-4234-b0c8-e230bd694045 | (1,-45) | \xa7a8a9aaabacadaeaf | 1111111111 | 10101 | @ 1 year 3 hours 20 mins
 12 |           5 |    |   5 |  5000 |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 13 |           6 |    |   6 |  6000 |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 20 |           8 |    | -10 | 10000 |    | varchar array |   1 |   1 | 2005-10-19 10:23:54 | 2005-10-19 08:23:54+00 | 2001-01-01 | {"product": "sample","quantity": 1} | {"name": "paintings", "tags": ["Scene", "Portrait"], "finished": false} | 2f404849-f62c-4234-b0c8-e230bd694045 | (1,-45) | \xa7a8a9aaabacadaeaf | 1111111111 | 10101 | @ 1 year 3 hours 20 mins
 30 |          25 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
    |             |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
(13 rows)

--Testcase 278:
UPDATE tntbl4 t SET c5 = t.c5 + 10 WHERE t.c1 = 20;
--Testcase 279:
SELECT c1, char_length(c2), c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, c14, c15, c16, c17, c18, c19, c20 FROM tntbl4 ORDER BY 1, 2, 3, 4, 5, 6, 7, 8, 9, 10;
 c1 | char_length | c3 | c4  |  c5   | c6 |      c7       | c8  | c9  |         c10         |          c11           |    c12     |                 c13                 |                                   c14                                   |                 c15                  |   c16   |         c17          |    c18     |  c19  |                     c20                      
----+-------------+----+-----+-------+----+---------------+-----+-----+---------------------+------------------------+------------+-------------------------------------+-------------------------------------------------------------------------+--------------------------------------+---------+----------------------+------------+-------+----------------------------------------------
 -1 |             |    |   4 |  4000 |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  1 |           2 |    |   2 |  2000 |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  2 |           4 |    |   3 |  3000 |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  3 |             |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  4 |           5 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  5 |             |    |  10 |  1000 |    | char varying  | 100 | 127 | 2004-10-19 10:23:54 | 2004-10-19 08:23:54+00 | 0001-01-01 | { "customer": "John Does"}          | {"tags": ["tag1", "tag2"], "finished": true}                            | 2f404849-f62c-4234-b0c8-e230bd694045 | (1,-45) | \xa7a8a9aaabacadaeaf | 1111111111 | 10101 | @ 6 years 5 mons 4 days 3 hours 2 mins 1 sec
  6 |           4 |    |     |  2000 |    | test          | 200 |   0 |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 10 |           4 |    |  10 |  1000 |    | varchar array |  -1 |  12 | 2004-10-19 10:23:54 | 2004-10-19 08:23:54+00 | 2001-01-01 | {"product": "test","quantity": 1}   | {"name": "paintings", "tags": ["Scene", "Portrait"], "finished": true}  | 2f404849-f62c-4234-b0c8-e230bd694045 | (1,-45) | \xa7a8a9aaabacadaeaf | 1111111111 | 10101 | @ 1 year 3 hours 20 mins
 12 |           5 |    |   5 |  5000 |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 13 |           6 |    |   6 |  6000 |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 20 |           8 |    | -10 | 10010 |    | varchar array |   1 |   1 | 2005-10-19 10:23:54 | 2005-10-19 08:23:54+00 | 2001-01-01 | {"product": "sample","quantity": 1} | {"name": "paintings", "tags": ["Scene", "Portrait"], "finished": false} | 2f404849-f62c-4234-b0c8-e230bd694045 | (1,-45) | \xa7a8a9aaabacadaeaf | 1111111111 | 10101 | @ 1 year 3 hours 20 mins
 30 |          25 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
    |             |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
(13 rows)

--
-- Test VALUES in FROM
--
--Testcase 280:
UPDATE tntbl4 SET c1 = v.i FROM (VALUES(100, 2000)) AS v(i, j)
  WHERE tntbl4.c5 = v.j;
--Testcase 281:
SELECT c1, char_length(c2), c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, c14, c15, c16, c17, c18, c19, c20 FROM tntbl4 ORDER BY 1, 2, 3, 4, 5, 6, 7, 8, 9, 10;
 c1  | char_length | c3 | c4  |  c5   | c6 |      c7       | c8  | c9  |         c10         |          c11           |    c12     |                 c13                 |                                   c14                                   |                 c15                  |   c16   |         c17          |    c18     |  c19  |                     c20                      
-----+-------------+----+-----+-------+----+---------------+-----+-----+---------------------+------------------------+------------+-------------------------------------+-------------------------------------------------------------------------+--------------------------------------+---------+----------------------+------------+-------+----------------------------------------------
  -1 |             |    |   4 |  4000 |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
   2 |           4 |    |   3 |  3000 |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
   3 |             |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
   4 |           5 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
   5 |             |    |  10 |  1000 |    | char varying  | 100 | 127 | 2004-10-19 10:23:54 | 2004-10-19 08:23:54+00 | 0001-01-01 | { "customer": "John Does"}          | {"tags": ["tag1", "tag2"], "finished": true}                            | 2f404849-f62c-4234-b0c8-e230bd694045 | (1,-45) | \xa7a8a9aaabacadaeaf | 1111111111 | 10101 | @ 6 years 5 mons 4 days 3 hours 2 mins 1 sec
  10 |           4 |    |  10 |  1000 |    | varchar array |  -1 |  12 | 2004-10-19 10:23:54 | 2004-10-19 08:23:54+00 | 2001-01-01 | {"product": "test","quantity": 1}   | {"name": "paintings", "tags": ["Scene", "Portrait"], "finished": true}  | 2f404849-f62c-4234-b0c8-e230bd694045 | (1,-45) | \xa7a8a9aaabacadaeaf | 1111111111 | 10101 | @ 1 year 3 hours 20 mins
  12 |           5 |    |   5 |  5000 |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  13 |           6 |    |   6 |  6000 |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  20 |           8 |    | -10 | 10010 |    | varchar array |   1 |   1 | 2005-10-19 10:23:54 | 2005-10-19 08:23:54+00 | 2001-01-01 | {"product": "sample","quantity": 1} | {"name": "paintings", "tags": ["Scene", "Portrait"], "finished": false} | 2f404849-f62c-4234-b0c8-e230bd694045 | (1,-45) | \xa7a8a9aaabacadaeaf | 1111111111 | 10101 | @ 1 year 3 hours 20 mins
  30 |          25 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 100 |           2 |    |   2 |  2000 |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 100 |           4 |    |     |  2000 |    | test          | 200 |   0 |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
     |             |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
(13 rows)

-- fail, wrong data type:
--Testcase 282:
UPDATE tntbl4 SET c1 = v.* FROM (VALUES(100, 2000)) AS v(i, j)
  WHERE tntbl4.c5 = v.j;
ERROR:  column "c1" is of type integer but expression is of type record
LINE 1: UPDATE tntbl4 SET c1 = v.* FROM (VALUES(100, 2000)) AS v(i, ...
                               ^
HINT:  You will need to rewrite or cast the expression.
--
-- Test multiple-set-clause syntax
--
--Testcase 283:
INSERT INTO tntbl4 (SELECT c1 + 10, c2 || 'next', c3 != true FROM tntbl4 ORDER BY 1, 2, 3);
--Testcase 284:
SELECT c1, char_length(c2), c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, c14, c15, c16, c17, c18, c19, c20 FROM tntbl4 ORDER BY 1, 2, 3, 4, 5, 6, 7, 8, 9, 10;
 c1  | char_length | c3 | c4  |  c5   | c6 |      c7       | c8  | c9  |         c10         |          c11           |    c12     |                 c13                 |                                   c14                                   |                 c15                  |   c16   |         c17          |    c18     |  c19  |                     c20                      
-----+-------------+----+-----+-------+----+---------------+-----+-----+---------------------+------------------------+------------+-------------------------------------+-------------------------------------------------------------------------+--------------------------------------+---------+----------------------+------------+-------+----------------------------------------------
  -1 |             |    |   4 |  4000 |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
   2 |           4 |    |   3 |  3000 |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
   3 |             |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
   4 |           5 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
   5 |             |    |  10 |  1000 |    | char varying  | 100 | 127 | 2004-10-19 10:23:54 | 2004-10-19 08:23:54+00 | 0001-01-01 | { "customer": "John Does"}          | {"tags": ["tag1", "tag2"], "finished": true}                            | 2f404849-f62c-4234-b0c8-e230bd694045 | (1,-45) | \xa7a8a9aaabacadaeaf | 1111111111 | 10101 | @ 6 years 5 mons 4 days 3 hours 2 mins 1 sec
   9 |             |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  10 |           4 |    |  10 |  1000 |    | varchar array |  -1 |  12 | 2004-10-19 10:23:54 | 2004-10-19 08:23:54+00 | 2001-01-01 | {"product": "test","quantity": 1}   | {"name": "paintings", "tags": ["Scene", "Portrait"], "finished": true}  | 2f404849-f62c-4234-b0c8-e230bd694045 | (1,-45) | \xa7a8a9aaabacadaeaf | 1111111111 | 10101 | @ 1 year 3 hours 20 mins
  12 |           5 |    |   5 |  5000 |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  12 |           8 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  13 |           6 |    |   6 |  6000 |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  13 |             |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  14 |           9 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  15 |             |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  20 |           8 |    | -10 | 10010 |    | varchar array |   1 |   1 | 2005-10-19 10:23:54 | 2005-10-19 08:23:54+00 | 2001-01-01 | {"product": "sample","quantity": 1} | {"name": "paintings", "tags": ["Scene", "Portrait"], "finished": false} | 2f404849-f62c-4234-b0c8-e230bd694045 | (1,-45) | \xa7a8a9aaabacadaeaf | 1111111111 | 10101 | @ 1 year 3 hours 20 mins
  20 |           8 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  22 |           9 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  23 |          10 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  30 |          12 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  30 |          25 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  40 |          29 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 100 |           2 |    |   2 |  2000 |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 100 |           4 |    |     |  2000 |    | test          | 200 |   0 |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 110 |           6 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 110 |           8 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
     |             |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
     |             |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
(26 rows)

--Testcase 285:
UPDATE tntbl4 SET (c2 , c1, c4) = ('bugle', c1 + 10, DEFAULT) WHERE c2 = 'fun!';
--Testcase 286:
SELECT c1, char_length(c2), c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, c14, c15, c16, c17, c18, c19, c20 FROM tntbl4 ORDER BY 1, 2, 3, 4, 5, 6, 7, 8, 9, 10;
 c1  | char_length | c3 | c4  |  c5   | c6 |      c7       | c8  | c9  |         c10         |          c11           |    c12     |                 c13                 |                                   c14                                   |                 c15                  |   c16   |         c17          |    c18     |  c19  |                     c20                      
-----+-------------+----+-----+-------+----+---------------+-----+-----+---------------------+------------------------+------------+-------------------------------------+-------------------------------------------------------------------------+--------------------------------------+---------+----------------------+------------+-------+----------------------------------------------
  -1 |             |    |   4 |  4000 |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
   3 |             |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
   4 |           5 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
   5 |             |    |  10 |  1000 |    | char varying  | 100 | 127 | 2004-10-19 10:23:54 | 2004-10-19 08:23:54+00 | 0001-01-01 | { "customer": "John Does"}          | {"tags": ["tag1", "tag2"], "finished": true}                            | 2f404849-f62c-4234-b0c8-e230bd694045 | (1,-45) | \xa7a8a9aaabacadaeaf | 1111111111 | 10101 | @ 6 years 5 mons 4 days 3 hours 2 mins 1 sec
   9 |             |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  10 |           4 |    |  10 |  1000 |    | varchar array |  -1 |  12 | 2004-10-19 10:23:54 | 2004-10-19 08:23:54+00 | 2001-01-01 | {"product": "test","quantity": 1}   | {"name": "paintings", "tags": ["Scene", "Portrait"], "finished": true}  | 2f404849-f62c-4234-b0c8-e230bd694045 | (1,-45) | \xa7a8a9aaabacadaeaf | 1111111111 | 10101 | @ 1 year 3 hours 20 mins
  12 |           5 |    |   5 |  5000 |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  12 |           5 |    |     |  3000 |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  12 |           8 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  13 |           6 |    |   6 |  6000 |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  13 |             |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  14 |           9 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  15 |             |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  20 |           8 |    | -10 | 10010 |    | varchar array |   1 |   1 | 2005-10-19 10:23:54 | 2005-10-19 08:23:54+00 | 2001-01-01 | {"product": "sample","quantity": 1} | {"name": "paintings", "tags": ["Scene", "Portrait"], "finished": false} | 2f404849-f62c-4234-b0c8-e230bd694045 | (1,-45) | \xa7a8a9aaabacadaeaf | 1111111111 | 10101 | @ 1 year 3 hours 20 mins
  20 |           8 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  22 |           9 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  23 |          10 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  30 |          12 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  30 |          25 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  40 |          29 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 100 |           2 |    |   2 |  2000 |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 100 |           4 |    |     |  2000 |    | test          | 200 |   0 |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 110 |           6 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 110 |           8 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
     |             |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
     |             |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
(26 rows)

--Testcase 287:
UPDATE tntbl4 SET (c2, c5) = ('car', c1 + c5), c1 = c1 + 10 WHERE c1 = 30;
--Testcase 288:
SELECT c1, char_length(c2), c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, c14, c15, c16, c17, c18, c19, c20 FROM tntbl4 ORDER BY 1, 2, 3, 4, 5, 6, 7, 8, 9, 10;
 c1  | char_length | c3 | c4  |  c5   | c6 |      c7       | c8  | c9  |         c10         |          c11           |    c12     |                 c13                 |                                   c14                                   |                 c15                  |   c16   |         c17          |    c18     |  c19  |                     c20                      
-----+-------------+----+-----+-------+----+---------------+-----+-----+---------------------+------------------------+------------+-------------------------------------+-------------------------------------------------------------------------+--------------------------------------+---------+----------------------+------------+-------+----------------------------------------------
  -1 |             |    |   4 |  4000 |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
   3 |             |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
   4 |           5 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
   5 |             |    |  10 |  1000 |    | char varying  | 100 | 127 | 2004-10-19 10:23:54 | 2004-10-19 08:23:54+00 | 0001-01-01 | { "customer": "John Does"}          | {"tags": ["tag1", "tag2"], "finished": true}                            | 2f404849-f62c-4234-b0c8-e230bd694045 | (1,-45) | \xa7a8a9aaabacadaeaf | 1111111111 | 10101 | @ 6 years 5 mons 4 days 3 hours 2 mins 1 sec
   9 |             |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  10 |           4 |    |  10 |  1000 |    | varchar array |  -1 |  12 | 2004-10-19 10:23:54 | 2004-10-19 08:23:54+00 | 2001-01-01 | {"product": "test","quantity": 1}   | {"name": "paintings", "tags": ["Scene", "Portrait"], "finished": true}  | 2f404849-f62c-4234-b0c8-e230bd694045 | (1,-45) | \xa7a8a9aaabacadaeaf | 1111111111 | 10101 | @ 1 year 3 hours 20 mins
  12 |           5 |    |   5 |  5000 |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  12 |           5 |    |     |  3000 |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  12 |           8 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  13 |           6 |    |   6 |  6000 |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  13 |             |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  14 |           9 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  15 |             |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  20 |           8 |    | -10 | 10010 |    | varchar array |   1 |   1 | 2005-10-19 10:23:54 | 2005-10-19 08:23:54+00 | 2001-01-01 | {"product": "sample","quantity": 1} | {"name": "paintings", "tags": ["Scene", "Portrait"], "finished": false} | 2f404849-f62c-4234-b0c8-e230bd694045 | (1,-45) | \xa7a8a9aaabacadaeaf | 1111111111 | 10101 | @ 1 year 3 hours 20 mins
  20 |           8 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  22 |           9 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  23 |          10 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  40 |           3 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  40 |           3 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  40 |          29 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 100 |           2 |    |   2 |  2000 |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 100 |           4 |    |     |  2000 |    | test          | 200 |   0 |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 110 |           6 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 110 |           8 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
     |             |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
     |             |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
(26 rows)

-- fail, multi assignment to same column:
--Testcase 289:
UPDATE tntbl4 SET (c6, c8) = ('car', c4 + c8), c8 = c4 + 1.0 WHERE c1 = 40;
ERROR:  multiple assignments to same column "c8"
-- uncorrelated sub-SELECT:
--Testcase 290:
UPDATE tntbl4
  SET (c9, c1) = (SELECT c1, c9 FROM tntbl4 where c1 = 40 and c2 = 'car')
  WHERE c5 = 1000 AND c4 = 2.0;
--Testcase 291:
SELECT c1, char_length(c2), c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, c14, c15, c16, c17, c18, c19, c20 FROM tntbl4 ORDER BY 1, 2, 3, 4, 5, 6, 7, 8, 9, 10;
 c1  | char_length | c3 | c4  |  c5   | c6 |      c7       | c8  | c9  |         c10         |          c11           |    c12     |                 c13                 |                                   c14                                   |                 c15                  |   c16   |         c17          |    c18     |  c19  |                     c20                      
-----+-------------+----+-----+-------+----+---------------+-----+-----+---------------------+------------------------+------------+-------------------------------------+-------------------------------------------------------------------------+--------------------------------------+---------+----------------------+------------+-------+----------------------------------------------
  -1 |             |    |   4 |  4000 |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
   3 |             |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
   4 |           5 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
   5 |             |    |  10 |  1000 |    | char varying  | 100 | 127 | 2004-10-19 10:23:54 | 2004-10-19 08:23:54+00 | 0001-01-01 | { "customer": "John Does"}          | {"tags": ["tag1", "tag2"], "finished": true}                            | 2f404849-f62c-4234-b0c8-e230bd694045 | (1,-45) | \xa7a8a9aaabacadaeaf | 1111111111 | 10101 | @ 6 years 5 mons 4 days 3 hours 2 mins 1 sec
   9 |             |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  10 |           4 |    |  10 |  1000 |    | varchar array |  -1 |  12 | 2004-10-19 10:23:54 | 2004-10-19 08:23:54+00 | 2001-01-01 | {"product": "test","quantity": 1}   | {"name": "paintings", "tags": ["Scene", "Portrait"], "finished": true}  | 2f404849-f62c-4234-b0c8-e230bd694045 | (1,-45) | \xa7a8a9aaabacadaeaf | 1111111111 | 10101 | @ 1 year 3 hours 20 mins
  12 |           5 |    |   5 |  5000 |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  12 |           5 |    |     |  3000 |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  12 |           8 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  13 |           6 |    |   6 |  6000 |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  13 |             |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  14 |           9 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  15 |             |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  20 |           8 |    | -10 | 10010 |    | varchar array |   1 |   1 | 2005-10-19 10:23:54 | 2005-10-19 08:23:54+00 | 2001-01-01 | {"product": "sample","quantity": 1} | {"name": "paintings", "tags": ["Scene", "Portrait"], "finished": false} | 2f404849-f62c-4234-b0c8-e230bd694045 | (1,-45) | \xa7a8a9aaabacadaeaf | 1111111111 | 10101 | @ 1 year 3 hours 20 mins
  20 |           8 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  22 |           9 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  23 |          10 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  40 |           3 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  40 |           3 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  40 |          29 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 100 |           2 |    |   2 |  2000 |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 100 |           4 |    |     |  2000 |    | test          | 200 |   0 |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 110 |           6 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 110 |           8 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
     |             |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
     |             |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
(26 rows)

-- correlated sub-SELECT:
--Testcase 292:
UPDATE tntbl4 o
  SET (c9, c4) = (SELECT c9+1, c4 FROM tntbl4 i
               where i.c9=o.c9 and i.c4=o.c4 and i.c1 is not distinct FROM o.c1);
--Testcase 293:
SELECT c1, char_length(c2), c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, c14, c15, c16, c17, c18, c19, c20 FROM tntbl4 ORDER BY 1, 2, 3, 4, 5, 6, 7, 8, 9, 10;
 c1  | char_length | c3 | c4  |  c5   | c6 |      c7       | c8  | c9  |         c10         |          c11           |    c12     |                 c13                 |                                   c14                                   |                 c15                  |   c16   |         c17          |    c18     |  c19  |                     c20                      
-----+-------------+----+-----+-------+----+---------------+-----+-----+---------------------+------------------------+------------+-------------------------------------+-------------------------------------------------------------------------+--------------------------------------+---------+----------------------+------------+-------+----------------------------------------------
  -1 |             |    |     |  4000 |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
   3 |             |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
   4 |           5 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
   5 |             |    |  10 |  1000 |    | char varying  | 100 | 128 | 2004-10-19 10:23:54 | 2004-10-19 08:23:54+00 | 0001-01-01 | { "customer": "John Does"}          | {"tags": ["tag1", "tag2"], "finished": true}                            | 2f404849-f62c-4234-b0c8-e230bd694045 | (1,-45) | \xa7a8a9aaabacadaeaf | 1111111111 | 10101 | @ 6 years 5 mons 4 days 3 hours 2 mins 1 sec
   9 |             |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  10 |           4 |    |  10 |  1000 |    | varchar array |  -1 |  13 | 2004-10-19 10:23:54 | 2004-10-19 08:23:54+00 | 2001-01-01 | {"product": "test","quantity": 1}   | {"name": "paintings", "tags": ["Scene", "Portrait"], "finished": true}  | 2f404849-f62c-4234-b0c8-e230bd694045 | (1,-45) | \xa7a8a9aaabacadaeaf | 1111111111 | 10101 | @ 1 year 3 hours 20 mins
  12 |           5 |    |     |  3000 |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  12 |           5 |    |     |  5000 |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  12 |           8 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  13 |           6 |    |     |  6000 |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  13 |             |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  14 |           9 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  15 |             |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  20 |           8 |    | -10 | 10010 |    | varchar array |   1 |   2 | 2005-10-19 10:23:54 | 2005-10-19 08:23:54+00 | 2001-01-01 | {"product": "sample","quantity": 1} | {"name": "paintings", "tags": ["Scene", "Portrait"], "finished": false} | 2f404849-f62c-4234-b0c8-e230bd694045 | (1,-45) | \xa7a8a9aaabacadaeaf | 1111111111 | 10101 | @ 1 year 3 hours 20 mins
  20 |           8 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  22 |           9 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  23 |          10 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  40 |           3 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  40 |           3 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  40 |          29 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 100 |           2 |    |     |  2000 |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 100 |           4 |    |     |  2000 |    | test          | 200 |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 110 |           6 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 110 |           8 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
     |             |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
     |             |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
(26 rows)

-- fail, multiple rows supplied:
--Testcase 294:
UPDATE tntbl4 SET (c1, c9) = (SELECT c9 + 1, c1 FROM tntbl4);
ERROR:  more than one row returned by a subquery used as an expression
-- set to null if no rows supplied:
--Testcase 295:
UPDATE tntbl4 SET (c1, c9) = (SELECT c9 + 1, c1 FROM tntbl4 where c5 = 2000)
  WHERE c9 = 127;
--Testcase 296:
SELECT c1, char_length(c2), c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, c14, c15, c16, c17, c18, c19, c20 FROM tntbl4 ORDER BY 1, 2, 3, 4, 5, 6, 7, 8, 9, 10;
 c1  | char_length | c3 | c4  |  c5   | c6 |      c7       | c8  | c9  |         c10         |          c11           |    c12     |                 c13                 |                                   c14                                   |                 c15                  |   c16   |         c17          |    c18     |  c19  |                     c20                      
-----+-------------+----+-----+-------+----+---------------+-----+-----+---------------------+------------------------+------------+-------------------------------------+-------------------------------------------------------------------------+--------------------------------------+---------+----------------------+------------+-------+----------------------------------------------
  -1 |             |    |     |  4000 |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
   3 |             |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
   4 |           5 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
   5 |             |    |  10 |  1000 |    | char varying  | 100 | 128 | 2004-10-19 10:23:54 | 2004-10-19 08:23:54+00 | 0001-01-01 | { "customer": "John Does"}          | {"tags": ["tag1", "tag2"], "finished": true}                            | 2f404849-f62c-4234-b0c8-e230bd694045 | (1,-45) | \xa7a8a9aaabacadaeaf | 1111111111 | 10101 | @ 6 years 5 mons 4 days 3 hours 2 mins 1 sec
   9 |             |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  10 |           4 |    |  10 |  1000 |    | varchar array |  -1 |  13 | 2004-10-19 10:23:54 | 2004-10-19 08:23:54+00 | 2001-01-01 | {"product": "test","quantity": 1}   | {"name": "paintings", "tags": ["Scene", "Portrait"], "finished": true}  | 2f404849-f62c-4234-b0c8-e230bd694045 | (1,-45) | \xa7a8a9aaabacadaeaf | 1111111111 | 10101 | @ 1 year 3 hours 20 mins
  12 |           5 |    |     |  3000 |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  12 |           5 |    |     |  5000 |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  12 |           8 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  13 |           6 |    |     |  6000 |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  13 |             |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  14 |           9 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  15 |             |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  20 |           8 |    | -10 | 10010 |    | varchar array |   1 |   2 | 2005-10-19 10:23:54 | 2005-10-19 08:23:54+00 | 2001-01-01 | {"product": "sample","quantity": 1} | {"name": "paintings", "tags": ["Scene", "Portrait"], "finished": false} | 2f404849-f62c-4234-b0c8-e230bd694045 | (1,-45) | \xa7a8a9aaabacadaeaf | 1111111111 | 10101 | @ 1 year 3 hours 20 mins
  20 |           8 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  22 |           9 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  23 |          10 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  40 |           3 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  40 |           3 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  40 |          29 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 100 |           2 |    |     |  2000 |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 100 |           4 |    |     |  2000 |    | test          | 200 |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 110 |           6 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 110 |           8 |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
     |             |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
     |             |    |     |       |    |               |     |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
(26 rows)

-- *-expansion should work in this context:
--Testcase 297:
UPDATE tntbl4 SET (c1, c9) = ROW(v.*) FROM (VALUES(20, 100)) AS v(i, j)
  WHERE tntbl4.c1 = v.i;
-- you might expect this to work, but syntactically it's not a RowExpr:
--Testcase 298:
UPDATE tntbl4 SET (c1, c9) = (v.*) FROM (VALUES(20, 101)) AS v(i, j)
  WHERE tntbl4.c1 = v.i;
ERROR:  source for a multiple-column UPDATE item must be a sub-SELECT or ROW() expression
LINE 1: UPDATE tntbl4 SET (c1, c9) = (v.*) FROM (VALUES(20, 101)) AS...
                                      ^
-- if an alias for the target table is specified, don't allow references
-- to the original table name
--Testcase 299:
UPDATE tntbl4 AS t SET c9 = tntbl4.c9 + 10 WHERE t.c1 = 40;
ERROR:  invalid reference to FROM-clause entry for table "tntbl4"
LINE 1: UPDATE tntbl4 AS t SET c9 = tntbl4.c9 + 10 WHERE t.c1 = 40;
                                    ^
HINT:  Perhaps you meant to reference the table alias "t".
-- Make sure that we can update to a TOASTed value.
--Testcase 300:
UPDATE tntbl4 SET c2 = repeat('x', 25) WHERE c2 = 'car';
--Testcase 301:
SELECT c1, c3, char_length(c2) FROM tntbl4 ORDER BY 1, 2, 3;
 c1  | c3 | char_length 
-----+----+-------------
  -1 |    |            
   3 |    |            
   4 |    |           5
   5 |    |            
   9 |    |            
  10 |    |           4
  12 |    |           5
  12 |    |           5
  12 |    |           8
  13 |    |           6
  13 |    |            
  14 |    |           9
  15 |    |            
  20 |    |           8
  20 |    |           8
  22 |    |           9
  23 |    |          10
  40 |    |          25
  40 |    |          25
  40 |    |          29
 100 |    |           2
 100 |    |           4
 110 |    |           6
 110 |    |           8
     |    |            
     |    |            
(26 rows)

-- Check multi-assignment with a Result node to handle a one-time filter.
--Testcase 302:
EXPLAIN (VERBOSE, COSTS OFF)
UPDATE tntbl4 t
  SET (c5, c1) = (SELECT c1, c5 FROM tntbl4 s WHERE s.c1 = t.c1)
  WHERE CURRENT_USER = SESSION_USER;
                                                                            QUERY PLAN                                                                            
------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Update on public.tntbl4 t
   Node: postgres_svr_2 / Status: Alive
     Remote SQL: UPDATE public.tntbl4 SET c1 = $2, c5 = $3 WHERE ctid = $1
   Node: postgres_svr / Status: Alive
     Remote SQL: UPDATE public.tntbl4 SET c1 = $2, c5 = $3 WHERE ctid = $1
   ->  Result
         Output: (($2)::integer), (($1)::bigint), ((SubPlan 1 (returns $1,$2))), t.ctid, t.ctid, t.__spd_url, t.*
         One-Time Filter: (CURRENT_USER = SESSION_USER)
         ->  Foreign Scan on public.tntbl4 t
               Output: $2, $1, (SubPlan 1 (returns $1,$2)), t.ctid, t.ctid, t.__spd_url, t.*
               Filter: (CURRENT_USER = SESSION_USER)
               Node: postgres_svr_2 / Status: Alive
                 Remote SQL: SELECT c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, c14, c15, c16, c17, c18, c19, c20, ctid FROM public.tntbl4 FOR UPDATE
               Node: postgres_svr / Status: Alive
                 Remote SQL: SELECT c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, c14, c15, c16, c17, c18, c19, c20, ctid FROM public.tntbl4 FOR UPDATE
               SubPlan 1 (returns $1,$2)
                 ->  Foreign Scan on public.tntbl4 s
                       Output: s.c1, s.c5
                       Node: postgres_svr_2 / Status: Alive
                         Remote SQL: SELECT c1, c5 FROM public.tntbl4 WHERE ((c1 = $1::integer))
                       Node: postgres_svr / Status: Alive
                         Remote SQL: SELECT c1, c5 FROM public.tntbl4 WHERE ((c1 = $1::integer))
(22 rows)

--Testcase 303:
UPDATE tntbl4 t
  SET (c5, c1) = (SELECT c1, c5 FROM tntbl4 s WHERE s.c1 = t.c1)
  WHERE CURRENT_USER = SESSION_USER;
ERROR:  more than one row returned by a subquery used as an expression
--Testcase 304:
SELECT c1, c5, char_length(c2) FROM tntbl4 ORDER BY 1, 2, 3;
 c1  |  c5   | char_length 
-----+-------+-------------
  -1 |  4000 |            
   3 |       |            
   4 |       |           5
   5 |  1000 |            
   9 |       |            
  10 |  1000 |           4
  12 |  3000 |           5
  12 |  5000 |           5
  12 |       |           8
  13 |  6000 |           6
  13 |       |            
  14 |       |           9
  15 |       |            
  20 | 10010 |           8
  20 |       |           8
  22 |       |           9
  23 |       |          10
  40 |       |          25
  40 |       |          25
  40 |       |          29
 100 |  2000 |           2
 100 |  2000 |           4
 110 |       |           6
 110 |       |           8
     |       |            
     |       |            
(26 rows)

--
-- UPDATE with IN feature
--
--Testcase 305:
UPDATE tntbl4 IN ('/postgres_svr/') SET c8 = 56563.1212;
--Testcase 306:
UPDATE tntbl4 IN ('/postgres_svr/', '/postgres_svr_2/') SET c8 = 22.2;
--
-- DELETE
--
-- allow an alias to be specified for DELETE's target table
--Testcase 307:
DELETE FROM tntbl4 AS dt WHERE dt.c1 > 75;
-- if an alias is specified, don't allow the original table name
-- to be referenced
--Testcase 308:
DELETE FROM tntbl4 dt WHERE tntbl4.c1 > 45;
ERROR:  invalid reference to FROM-clause entry for table "tntbl4"
LINE 1: DELETE FROM tntbl4 dt WHERE tntbl4.c1 > 45;
                                    ^
HINT:  Perhaps you meant to reference the table alias "dt".
--Testcase 309:
SELECT c1, c3, char_length(c2) FROM tntbl4 ORDER BY 1, 2, 3;
 c1 | c3 | char_length 
----+----+-------------
 -1 |    |            
  3 |    |            
  4 |    |           5
  5 |    |            
  9 |    |            
 10 |    |           4
 12 |    |           5
 12 |    |           5
 12 |    |           8
 13 |    |           6
 13 |    |            
 14 |    |           9
 15 |    |            
 20 |    |           8
 20 |    |           8
 22 |    |           9
 23 |    |          10
 40 |    |          25
 40 |    |          25
 40 |    |          29
    |    |            
    |    |            
(22 rows)

-- delete a row with a TOASTed value
--Testcase 310:
DELETE FROM tntbl4 WHERE c1 > 25;
--Testcase 311:
SELECT c1, c3, char_length(c2) FROM tntbl4 ORDER BY 1, 2, 3;
 c1 | c3 | char_length 
----+----+-------------
 -1 |    |            
  3 |    |            
  4 |    |           5
  5 |    |            
  9 |    |            
 10 |    |           4
 12 |    |           5
 12 |    |           5
 12 |    |           8
 13 |    |           6
 13 |    |            
 14 |    |           9
 15 |    |            
 20 |    |           8
 20 |    |           8
 22 |    |           9
 23 |    |          10
    |    |            
    |    |            
(19 rows)

--
-- DELETE with IN feature
--
--Testcase 312:
DELETE FROM tntbl4 IN ('/postgres_svr/') WHERE c1 = 10;
--Testcase 313:
DELETE FROM tntbl4 IN ('/postgres_svr/', '/postgres_svr_2/', '/griddb_svr/') WHERE c5 = 3000;
-- *** Finish test for tntbl4 *** --
-----------------------------------------------------------------------------------
-- *** Start test for tntbl5 *** --
-- This FDW does not support modification, the result will fail all over
--Testcase 314:
SELECT c1, c2 FROM tntbl5 ORDER BY 1, 2;
 c1 |  c2  
----+------
 10 | test
 40 | foo1
(2 rows)

--Testcase 315:
INSERT INTO tntbl5 VALUES (DEFAULT, 'abc');
WARNING:  file_fdw is ignored as an insert target because it does not support modification
WARNING:  file_fdw is ignored as an insert target because it does not support modification
ERROR:  No child node support modification.
--Testcase 316:
INSERT INTO tntbl5 VALUES (1, 'foo');
WARNING:  file_fdw is ignored as an insert target because it does not support modification
WARNING:  file_fdw is ignored as an insert target because it does not support modification
ERROR:  No child node support modification.
--Testcase 317:
INSERT INTO tntbl5 IN ('/file_svr/') VALUES (2, 'zzzzz');
WARNING:  file_fdw is ignored as an insert target because it does not support modification
ERROR:  No child node support modification.
--Testcase 318:
UPDATE tntbl5 SET c2 = 'foo' WHERE c1 IS NULL;
WARNING:  file_fdw will be skipped because it does not support modification
WARNING:  file_fdw will be skipped because it does not support modification
ERROR:  No child node support modification.
--Testcase 319:
UPDATE tntbl5 IN ('/file_svr/', '/file_svr_2/') SET c2 = DEFAULT;
WARNING:  file_fdw will be skipped because it does not support modification
WARNING:  file_fdw will be skipped because it does not support modification
ERROR:  No child node support modification.
--Testcase 320:
DELETE FROM tntbl5 WHERE c2 = 'foo';
WARNING:  file_fdw will be skipped because it does not support modification
WARNING:  file_fdw will be skipped because it does not support modification
ERROR:  No child node support modification.
--Testcase 321:
DELETE FROM tntbl5 IN ('/file_svr/');
WARNING:  file_fdw will be skipped because it does not support modification
ERROR:  No child node support modification.
-- *** Finish test for tntbl5 *** --
-----------------------------------------------------------------------------------
--
-- Check behavior of disable_transaction_feature_check
--
--Testcase 322:
ALTER FOREIGN TABLE tntbl1 OPTIONS (disable_transaction_feature_check 'false');
--Testcase 323:
INSERT INTO tntbl1 VALUES (200, 70, 2.0, 200.0, 3000, '2030-02-20 03:00:07', '2005-10-20 10:20:54+02', DEFAULT, 'abc', 'foo');
ERROR:  Failed to parse URL 'foo'. The first character should be '/'.
--Testcase 324:
SELECT * FROM tntbl1 ORDER BY 1, 2, 3;
 c1 | c2 |  c3  | c4 |  c5   | c6 |           c7           |                                                                                                                               c8                                                                                                                                |      c9       |   __spd_url    
----+----+------+----+-------+----+------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+----------------
 -1 |  2 |  100 |    | 69845 |    | 1972-01-01 00:00:01+00 | Beera                                                                                                                                                                                                                                                           | John Does     | /oracle_svr/
  1 |    |      |    |       |    |                        |                                                                                                                                                                                                                                                                 |               | /oracle_svr/
  5 |    |      |    |       |    |                        |                                                                                                                                                                                                                                                                 |               | /mysql_svr/
 13 |    | 22.2 |    |  5944 |    | 2007-10-19 08:23:54+00 | bugle                                                                                                                                                                                                                                                           | foo           | /postgres_svr/
 20 |  0 | 22.2 |    |  1000 |    | 2022-06-22 07:00:00+00 | char array                                                                                                                                                                                                                                                      | varchar array | /postgres_svr/
(5 rows)

--Testcase 325:
INSERT INTO tntbl1 VALUES (100, 20, 3.0, 300.0, 4000, '2037-01-19 03:14:07', '2004-10-19 10:23:54+02', interval '2 months ago', '40', 'abc'), (-100, 30, DEFAULT, DEFAULT, 2000, '2004-10-19 10:23:54', '1972-01-01 00:00:00+07', interval '1 year 3 hours 20 minutes', 'Beera', 'John Does'),
    ((SELECT 300), (SELECT i FROM (VALUES(3)) as foo (i)), 400.212, 200.0, 5000, '2007-10-19 10:23:54', '2007-10-19 10:23:54+02', interval '1 year 2 months 3 days', 'VALUES are fun!', 'foo');
ERROR:  Failed to parse URL 'abc'. The first character should be '/'.
--Testcase 326:
SELECT * FROM tntbl1 ORDER BY 1, 2, 3;
 c1 | c2 |  c3  | c4 |  c5   | c6 |           c7           |                                                                                                                               c8                                                                                                                                |      c9       |   __spd_url    
----+----+------+----+-------+----+------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+----------------
 -1 |  2 |  100 |    | 69845 |    | 1972-01-01 00:00:01+00 | Beera                                                                                                                                                                                                                                                           | John Does     | /oracle_svr/
  1 |    |      |    |       |    |                        |                                                                                                                                                                                                                                                                 |               | /oracle_svr/
  5 |    |      |    |       |    |                        |                                                                                                                                                                                                                                                                 |               | /mysql_svr/
 13 |    | 22.2 |    |  5944 |    | 2007-10-19 08:23:54+00 | bugle                                                                                                                                                                                                                                                           | foo           | /postgres_svr/
 20 |  0 | 22.2 |    |  1000 |    | 2022-06-22 07:00:00+00 | char array                                                                                                                                                                                                                                                      | varchar array | /postgres_svr/
(5 rows)

--Testcase 327:
INSERT INTO tntbl1 VALUES (900, 80, 6.0, 400.03, 6000, '2030-02-20 03:00:07', '2005-10-20 10:20:54+02', interval '1 months ago', repeat('x', 10), repeat('a', 20));
ERROR:  Failed to parse URL 'aaaaaaaaaaaaaaaaaaaa'. The first character should be '/'.
--Testcase 328:
SELECT * FROM tntbl1 ORDER BY 1, 2, 3;
 c1 | c2 |  c3  | c4 |  c5   | c6 |           c7           |                                                                                                                               c8                                                                                                                                |      c9       |   __spd_url    
----+----+------+----+-------+----+------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+----------------
 -1 |  2 |  100 |    | 69845 |    | 1972-01-01 00:00:01+00 | Beera                                                                                                                                                                                                                                                           | John Does     | /oracle_svr/
  1 |    |      |    |       |    |                        |                                                                                                                                                                                                                                                                 |               | /oracle_svr/
  5 |    |      |    |       |    |                        |                                                                                                                                                                                                                                                                 |               | /mysql_svr/
 13 |    | 22.2 |    |  5944 |    | 2007-10-19 08:23:54+00 | bugle                                                                                                                                                                                                                                                           | foo           | /postgres_svr/
 20 |  0 | 22.2 |    |  1000 |    | 2022-06-22 07:00:00+00 | char array                                                                                                                                                                                                                                                      | varchar array | /postgres_svr/
(5 rows)

--Testcase 329:
UPDATE tntbl1 SET c2 = 10.001 WHERE c1 = 100;
--Testcase 330:
DELETE FROM tntbl1 WHERE c1 > 100;
--Testcase 331:
SELECT * FROM tntbl1 ORDER BY 1, 2, 3;
 c1 | c2 |  c3  | c4 |  c5   | c6 |           c7           |                                                                                                                               c8                                                                                                                                |      c9       |   __spd_url    
----+----+------+----+-------+----+------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+----------------
 -1 |  2 |  100 |    | 69845 |    | 1972-01-01 00:00:01+00 | Beera                                                                                                                                                                                                                                                           | John Does     | /oracle_svr/
  1 |    |      |    |       |    |                        |                                                                                                                                                                                                                                                                 |               | /oracle_svr/
  5 |    |      |    |       |    |                        |                                                                                                                                                                                                                                                                 |               | /mysql_svr/
 13 |    | 22.2 |    |  5944 |    | 2007-10-19 08:23:54+00 | bugle                                                                                                                                                                                                                                                           | foo           | /postgres_svr/
 20 |  0 | 22.2 |    |  1000 |    | 2022-06-22 07:00:00+00 | char array                                                                                                                                                                                                                                                      | varchar array | /postgres_svr/
(5 rows)

--Testcase 332:
INSERT INTO tntbl1 IN ('/oracle_svr/', '/tiny_svr/') VALUES (600, 120, 73.265, 78523.5, 5421659, '2002-10-19 10:23:54', '1972-01-01 00:00:01+07', 'Two', 'TwoTwo');
--Testcase 333:
SELECT * FROM tntbl1 ORDER BY 1, 2, 3;
 c1  | c2  |   c3   |   c4    |   c5    |         c6          |           c7           |                                                                                                                               c8                                                                                                                                |      c9       |   __spd_url    
-----+-----+--------+---------+---------+---------------------+------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+----------------
  -1 |   2 |    100 |         |   69845 |                     | 1972-01-01 00:00:01+00 | Beera                                                                                                                                                                                                                                                           | John Does     | /oracle_svr/
   1 |     |        |         |         |                     |                        |                                                                                                                                                                                                                                                                 |               | /oracle_svr/
   5 |     |        |         |         |                     |                        |                                                                                                                                                                                                                                                                 |               | /mysql_svr/
  13 |     |   22.2 |         |    5944 |                     | 2007-10-19 08:23:54+00 | bugle                                                                                                                                                                                                                                                           | foo           | /postgres_svr/
  20 |   0 |   22.2 |         |    1000 |                     | 2022-06-22 07:00:00+00 | char array                                                                                                                                                                                                                                                      | varchar array | /postgres_svr/
 600 | 120 | 73.265 | 78523.5 | 5421659 | 2002-10-19 10:23:54 | 1971-12-31 17:00:01+00 | Two                                                                                                                                                                                                                                                             | TwoTwo        | /oracle_svr/
(6 rows)

--Testcase 334:
UPDATE tntbl1 IN ('/dynamodb_svr/') SET c4 = 60.0;
ERROR:  No child node support modification.
--Testcase 335:
SELECT * FROM tntbl1 ORDER BY 1, 2, 3;
 c1  | c2  |   c3   |   c4    |   c5    |         c6          |           c7           |                                                                                                                               c8                                                                                                                                |      c9       |   __spd_url    
-----+-----+--------+---------+---------+---------------------+------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+----------------
  -1 |   2 |    100 |         |   69845 |                     | 1972-01-01 00:00:01+00 | Beera                                                                                                                                                                                                                                                           | John Does     | /oracle_svr/
   1 |     |        |         |         |                     |                        |                                                                                                                                                                                                                                                                 |               | /oracle_svr/
   5 |     |        |         |         |                     |                        |                                                                                                                                                                                                                                                                 |               | /mysql_svr/
  13 |     |   22.2 |         |    5944 |                     | 2007-10-19 08:23:54+00 | bugle                                                                                                                                                                                                                                                           | foo           | /postgres_svr/
  20 |   0 |   22.2 |         |    1000 |                     | 2022-06-22 07:00:00+00 | char array                                                                                                                                                                                                                                                      | varchar array | /postgres_svr/
 600 | 120 | 73.265 | 78523.5 | 5421659 | 2002-10-19 10:23:54 | 1971-12-31 17:00:01+00 | Two                                                                                                                                                                                                                                                             | TwoTwo        | /oracle_svr/
(6 rows)

--Testcase 336:
DELETE FROM tntbl1 IN ('/sqlite_svr/', '/tiny_svr/', '/mysql_svr/') WHERE c5 = 4000;
--Testcase 337:
SELECT * FROM tntbl1 ORDER BY 1, 2, 3;
 c1  | c2  |   c3   |   c4    |   c5    |         c6          |           c7           |                                                                                                                               c8                                                                                                                                |      c9       |   __spd_url    
-----+-----+--------+---------+---------+---------------------+------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+----------------
  -1 |   2 |    100 |         |   69845 |                     | 1972-01-01 00:00:01+00 | Beera                                                                                                                                                                                                                                                           | John Does     | /oracle_svr/
   1 |     |        |         |         |                     |                        |                                                                                                                                                                                                                                                                 |               | /oracle_svr/
   5 |     |        |         |         |                     |                        |                                                                                                                                                                                                                                                                 |               | /mysql_svr/
  13 |     |   22.2 |         |    5944 |                     | 2007-10-19 08:23:54+00 | bugle                                                                                                                                                                                                                                                           | foo           | /postgres_svr/
  20 |   0 |   22.2 |         |    1000 |                     | 2022-06-22 07:00:00+00 | char array                                                                                                                                                                                                                                                      | varchar array | /postgres_svr/
 600 | 120 | 73.265 | 78523.5 | 5421659 | 2002-10-19 10:23:54 | 1971-12-31 17:00:01+00 | Two                                                                                                                                                                                                                                                             | TwoTwo        | /oracle_svr/
(6 rows)

-- Reset value of disable_transaction_feature_check
ALTER FOREIGN TABLE tntbl1 OPTIONS (SET disable_transaction_feature_check 'true');
--Testcase 338:
INSERT INTO tntbl2 (_id, c1, c2, c3, c4, c5) VALUES ('121', 29, 'DEFAULT', true, 4.0, 4000);
--Testcase 339:
INSERT INTO tntbl2 (_id, c1, c2, c3) VALUES ('122', 1, '2', true);
--Testcase 340:
INSERT INTO tntbl2 IN ('/griddb_svr/') VALUES ('xin3', 10, 'tst_in_feature', true, 5.0, 5000);
--Testcase 341:
SELECT c1, c2, c3, c4, c5, __spd_url FROM tntbl2 ORDER BY 1, 2, 3, 4, 5, 6;
 c1 |             c2              | c3 |     c4     |  c5  |    __spd_url     
----+-----------------------------+----+------------+------+------------------
  1 | 2                           | t  |            |      | /dynamodb_svr/
 10 | tst_in_feature              | f  |          5 | 5000 | /griddb_svr/
 10 | tst_in_feature              | t  |          5 | 5000 | /griddb_svr/
 20 | tst_in_feature              | t  |          6 | 6000 | /mongo_svr/
 29 | DEFAULT                     | t  |          4 | 4000 | /odbc_post_svr/
    | 3q                          |    |       22.2 |      | /jdbc_mysql_svr/
    | 3q@@                        |    | 56563.1212 |      | /dynamodb_svr/
    | foo@@                       |    |       22.2 |      | /odbc_post_svr/
    | foo@@                       |    |            |      | /griddb_svr/
    | foo1                        | t  |            |      | /griddb_svr/
    | foo1@@                      |    | 56563.1212 |      | /dynamodb_svr/
    | odbc text                   | t  |       22.2 |      | /odbc_post_svr/
    | odbc text@@                 |    |            |      | /griddb_svr/
    | test                        | f  |       22.2 |      | /odbc_post_svr/
    | test                        | t  |            |      | /mongo_svr/
    | test@@                      |    |            |      | /mongo_svr/
    | test@@                      |    |            |      | /mongo_svr/
    | VALUES are fun!@@           |    | 56563.1212 |      | /dynamodb_svr/
    | varchar@@                   |    |       22.2 |      | /jdbc_mysql_svr/
    | xxxxxxxxxxxxxxxxxxxxxxxxx   | f  |       22.2 |      | /jdbc_mysql_svr/
    | xxxxxxxxxxxxxxxxxxxxxxxxx   | f  | 56563.1212 |      | /dynamodb_svr/
    | xxxxxxxxxxxxxxxxxxxxxxxxx@@ |    |       22.2 |      | /odbc_post_svr/
    |                             |    |       22.2 |      | /jdbc_mysql_svr/
    |                             |    |       22.2 |      | /odbc_post_svr/
    |                             |    | 56563.1212 |      | /dynamodb_svr/
    |                             |    |            |      | /griddb_svr/
(26 rows)

--Testcase 342:
UPDATE tntbl2 IN ('/dynamodb_svr/') SET c4 = 7000;
--Testcase 343:
SELECT c1, c2, c3, c4, c5, __spd_url FROM tntbl2 ORDER BY 1, 2, 3, 4, 5, 6;
 c1 |             c2              | c3 |  c4  |  c5  |    __spd_url     
----+-----------------------------+----+------+------+------------------
  1 | 2                           | t  | 7000 |      | /dynamodb_svr/
 10 | tst_in_feature              | f  |    5 | 5000 | /griddb_svr/
 10 | tst_in_feature              | t  |    5 | 5000 | /griddb_svr/
 20 | tst_in_feature              | t  |    6 | 6000 | /mongo_svr/
 29 | DEFAULT                     | t  |    4 | 4000 | /odbc_post_svr/
    | 3q                          |    | 22.2 |      | /jdbc_mysql_svr/
    | 3q@@                        |    | 7000 |      | /dynamodb_svr/
    | foo@@                       |    | 22.2 |      | /odbc_post_svr/
    | foo@@                       |    |      |      | /griddb_svr/
    | foo1                        | t  |      |      | /griddb_svr/
    | foo1@@                      |    | 7000 |      | /dynamodb_svr/
    | odbc text                   | t  | 22.2 |      | /odbc_post_svr/
    | odbc text@@                 |    |      |      | /griddb_svr/
    | test                        | f  | 22.2 |      | /odbc_post_svr/
    | test                        | t  |      |      | /mongo_svr/
    | test@@                      |    |      |      | /mongo_svr/
    | test@@                      |    |      |      | /mongo_svr/
    | VALUES are fun!@@           |    | 7000 |      | /dynamodb_svr/
    | varchar@@                   |    | 22.2 |      | /jdbc_mysql_svr/
    | xxxxxxxxxxxxxxxxxxxxxxxxx   | f  | 22.2 |      | /jdbc_mysql_svr/
    | xxxxxxxxxxxxxxxxxxxxxxxxx   | f  | 7000 |      | /dynamodb_svr/
    | xxxxxxxxxxxxxxxxxxxxxxxxx@@ |    | 22.2 |      | /odbc_post_svr/
    |                             |    | 22.2 |      | /jdbc_mysql_svr/
    |                             |    | 22.2 |      | /odbc_post_svr/
    |                             |    | 7000 |      | /dynamodb_svr/
    |                             |    |      |      | /griddb_svr/
(26 rows)

--Testcase 344:
DELETE FROM tntbl2 WHERE c2 = '2';
--Testcase 345:
SELECT c1, c2, c3, c4, c5, __spd_url FROM tntbl2 ORDER BY 1, 2, 3, 4, 5, 6;
 c1 |             c2              | c3 |  c4  |  c5  |    __spd_url     
----+-----------------------------+----+------+------+------------------
 10 | tst_in_feature              | f  |    5 | 5000 | /griddb_svr/
 10 | tst_in_feature              | t  |    5 | 5000 | /griddb_svr/
 20 | tst_in_feature              | t  |    6 | 6000 | /mongo_svr/
 29 | DEFAULT                     | t  |    4 | 4000 | /odbc_post_svr/
    | 3q                          |    | 22.2 |      | /jdbc_mysql_svr/
    | 3q@@                        |    | 7000 |      | /dynamodb_svr/
    | foo@@                       |    | 22.2 |      | /odbc_post_svr/
    | foo@@                       |    |      |      | /griddb_svr/
    | foo1                        | t  |      |      | /griddb_svr/
    | foo1@@                      |    | 7000 |      | /dynamodb_svr/
    | odbc text                   | t  | 22.2 |      | /odbc_post_svr/
    | odbc text@@                 |    |      |      | /griddb_svr/
    | test                        | f  | 22.2 |      | /odbc_post_svr/
    | test                        | t  |      |      | /mongo_svr/
    | test@@                      |    |      |      | /mongo_svr/
    | test@@                      |    |      |      | /mongo_svr/
    | VALUES are fun!@@           |    | 7000 |      | /dynamodb_svr/
    | varchar@@                   |    | 22.2 |      | /jdbc_mysql_svr/
    | xxxxxxxxxxxxxxxxxxxxxxxxx   | f  | 22.2 |      | /jdbc_mysql_svr/
    | xxxxxxxxxxxxxxxxxxxxxxxxx   | f  | 7000 |      | /dynamodb_svr/
    | xxxxxxxxxxxxxxxxxxxxxxxxx@@ |    | 22.2 |      | /odbc_post_svr/
    |                             |    | 22.2 |      | /jdbc_mysql_svr/
    |                             |    | 22.2 |      | /odbc_post_svr/
    |                             |    | 7000 |      | /dynamodb_svr/
    |                             |    |      |      | /griddb_svr/
(25 rows)

--Testcase 346:
DELETE FROM tntbl2 IN ('/mongo_svr/') WHERE c1 = 10;
--Testcase 347:
SELECT c1, c2, c3, c4, c5, __spd_url FROM tntbl2 ORDER BY 1, 2, 3, 4, 5, 6;
 c1 |             c2              | c3 |  c4  |  c5  |    __spd_url     
----+-----------------------------+----+------+------+------------------
 10 | tst_in_feature              | f  |    5 | 5000 | /griddb_svr/
 10 | tst_in_feature              | t  |    5 | 5000 | /griddb_svr/
 20 | tst_in_feature              | t  |    6 | 6000 | /mongo_svr/
 29 | DEFAULT                     | t  |    4 | 4000 | /odbc_post_svr/
    | 3q                          |    | 22.2 |      | /jdbc_mysql_svr/
    | 3q@@                        |    | 7000 |      | /dynamodb_svr/
    | foo@@                       |    | 22.2 |      | /odbc_post_svr/
    | foo@@                       |    |      |      | /griddb_svr/
    | foo1                        | t  |      |      | /griddb_svr/
    | foo1@@                      |    | 7000 |      | /dynamodb_svr/
    | odbc text                   | t  | 22.2 |      | /odbc_post_svr/
    | odbc text@@                 |    |      |      | /griddb_svr/
    | test                        | f  | 22.2 |      | /odbc_post_svr/
    | test                        | t  |      |      | /mongo_svr/
    | test@@                      |    |      |      | /mongo_svr/
    | test@@                      |    |      |      | /mongo_svr/
    | VALUES are fun!@@           |    | 7000 |      | /dynamodb_svr/
    | varchar@@                   |    | 22.2 |      | /jdbc_mysql_svr/
    | xxxxxxxxxxxxxxxxxxxxxxxxx   | f  | 22.2 |      | /jdbc_mysql_svr/
    | xxxxxxxxxxxxxxxxxxxxxxxxx   | f  | 7000 |      | /dynamodb_svr/
    | xxxxxxxxxxxxxxxxxxxxxxxxx@@ |    | 22.2 |      | /odbc_post_svr/
    |                             |    | 22.2 |      | /jdbc_mysql_svr/
    |                             |    | 22.2 |      | /odbc_post_svr/
    |                             |    | 7000 |      | /dynamodb_svr/
    |                             |    |      |      | /griddb_svr/
(25 rows)

--Testcase 348:
INSERT INTO tntbl3 (_id, c1, c2, c3, c4) VALUES ('_2', DEFAULT, DEFAULT, DEFAULT, DEFAULT);
--Testcase 349:
INSERT INTO tntbl3 (_id, c2, c3) VALUES ('_33', 3.0, DEFAULT);
--Testcase 350:
INSERT INTO tntbl3 VALUES(repeat('x', 10), 20, 4.0, 40.0, 5000);
--Testcase 351:
SELECT c1, c2, c3, c4, __spd_url FROM tntbl3 ORDER BY 1, 2, 3, 4, 5;
 c1 |  c2   |  c3   |  c4  |    __spd_url    
----+-------+-------+------+-----------------
  1 | -19.1 |       |      | /mongo_svr/
  1 |     1 | 56563 |      | /tiny_svr/
  1 |     1 |       |      | /postgres_svr/
  1 |     1 |       |      | /sqlite_svr/
  2 |    20 |       |      | /mongo_svr/
 10 |     5 |       |      | /sqlite_svr/
 10 |    10 |   222 |      | /jdbc_post_svr/
 20 |     4 |    40 | 5000 | /mongo_svr/
    |     3 |       |      | /griddb_svr/
    |     3 |       |      | /jdbc_post_svr/
    |     5 |   222 |      | /jdbc_post_svr/
    |     5 |       |      | /mongo_svr/
    |     7 |       |      | /mysql_svr/
    |       |       |      | /dynamodb_svr/
    |       |       |      | /griddb_svr/
(15 rows)

--Testcase 352:
INSERT INTO tntbl3 IN ('/dynamodb_svr/', '/mongo_svr/', '/griddb_svr/', '/mysql_svr/', '/postgres_svr/', '/postgres_svr_1/') VALUES ('_infea', 20, 6.0, 60.0, 6000);
--Testcase 353:
SELECT c1, c2, c3, c4, __spd_url FROM tntbl3 ORDER BY 1, 2, 3, 4, 5;
 c1 |  c2   |  c3   |  c4  |    __spd_url    
----+-------+-------+------+-----------------
  1 | -19.1 |       |      | /mongo_svr/
  1 |     1 | 56563 |      | /tiny_svr/
  1 |     1 |       |      | /postgres_svr/
  1 |     1 |       |      | /sqlite_svr/
  2 |    20 |       |      | /mongo_svr/
 10 |     5 |       |      | /sqlite_svr/
 10 |    10 |   222 |      | /jdbc_post_svr/
 20 |     4 |    40 | 5000 | /mongo_svr/
 20 |     6 |    60 | 6000 | /mysql_svr/
    |     3 |       |      | /griddb_svr/
    |     3 |       |      | /jdbc_post_svr/
    |     5 |   222 |      | /jdbc_post_svr/
    |     5 |       |      | /mongo_svr/
    |     7 |       |      | /mysql_svr/
    |       |       |      | /dynamodb_svr/
    |       |       |      | /griddb_svr/
(16 rows)

--Testcase 354:
UPDATE tntbl3 SET (c3, c2) = (SELECT c2 + 1 , c3 FROM tntbl3);
ERROR:  more than one row returned by a subquery used as an expression
--Testcase 355:
SELECT c1, c2, c3, c4, __spd_url FROM tntbl3 ORDER BY 1, 2, 3, 4, 5;
 c1 |  c2   |  c3   |  c4  |    __spd_url    
----+-------+-------+------+-----------------
  1 | -19.1 |       |      | /mongo_svr/
  1 |     1 | 56563 |      | /tiny_svr/
  1 |     1 |       |      | /postgres_svr/
  1 |     1 |       |      | /sqlite_svr/
  2 |    20 |       |      | /mongo_svr/
 10 |     5 |       |      | /sqlite_svr/
 10 |    10 |   222 |      | /jdbc_post_svr/
 20 |     4 |    40 | 5000 | /mongo_svr/
 20 |     6 |    60 | 6000 | /mysql_svr/
    |     3 |       |      | /griddb_svr/
    |     3 |       |      | /jdbc_post_svr/
    |     5 |   222 |      | /jdbc_post_svr/
    |     5 |       |      | /mongo_svr/
    |     7 |       |      | /mysql_svr/
    |       |       |      | /dynamodb_svr/
    |       |       |      | /griddb_svr/
(16 rows)

--Testcase 356:
UPDATE tntbl3 IN ('/tiny_svr/') SET c3 = 56.0;
--Testcase 357:
SELECT c1, c2, c3, c4, __spd_url FROM tntbl3 ORDER BY 1, 2, 3, 4, 5;
 c1 |  c2   | c3  |  c4  |    __spd_url    
----+-------+-----+------+-----------------
  1 | -19.1 |     |      | /mongo_svr/
  1 |     1 |  56 |      | /tiny_svr/
  1 |     1 |     |      | /postgres_svr/
  1 |     1 |     |      | /sqlite_svr/
  2 |    20 |     |      | /mongo_svr/
 10 |     5 |     |      | /sqlite_svr/
 10 |    10 | 222 |      | /jdbc_post_svr/
 20 |     4 |  40 | 5000 | /mongo_svr/
 20 |     6 |  60 | 6000 | /mysql_svr/
    |     3 |     |      | /griddb_svr/
    |     3 |     |      | /jdbc_post_svr/
    |     5 | 222 |      | /jdbc_post_svr/
    |     5 |     |      | /mongo_svr/
    |     7 |     |      | /mysql_svr/
    |       |     |      | /dynamodb_svr/
    |       |     |      | /griddb_svr/
(16 rows)

--Testcase 358:
DELETE FROM tntbl3 WHERE c1 > 10;
--Testcase 359:
SELECT c1, c2, c3, c4, __spd_url FROM tntbl3 ORDER BY 1, 2, 3, 4, 5;
 c1 |  c2   | c3  | c4 |    __spd_url    
----+-------+-----+----+-----------------
  1 | -19.1 |     |    | /mongo_svr/
  1 |     1 |  56 |    | /tiny_svr/
  1 |     1 |     |    | /postgres_svr/
  1 |     1 |     |    | /sqlite_svr/
  2 |    20 |     |    | /mongo_svr/
 10 |     5 |     |    | /sqlite_svr/
 10 |    10 | 222 |    | /jdbc_post_svr/
    |     3 |     |    | /griddb_svr/
    |     3 |     |    | /jdbc_post_svr/
    |     5 | 222 |    | /jdbc_post_svr/
    |     5 |     |    | /mongo_svr/
    |     7 |     |    | /mysql_svr/
    |       |     |    | /dynamodb_svr/
    |       |     |    | /griddb_svr/
(14 rows)

--Testcase 360:
DELETE FROM tntbl3 IN ('/mongo_svr/') WHERE c3 = 56.0;
--Testcase 361:
SELECT c1, c2, c3, c4, __spd_url FROM tntbl3 ORDER BY 1, 2, 3, 4, 5;
 c1 |  c2   | c3  | c4 |    __spd_url    
----+-------+-----+----+-----------------
  1 | -19.1 |     |    | /mongo_svr/
  1 |     1 |  56 |    | /tiny_svr/
  1 |     1 |     |    | /postgres_svr/
  1 |     1 |     |    | /sqlite_svr/
  2 |    20 |     |    | /mongo_svr/
 10 |     5 |     |    | /sqlite_svr/
 10 |    10 | 222 |    | /jdbc_post_svr/
    |     3 |     |    | /griddb_svr/
    |     3 |     |    | /jdbc_post_svr/
    |     5 | 222 |    | /jdbc_post_svr/
    |     5 |     |    | /mongo_svr/
    |     7 |     |    | /mysql_svr/
    |       |     |    | /dynamodb_svr/
    |       |     |    | /griddb_svr/
(14 rows)

--
--
-- Test with __spd_url
--
--Testcase 362:
DELETE FROM tntbl3 WHERE __spd_url = '/mongo_svr/';
--Testcase 363:
DELETE FROM tntbl3 WHERE __spd_url IS NOT NULL;
--Testcase 364:
INSERT INTO tntbl3 IN ('/dynamodb_svr/', '/mysql_svr/', '/griddb_svr/') VALUES ('foo', 30, 5.0, 50.0, 6000);
--Testcase 365:
INSERT INTO tntbl3 (SELECT * FROM tntbl3 ORDER BY 1, 2, 3);
ERROR:  Error occurred on a child table "tntbl3__dynamodb_svr__0".
DETAIL:  dynamodb_fdw: failed to execute remote SQL: Duplicate primary key exists in table 
   sql=INSERT INTO tntbl3 VALUE {'_id' : ?, 'c1' : ?, 'c2' : ?, 'c3' : ?, 'c4' : ?};
--Testcase 366:
SELECT c1, c2, c3, c4, __spd_url FROM tntbl3 ORDER BY 1, 2, 3, 4, 5;
 c1 | c2 | c3 |  c4  |   __spd_url    
----+----+----+------+----------------
 30 |  5 | 50 | 6000 | /dynamodb_svr/
(1 row)

--Testcase 368:
SELECT c1, c2, c3, c4, __spd_url FROM tntbl3 ORDER BY 1, 2, 3, 4, 5;
 c1 | c2 | c3 |  c4  |   __spd_url    
----+----+----+------+----------------
 30 |  5 | 50 | 6000 | /dynamodb_svr/
(1 row)

--Testcase 369:
DELETE FROM tntbl3;
--Testcase 370:
INSERT INTO tntbl3 (SELECT * FROM tntbl3 ORDER BY 1, 2, 3);
--Testcase 371:
SELECT c1, c2, c3, c4, __spd_url FROM tntbl3 ORDER BY 1, 2, 3, 4, 5;
 c1 | c2 | c3 | c4 | __spd_url 
----+----+----+----+-----------
(0 rows)

--Testcase 372:
INSERT INTO tntbl3 VALUES(repeat('x', 10), 20, 4.0, 40.0, 5000);
--Testcase 373:
SELECT c1, sum(c1), avg(c2) FROM tntbl3 WHERE __spd_url IS NOT NULL GROUP BY c1 HAVING c1 IS NOT NULL LIMIT 5;
 c1 | sum | avg 
----+-----+-----
 20 |  20 |   4
(1 row)

--Testcase 374:
INSERT INTO tntbl3 VALUES ('foo', 30, 5.0, 50.0, 6000, '/postgres_svr/');
--Testcase 375:
SELECT c1, c2, c3, c4, __spd_url FROM tntbl3 ORDER BY 1, 2, 3, 4, 5;
 c1 | c2 | c3 |  c4  |   __spd_url    
----+----+----+------+----------------
 20 |  4 | 40 | 5000 | /griddb_svr/
 30 |  5 | 50 | 6000 | /postgres_svr/
(2 rows)

--
-- Test with optional options: tntbl1
--
--
-- ON CONFLICT, this work only on postgres_fdw
--
--Testcase 376:
INSERT INTO tntbl1(c1, c2) VALUES(11, 12);  -- duplicate key
--Testcase 377:
INSERT INTO tntbl1(c1, c2) VALUES(11, 12) ON CONFLICT DO NOTHING; -- works
ERROR:  ON CONFLICT clause is not supported
--Testcase 378:
INSERT INTO tntbl1(c1, c2) VALUES(11, 12) ON CONFLICT (c1, c2) DO NOTHING; -- unsupported
ERROR:  there is no unique or exclusion constraint matching the ON CONFLICT specification
--Testcase 379:
INSERT INTO tntbl1(c1, c2) VALUES(11, 12) ON CONFLICT (c1, c2) DO UPDATE SET c3 = 562.3213; -- unsupported
ERROR:  there is no unique or exclusion constraint matching the ON CONFLICT specification
--
-- WITH CHECK, this work only on postgres_fdw
--
--Testcase 380:
CREATE VIEW rw_view AS SELECT * FROM tntbl1
  WHERE c1 < c2 WITH CHECK OPTION;
--Testcase 381:
\d+ rw_view
                                       View "public.rw_view"
  Column   |            Type             | Collation | Nullable | Default | Storage  | Description 
-----------+-----------------------------+-----------+----------+---------+----------+-------------
 c1        | integer                     |           |          |         | plain    | 
 c2        | smallint                    |           |          |         | plain    | 
 c3        | double precision            |           |          |         | plain    | 
 c4        | double precision            |           |          |         | plain    | 
 c5        | bigint                      |           |          |         | plain    | 
 c6        | timestamp without time zone |           |          |         | plain    | 
 c7        | timestamp with time zone    |           |          |         | plain    | 
 c8        | character(255)              |           |          |         | extended | 
 c9        | character varying(255)      |           |          |         | extended | 
 __spd_url | text                        |           |          |         | extended | 
View definition:
 SELECT tntbl1.c1,
    tntbl1.c2,
    tntbl1.c3,
    tntbl1.c4,
    tntbl1.c5,
    tntbl1.c6,
    tntbl1.c7,
    tntbl1.c8,
    tntbl1.c9,
    tntbl1.__spd_url
   FROM tntbl1
  WHERE tntbl1.c1 < tntbl1.c2;
Options: check_option=cascaded

--Testcase 382:
EXPLAIN (VERBOSE, COSTS OFF)
INSERT INTO rw_view(c1, c2) VALUES (5, 0);
ERROR:  WITH CHECK clause is not supported
--Testcase 383:
INSERT INTO rw_view(c1, c2) VALUES (5, 0); -- should fail
ERROR:  WITH CHECK clause is not supported
--Testcase 384:
EXPLAIN (VERBOSE, COSTS OFF)
INSERT INTO rw_view(c1, c2) VALUES (0, 15);
ERROR:  WITH CHECK clause is not supported
--Testcase 385:
INSERT INTO rw_view(c1, c2) VALUES (0, 15); -- ok
ERROR:  WITH CHECK clause is not supported
--Testcase 386:
SELECT * FROM tntbl1 ORDER BY 1, 2, 3;
 c1  | c2  |   c3   |   c4    |   c5    |         c6          |           c7           |                                                                                                                               c8                                                                                                                                |      c9       |   __spd_url    
-----+-----+--------+---------+---------+---------------------+------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+----------------
  -1 |   2 |    100 |         |   69845 |                     | 1972-01-01 00:00:01+00 | Beera                                                                                                                                                                                                                                                           | John Does     | /oracle_svr/
   1 |     |        |         |         |                     |                        |                                                                                                                                                                                                                                                                 |               | /oracle_svr/
   5 |     |        |         |         |                     |                        |                                                                                                                                                                                                                                                                 |               | /mysql_svr/
  11 |  12 |        |         |         |                     |                        |                                                                                                                                                                                                                                                                 |               | /postgres_svr/
  13 |     |   22.2 |         |    5944 |                     | 2007-10-19 08:23:54+00 | bugle                                                                                                                                                                                                                                                           | foo           | /postgres_svr/
  20 |   0 |   22.2 |         |    1000 |                     | 2022-06-22 07:00:00+00 | char array                                                                                                                                                                                                                                                      | varchar array | /postgres_svr/
 600 | 120 | 73.265 | 78523.5 | 5421659 | 2002-10-19 10:23:54 | 1971-12-31 17:00:01+00 | Two                                                                                                                                                                                                                                                             | TwoTwo        | /oracle_svr/
(7 rows)

--Testcase 387:
EXPLAIN (VERBOSE, COSTS OFF)
UPDATE rw_view SET c1 = c1 + 100;
ERROR:  WITH CHECK clause is not supported
--Testcase 388:
UPDATE rw_view SET c1 = c1 + 100; -- should fail
ERROR:  WITH CHECK clause is not supported
--Testcase 389:
EXPLAIN (VERBOSE, COSTS OFF)
UPDATE rw_view SET c2 = c2 + 15;
ERROR:  WITH CHECK clause is not supported
--Testcase 390:
UPDATE rw_view SET c2 = c2 + 15; -- ok
ERROR:  WITH CHECK clause is not supported
--Testcase 391:
SELECT * FROM tntbl1 ORDER BY 1, 2, 3;
 c1  | c2  |   c3   |   c4    |   c5    |         c6          |           c7           |                                                                                                                               c8                                                                                                                                |      c9       |   __spd_url    
-----+-----+--------+---------+---------+---------------------+------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+----------------
  -1 |   2 |    100 |         |   69845 |                     | 1972-01-01 00:00:01+00 | Beera                                                                                                                                                                                                                                                           | John Does     | /oracle_svr/
   1 |     |        |         |         |                     |                        |                                                                                                                                                                                                                                                                 |               | /oracle_svr/
   5 |     |        |         |         |                     |                        |                                                                                                                                                                                                                                                                 |               | /mysql_svr/
  11 |  12 |        |         |         |                     |                        |                                                                                                                                                                                                                                                                 |               | /postgres_svr/
  13 |     |   22.2 |         |    5944 |                     | 2007-10-19 08:23:54+00 | bugle                                                                                                                                                                                                                                                           | foo           | /postgres_svr/
  20 |   0 |   22.2 |         |    1000 |                     | 2022-06-22 07:00:00+00 | char array                                                                                                                                                                                                                                                      | varchar array | /postgres_svr/
 600 | 120 | 73.265 | 78523.5 | 5421659 | 2002-10-19 10:23:54 | 1971-12-31 17:00:01+00 | Two                                                                                                                                                                                                                                                             | TwoTwo        | /oracle_svr/
(7 rows)

--Testcase 392:
DROP VIEW rw_view;
--
-- RETURNING
--
--Testcase 393:
INSERT INTO tntbl1 VALUES (1, 2, 3.0, 6.0, 21, '2002-01-01 00:05:00', '2022-05-16 10:50:00+01', 'test1', 'test1') RETURNING *;
ERROR:  RETURNING clause is not supported
--Testcase 394:
INSERT INTO tntbl1 (c1, c2, c3, c4, c5) VALUES (2, 3, 4.0, 5.0, 6) RETURNING c1, c4, c6;
ERROR:  RETURNING clause is not supported
--Testcase 395:
UPDATE tntbl1 SET c7 = '2100-01-01 10:00:00+01' WHERE c1 = 2 AND c2 = 3 RETURNING (tntbl1), *;
ERROR:  RETURNING clause is not supported
--Testcase 396:
DELETE FROM tntbl1 WHERE c4 = 6.0 RETURNING c1, c2;
ERROR:  RETURNING clause is not supported
--Testcase 397:
DELETE FROM tntbl1 RETURNING *;
ERROR:  RETURNING clause is not supported
--
-- Test with optional options: tntbl2
--
--
--
-- ON CONFLICT, this work only on postgres_fdw
--
--Testcase 398:
INSERT INTO tntbl2(_id, c1) VALUES('key', 12);  -- duplicate key
--Testcase 399:
INSERT INTO tntbl2(_id, c1) VALUES('key', 12) ON CONFLICT DO NOTHING; -- works
ERROR:  ON CONFLICT clause is not supported
--Testcase 400:
INSERT INTO tntbl2(_id, c1) VALUES('key', 12) ON CONFLICT (_id, c1) DO NOTHING; -- unsupported
ERROR:  there is no unique or exclusion constraint matching the ON CONFLICT specification
--Testcase 401:
INSERT INTO tntbl2(_id, c1) VALUES('key', 12) ON CONFLICT (_id, c1) DO UPDATE SET c2 = 'conficted!'; -- unsupported
ERROR:  there is no unique or exclusion constraint matching the ON CONFLICT specification
--
-- WITH CHECK, this work only on postgres_fdw
--
--Testcase 402:
CREATE VIEW rw_view AS SELECT * FROM tntbl2
  WHERE c1 < c5 WITH CHECK OPTION;
--Testcase 403:
\d+ rw_view
                                 View "public.rw_view"
  Column   |       Type       | Collation | Nullable | Default | Storage  | Description 
-----------+------------------+-----------+----------+---------+----------+-------------
 _id       | text             |           |          |         | extended | 
 c1        | integer          |           |          |         | plain    | 
 c2        | text             |           |          |         | extended | 
 c3        | boolean          |           |          |         | plain    | 
 c4        | double precision |           |          |         | plain    | 
 c5        | bigint           |           |          |         | plain    | 
 __spd_url | text             |           |          |         | extended | 
View definition:
 SELECT tntbl2._id,
    tntbl2.c1,
    tntbl2.c2,
    tntbl2.c3,
    tntbl2.c4,
    tntbl2.c5,
    tntbl2.__spd_url
   FROM tntbl2
  WHERE tntbl2.c1 < tntbl2.c5;
Options: check_option=cascaded

--Testcase 404:
EXPLAIN (VERBOSE, COSTS OFF)
INSERT INTO rw_view(_id, c1, c5) VALUES ('id1', 5, 0);
ERROR:  WITH CHECK clause is not supported
--Testcase 405:
INSERT INTO rw_view(_id, c1, c5) VALUES ('id1', 5, 0); -- should fail
ERROR:  WITH CHECK clause is not supported
--Testcase 406:
EXPLAIN (VERBOSE, COSTS OFF)
INSERT INTO rw_view(_id, c1, c5) VALUES ('id2', 5, 3000);
ERROR:  WITH CHECK clause is not supported
--Testcase 407:
INSERT INTO rw_view(_id, c1, c5) VALUES ('id2', 5, 3000); -- ok
ERROR:  WITH CHECK clause is not supported
--Testcase 408:
SELECT char_length(_id), c1, char_length(c2), c3, c4, c5 FROM tntbl2 ORDER BY 1, 2, 3, 4, 5, 6;
 char_length | c1 | char_length | c3 |  c4  |  c5  
-------------+----+-------------+----+------+------
           1 |    |           2 |    | 22.2 |     
           1 |    |             |    | 7000 |     
           1 |    |             |    |      |     
           3 | 10 |          14 | f  |    5 | 5000
           3 | 12 |             |    |      |     
           3 | 29 |           7 | t  |    4 | 4000
           3 |    |           4 |    | 7000 |     
           3 |    |          25 | f  | 22.2 |     
           3 |    |             |    | 22.2 |     
           3 |    |             |    | 22.2 |     
           4 | 10 |          14 | t  |    5 | 5000
           4 |    |           4 | f  | 22.2 |     
           4 |    |           9 | t  | 22.2 |     
           5 |    |          17 |    | 7000 |     
           6 |    |           4 | t  |      |     
           6 |    |          11 |    |      |     
           6 |    |          25 | f  | 7000 |     
           8 |    |           5 |    | 22.2 |     
           8 |    |           6 |    | 7000 |     
          24 | 20 |          14 | t  |    6 | 6000
          24 |    |           4 | t  |      |     
          24 |    |           6 |    |      |     
          24 |    |           6 |    |      |     
          26 |    |           5 |    |      |     
          26 |    |           9 |    | 22.2 |     
          26 |    |          27 |    | 22.2 |     
(26 rows)

--Testcase 409:
EXPLAIN (VERBOSE, COSTS OFF)
UPDATE rw_view SET c1 = c1 + 10000;
ERROR:  WITH CHECK clause is not supported
--Testcase 410:
UPDATE rw_view SET c1 = c1 + 10000; -- should fail
ERROR:  WITH CHECK clause is not supported
--Testcase 411:
EXPLAIN (VERBOSE, COSTS OFF)
UPDATE rw_view SET c1 = c1 + 15;
ERROR:  WITH CHECK clause is not supported
--Testcase 412:
UPDATE rw_view SET c1 = c1 + 15; -- ok
ERROR:  WITH CHECK clause is not supported
--Testcase 413:
SELECT char_length(_id), c1, char_length(c2), c3, c4, c5 FROM tntbl2 ORDER BY 1, 2, 3, 4, 5, 6;
 char_length | c1 | char_length | c3 |  c4  |  c5  
-------------+----+-------------+----+------+------
           1 |    |           2 |    | 22.2 |     
           1 |    |             |    | 7000 |     
           1 |    |             |    |      |     
           3 | 10 |          14 | f  |    5 | 5000
           3 | 12 |             |    |      |     
           3 | 29 |           7 | t  |    4 | 4000
           3 |    |           4 |    | 7000 |     
           3 |    |          25 | f  | 22.2 |     
           3 |    |             |    | 22.2 |     
           3 |    |             |    | 22.2 |     
           4 | 10 |          14 | t  |    5 | 5000
           4 |    |           4 | f  | 22.2 |     
           4 |    |           9 | t  | 22.2 |     
           5 |    |          17 |    | 7000 |     
           6 |    |           4 | t  |      |     
           6 |    |          11 |    |      |     
           6 |    |          25 | f  | 7000 |     
           8 |    |           5 |    | 22.2 |     
           8 |    |           6 |    | 7000 |     
          24 | 20 |          14 | t  |    6 | 6000
          24 |    |           4 | t  |      |     
          24 |    |           6 |    |      |     
          24 |    |           6 |    |      |     
          26 |    |           5 |    |      |     
          26 |    |           9 |    | 22.2 |     
          26 |    |          27 |    | 22.2 |     
(26 rows)

--Testcase 414:
DROP VIEW rw_view;
--
-- RETURNING
--
--Testcase 415:
INSERT INTO tntbl2 VALUES ('00:05:00', 20, '2022-05-16', false, 50.0, 7000) RETURNING *;
ERROR:  RETURNING clause is not supported
--Testcase 416:
INSERT INTO tntbl2 (_id, c1, c2, c3, c4, c5) VALUES ('_key_', 30, 'test', true, 50.0, 8000) RETURNING c1, c4, c5;
ERROR:  RETURNING clause is not supported
--Testcase 417:
UPDATE tntbl2 SET c2 = '2100-01-01 10:00:00+01' WHERE c1 = 20 AND c3 = false RETURNING (tntbl2), *;
ERROR:  RETURNING clause is not supported
--Testcase 418:
DELETE FROM tntbl2 WHERE c4 = 50.0 RETURNING _id, c1, c2;
ERROR:  RETURNING clause is not supported
--Testcase 419:
DELETE FROM tntbl2 RETURNING *;
ERROR:  RETURNING clause is not supported
--
-- Test with optional options: tntbl3
--
--
--
-- ON CONFLICT, this work only on postgres_fdw
--
--Testcase 420:
INSERT INTO tntbl3(_id, c1) VALUES('key$', 12);  -- duplicate key
--Testcase 421:
INSERT INTO tntbl3(_id, c1) VALUES('key$', 12) ON CONFLICT DO NOTHING; -- works
ERROR:  ON CONFLICT clause is not supported
--Testcase 422:
INSERT INTO tntbl3(_id, c1) VALUES('key$', 12) ON CONFLICT (_id, c1) DO NOTHING; -- unsupported
ERROR:  there is no unique or exclusion constraint matching the ON CONFLICT specification
--Testcase 423:
INSERT INTO tntbl3(_id, c1) VALUES('key$', 12) ON CONFLICT (_id, c1) DO UPDATE SET c2 = 'conficted!'; -- unsupported
ERROR:  invalid input syntax for type real: "conficted!"
LINE 1: ...y$', 12) ON CONFLICT (_id, c1) DO UPDATE SET c2 = 'conficted...
                                                             ^
--
-- WITH CHECK, this work only on postgres_fdw
--
--Testcase 424:
CREATE VIEW rw_view AS SELECT * FROM tntbl3
  WHERE c2 < c3 WITH CHECK OPTION;
--Testcase 425:
\d+ rw_view
                                 View "public.rw_view"
  Column   |       Type       | Collation | Nullable | Default | Storage  | Description 
-----------+------------------+-----------+----------+---------+----------+-------------
 _id       | text             |           |          |         | extended | 
 c1        | integer          |           |          |         | plain    | 
 c2        | real             |           |          |         | plain    | 
 c3        | double precision |           |          |         | plain    | 
 c4        | bigint           |           |          |         | plain    | 
 __spd_url | text             |           |          |         | extended | 
View definition:
 SELECT tntbl3._id,
    tntbl3.c1,
    tntbl3.c2,
    tntbl3.c3,
    tntbl3.c4,
    tntbl3.__spd_url
   FROM tntbl3
  WHERE tntbl3.c2 < tntbl3.c3;
Options: check_option=cascaded

--Testcase 426:
EXPLAIN (VERBOSE, COSTS OFF)
INSERT INTO rw_view(_id, c2, c3) VALUES ('id1', 5, 0);
ERROR:  WITH CHECK clause is not supported
--Testcase 427:
INSERT INTO rw_view(_id, c2, c3) VALUES ('id1', 5, 0); -- should fail
ERROR:  WITH CHECK clause is not supported
--Testcase 428:
EXPLAIN (VERBOSE, COSTS OFF)
INSERT INTO rw_view(_id, c2, c3) VALUES ('id2', 5, 3000);
ERROR:  WITH CHECK clause is not supported
--Testcase 429:
INSERT INTO rw_view(_id, c2, c3) VALUES ('id2', 5, 3000); -- ok
ERROR:  WITH CHECK clause is not supported
--Testcase 430:
SELECT c1, c2, c3, c4 FROM tntbl3 ORDER BY 1, 2, 3;
 c1 | c2 | c3 |  c4  
----+----+----+------
 12 |    |    |     
 20 |  4 | 40 | 5000
 30 |  5 | 50 | 6000
(3 rows)

--Testcase 431:
EXPLAIN (VERBOSE, COSTS OFF)
UPDATE rw_view SET c2 = c2 + 10000;
ERROR:  WITH CHECK clause is not supported
--Testcase 432:
UPDATE rw_view SET c2 = c2 + 10000; -- should fail
ERROR:  WITH CHECK clause is not supported
--Testcase 433:
EXPLAIN (VERBOSE, COSTS OFF)
UPDATE rw_view SET c2 = c2 + 15;
ERROR:  WITH CHECK clause is not supported
--Testcase 434:
UPDATE rw_view SET c2 = c2 + 15; -- ok
ERROR:  WITH CHECK clause is not supported
--Testcase 435:
SELECT c1, c2, c3, c4 FROM tntbl3 ORDER BY 1, 2, 3;
 c1 | c2 | c3 |  c4  
----+----+----+------
 12 |    |    |     
 20 |  4 | 40 | 5000
 30 |  5 | 50 | 6000
(3 rows)

--Testcase 436:
DROP VIEW rw_view;
--
-- RETURNING
--
--Testcase 437:
INSERT INTO tntbl3 VALUES ('0000', 20, 5.0, 50.0, 5000) RETURNING *;
ERROR:  RETURNING clause is not supported
--Testcase 438:
INSERT INTO tntbl3 (_id, c1, c2, c3, c4) VALUES ('_key_', 30, 4.0, 50.0, 6000) RETURNING c1, c2, c3;
ERROR:  RETURNING clause is not supported
--Testcase 439:
UPDATE tntbl3 SET c2 = 7.0 WHERE c1 = 20 AND c3 = 50.0 RETURNING (tntbl3), *;
ERROR:  RETURNING clause is not supported
--Testcase 440:
DELETE FROM tntbl3 WHERE c3 = 50.0 RETURNING _id, c1, c2;
ERROR:  RETURNING clause is not supported
--Testcase 441:
DELETE FROM tntbl3 RETURNING *;
ERROR:  RETURNING clause is not supported
--
-- Test with optional options: tntbl4
--
--
--
-- ON CONFLICT, this work only on postgres_fdw
--
--Testcase 442:
INSERT INTO tntbl4(c1, c2) VALUES(14, 'key$');  -- duplicate key
--Testcase 443:
INSERT INTO tntbl4(c1, c2) VALUES(14, 'key$') ON CONFLICT DO NOTHING; -- works
ERROR:  ON CONFLICT clause is not supported
--Testcase 444:
INSERT INTO tntbl4(c1, c2) VALUES(14, 'key$') ON CONFLICT (c1, c2) DO NOTHING; -- unsupported
ERROR:  there is no unique or exclusion constraint matching the ON CONFLICT specification
--Testcase 445:
INSERT INTO tntbl4(c1, c2) VALUES(14, 'key$') ON CONFLICT (c1, c2) DO UPDATE SET c4 = 5.0; -- unsupported
ERROR:  there is no unique or exclusion constraint matching the ON CONFLICT specification
--
-- WITH CHECK, this work only on postgres_fdw
--
--Testcase 446:
CREATE VIEW rw_view AS SELECT * FROM tntbl4
  WHERE c1 < c5 WITH CHECK OPTION;
--Testcase 447:
\d+ rw_view
                                       View "public.rw_view"
  Column   |            Type             | Collation | Nullable | Default | Storage  | Description 
-----------+-----------------------------+-----------+----------+---------+----------+-------------
 c1        | integer                     |           |          |         | plain    | 
 c2        | text                        |           |          |         | extended | 
 c3        | boolean                     |           |          |         | plain    | 
 c4        | double precision            |           |          |         | plain    | 
 c5        | bigint                      |           |          |         | plain    | 
 c6        | character(255)              |           |          |         | extended | 
 c7        | character varying(255)      |           |          |         | extended | 
 c8        | double precision            |           |          |         | plain    | 
 c9        | smallint                    |           |          |         | plain    | 
 c10       | timestamp without time zone |           |          |         | plain    | 
 c11       | timestamp with time zone    |           |          |         | plain    | 
 c12       | date                        |           |          |         | plain    | 
 c13       | json                        |           |          |         | extended | 
 c14       | jsonb                       |           |          |         | extended | 
 c15       | uuid                        |           |          |         | plain    | 
 c16       | point                       |           |          |         | plain    | 
 c17       | bytea                       |           |          |         | extended | 
 c18       | bit(10)                     |           |          |         | extended | 
 c19       | bit varying(10)             |           |          |         | extended | 
 c20       | interval                    |           |          |         | plain    | 
 __spd_url | text                        |           |          |         | extended | 
View definition:
 SELECT tntbl4.c1,
    tntbl4.c2,
    tntbl4.c3,
    tntbl4.c4,
    tntbl4.c5,
    tntbl4.c6,
    tntbl4.c7,
    tntbl4.c8,
    tntbl4.c9,
    tntbl4.c10,
    tntbl4.c11,
    tntbl4.c12,
    tntbl4.c13,
    tntbl4.c14,
    tntbl4.c15,
    tntbl4.c16,
    tntbl4.c17,
    tntbl4.c18,
    tntbl4.c19,
    tntbl4.c20,
    tntbl4.__spd_url
   FROM tntbl4
  WHERE tntbl4.c1 < tntbl4.c5;
Options: check_option=cascaded

--Testcase 448:
EXPLAIN (VERBOSE, COSTS OFF)
INSERT INTO rw_view(c1, c5) VALUES (15, 0);
ERROR:  WITH CHECK clause is not supported
--Testcase 449:
INSERT INTO rw_view(c1, c5) VALUES (15, 0); -- should fail
ERROR:  WITH CHECK clause is not supported
--Testcase 450:
EXPLAIN (VERBOSE, COSTS OFF)
INSERT INTO rw_view(c1, c5) VALUES (15, 3000);
ERROR:  WITH CHECK clause is not supported
--Testcase 451:
INSERT INTO rw_view(c1, c5) VALUES (15, 3000); -- ok
ERROR:  WITH CHECK clause is not supported
--Testcase 452:
SELECT c1, char_length(c2), c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, c14, c15, c16, c17, c18, c19, c20 FROM tntbl4 ORDER BY 1, 2, 3, 4, 5, 6, 7, 8, 9, 10;
 c1 | char_length | c3 | c4  |  c5   | c6 |      c7       |  c8  | c9  |         c10         |          c11           |    c12     |                 c13                 |                                   c14                                   |                 c15                  |   c16   |         c17          |    c18     |  c19  |                     c20                      
----+-------------+----+-----+-------+----+---------------+------+-----+---------------------+------------------------+------------+-------------------------------------+-------------------------------------------------------------------------+--------------------------------------+---------+----------------------+------------+-------+----------------------------------------------
 -1 |             |    |     |  4000 |    |               | 22.2 |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  3 |             |    |     |       |    |               | 22.2 |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  4 |           5 |    |     |       |    |               | 22.2 |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  5 |             |    |  10 |  1000 |    | char varying  | 22.2 | 128 | 2004-10-19 10:23:54 | 2004-10-19 08:23:54+00 | 0001-01-01 | { "customer": "John Does"}          | {"tags": ["tag1", "tag2"], "finished": true}                            | 2f404849-f62c-4234-b0c8-e230bd694045 | (1,-45) | \xa7a8a9aaabacadaeaf | 1111111111 | 10101 | @ 6 years 5 mons 4 days 3 hours 2 mins 1 sec
  9 |             |    |     |       |    |               | 22.2 |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 12 |           5 |    |     |  5000 |    |               | 22.2 |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 12 |           8 |    |     |       |    |               | 22.2 |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 13 |           6 |    |     |  6000 |    |               | 22.2 |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 13 |             |    |     |       |    |               | 22.2 |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 14 |           4 |    |     |       |    |               |      |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 14 |           9 |    |     |       |    |               | 22.2 |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 15 |             |    |     |       |    |               | 22.2 |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 20 |           8 |    | -10 | 10010 |    | varchar array | 22.2 | 100 | 2005-10-19 10:23:54 | 2005-10-19 08:23:54+00 | 2001-01-01 | {"product": "sample","quantity": 1} | {"name": "paintings", "tags": ["Scene", "Portrait"], "finished": false} | 2f404849-f62c-4234-b0c8-e230bd694045 | (1,-45) | \xa7a8a9aaabacadaeaf | 1111111111 | 10101 | @ 1 year 3 hours 20 mins
 20 |           8 |    |     |       |    |               | 22.2 | 100 |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 22 |           9 |    |     |       |    |               | 22.2 |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 23 |          10 |    |     |       |    |               | 22.2 |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
    |             |    |     |       |    |               | 22.2 |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
    |             |    |     |       |    |               | 22.2 |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
(18 rows)

--Testcase 453:
EXPLAIN (VERBOSE, COSTS OFF)
UPDATE rw_view SET c1 = c1 + 10000;
ERROR:  WITH CHECK clause is not supported
--Testcase 454:
UPDATE rw_view SET c1 = c1 + 10000; -- should fail
ERROR:  WITH CHECK clause is not supported
--Testcase 455:
EXPLAIN (VERBOSE, COSTS OFF)
UPDATE rw_view SET c1 = c1 + 15;
ERROR:  WITH CHECK clause is not supported
--Testcase 456:
UPDATE rw_view SET c1 = c1 + 15; -- ok
ERROR:  WITH CHECK clause is not supported
--Testcase 457:
SELECT c1, char_length(c2), c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, c14, c15, c16, c17, c18, c19, c20 FROM tntbl4 ORDER BY 1, 2, 3, 4, 5, 6, 7, 8, 9, 10;
 c1 | char_length | c3 | c4  |  c5   | c6 |      c7       |  c8  | c9  |         c10         |          c11           |    c12     |                 c13                 |                                   c14                                   |                 c15                  |   c16   |         c17          |    c18     |  c19  |                     c20                      
----+-------------+----+-----+-------+----+---------------+------+-----+---------------------+------------------------+------------+-------------------------------------+-------------------------------------------------------------------------+--------------------------------------+---------+----------------------+------------+-------+----------------------------------------------
 -1 |             |    |     |  4000 |    |               | 22.2 |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  3 |             |    |     |       |    |               | 22.2 |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  4 |           5 |    |     |       |    |               | 22.2 |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
  5 |             |    |  10 |  1000 |    | char varying  | 22.2 | 128 | 2004-10-19 10:23:54 | 2004-10-19 08:23:54+00 | 0001-01-01 | { "customer": "John Does"}          | {"tags": ["tag1", "tag2"], "finished": true}                            | 2f404849-f62c-4234-b0c8-e230bd694045 | (1,-45) | \xa7a8a9aaabacadaeaf | 1111111111 | 10101 | @ 6 years 5 mons 4 days 3 hours 2 mins 1 sec
  9 |             |    |     |       |    |               | 22.2 |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 12 |           5 |    |     |  5000 |    |               | 22.2 |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 12 |           8 |    |     |       |    |               | 22.2 |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 13 |           6 |    |     |  6000 |    |               | 22.2 |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 13 |             |    |     |       |    |               | 22.2 |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 14 |           4 |    |     |       |    |               |      |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 14 |           9 |    |     |       |    |               | 22.2 |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 15 |             |    |     |       |    |               | 22.2 |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 20 |           8 |    | -10 | 10010 |    | varchar array | 22.2 | 100 | 2005-10-19 10:23:54 | 2005-10-19 08:23:54+00 | 2001-01-01 | {"product": "sample","quantity": 1} | {"name": "paintings", "tags": ["Scene", "Portrait"], "finished": false} | 2f404849-f62c-4234-b0c8-e230bd694045 | (1,-45) | \xa7a8a9aaabacadaeaf | 1111111111 | 10101 | @ 1 year 3 hours 20 mins
 20 |           8 |    |     |       |    |               | 22.2 | 100 |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 22 |           9 |    |     |       |    |               | 22.2 |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
 23 |          10 |    |     |       |    |               | 22.2 |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
    |             |    |     |       |    |               | 22.2 |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
    |             |    |     |       |    |               | 22.2 |     |                     |                        |            |                                     |                                                                         |                                      |         |                      |            |       | 
(18 rows)

--Testcase 458:
DROP VIEW rw_view;
--
-- RETURNING
--
--Testcase 459:
INSERT INTO tntbl4 VALUES (70, '0000', true, 5.0, 5000) RETURNING *;
ERROR:  RETURNING clause is not supported
--Testcase 460:
INSERT INTO tntbl4 (c1, c2, c3, c4, c5) VALUES (80, '_key_', false, 4.0, 6000) RETURNING c1, c2, c3;
ERROR:  RETURNING clause is not supported
--Testcase 461:
UPDATE tntbl4 SET c4 = 7.0 WHERE c1 = 70 AND c3 = true RETURNING (tntbl4), *;
ERROR:  RETURNING clause is not supported
--Testcase 462:
DELETE FROM tntbl4 WHERE c3 = true RETURNING c1, c2, c3;
ERROR:  RETURNING clause is not supported
--Testcase 463:
DELETE FROM tntbl4 RETURNING *;
ERROR:  RETURNING clause is not supported
--
-- Test case bulk insert
--
--Testcase 483:
CREATE FOREIGN TABLE tntbl3__file_svr__0 (_id text, c1 int, c2 real, c3 double precision, c4 bigint) SERVER file_svr OPTIONS (filename '/tmp/pg_modify_bulk_insert.csv', format 'csv');
-- Clean tntbl3
--Testcase 484:
DELETE FROM tntbl3;
WARNING:  file_fdw will be skipped because it does not support modification
--Testcase 485:
SELECT c1, c2, c3, c4, __spd_url FROM tntbl3 ORDER BY 1, 2, 3, 4, 5;
 c1 | c2 |  c3  |  c4   | __spd_url  
----+----+------+-------+------------
 10 | 10 | 1000 | 10000 | /file_svr/
(1 row)

SET client_min_messages = INFO;
-- bulk insert in tntbl3
-- Manual config:
-- batch_size server = 5, batch_size table not set, batch_size of FDW (if support) not set, insert 100 records
--Testcase 486:
-- ALTER SERVER pgspider_svr OPTIONS (ADD batch_size '5');
--Testcase 487:
INSERT INTO tntbl3
    SELECT ('idTable3_'::text || id),
            id,
            id + 0.1,
            id + 0.01,
            id
    FROM generate_series(1, 100) id;
WARNING:  file_fdw is ignored as an insert target because it does not support modification
--Testcase 488:
SELECT count(*) FROM tntbl3;
 count 
-------
   101
(1 row)

--Testcase 489:
SELECT c1, c2, c3, c4, __spd_url FROM tntbl3 ORDER BY 1, 2, 3, 4, 5;
 c1  |  c2   |   c3   |  c4   |    __spd_url     
-----+-------+--------+-------+------------------
   1 |   1.1 |   1.01 |     1 | /tiny_svr/
   2 |   2.1 |   2.01 |     2 | /dynamodb_svr/
   3 |   3.1 |   3.01 |     3 | /griddb_svr/
   4 |   4.1 |   4.01 |     4 | /jdbc_post_svr/
   5 |   5.1 |   5.01 |     5 | /mongo_svr/
   6 |   6.1 |   6.01 |     6 | /mysql_svr/
   7 |   7.1 |   7.01 |     7 | /odbc_mysql_svr/
   8 |   8.1 |   8.01 |     8 | /oracle_svr/
   9 |   9.1 |   9.01 |     9 | /postgres_svr/
  10 |    10 |   1000 | 10000 | /file_svr/
  10 |  10.1 |  10.01 |    10 | /sqlite_svr/
  11 |  11.1 |  11.01 |    11 | /tiny_svr/
  12 |  12.1 |  12.01 |    12 | /dynamodb_svr/
  13 |  13.1 |  13.01 |    13 | /griddb_svr/
  14 |  14.1 |  14.01 |    14 | /jdbc_post_svr/
  15 |  15.1 |  15.01 |    15 | /mongo_svr/
  16 |  16.1 |  16.01 |    16 | /mysql_svr/
  17 |  17.1 |  17.01 |    17 | /odbc_mysql_svr/
  18 |  18.1 |  18.01 |    18 | /oracle_svr/
  19 |  19.1 |  19.01 |    19 | /postgres_svr/
  20 |  20.1 |  20.01 |    20 | /sqlite_svr/
  21 |  21.1 |  21.01 |    21 | /tiny_svr/
  22 |  22.1 |  22.01 |    22 | /dynamodb_svr/
  23 |  23.1 |  23.01 |    23 | /griddb_svr/
  24 |  24.1 |  24.01 |    24 | /jdbc_post_svr/
  25 |  25.1 |  25.01 |    25 | /mongo_svr/
  26 |  26.1 |  26.01 |    26 | /mysql_svr/
  27 |  27.1 |  27.01 |    27 | /odbc_mysql_svr/
  28 |  28.1 |  28.01 |    28 | /oracle_svr/
  29 |  29.1 |  29.01 |    29 | /postgres_svr/
  30 |  30.1 |  30.01 |    30 | /sqlite_svr/
  31 |  31.1 |  31.01 |    31 | /tiny_svr/
  32 |  32.1 |  32.01 |    32 | /dynamodb_svr/
  33 |  33.1 |  33.01 |    33 | /griddb_svr/
  34 |  34.1 |  34.01 |    34 | /jdbc_post_svr/
  35 |  35.1 |  35.01 |    35 | /mongo_svr/
  36 |  36.1 |  36.01 |    36 | /mysql_svr/
  37 |  37.1 |  37.01 |    37 | /odbc_mysql_svr/
  38 |  38.1 |  38.01 |    38 | /oracle_svr/
  39 |  39.1 |  39.01 |    39 | /postgres_svr/
  40 |  40.1 |  40.01 |    40 | /sqlite_svr/
  41 |  41.1 |  41.01 |    41 | /tiny_svr/
  42 |  42.1 |  42.01 |    42 | /dynamodb_svr/
  43 |  43.1 |  43.01 |    43 | /griddb_svr/
  44 |  44.1 |  44.01 |    44 | /jdbc_post_svr/
  45 |  45.1 |  45.01 |    45 | /mongo_svr/
  46 |  46.1 |  46.01 |    46 | /mysql_svr/
  47 |  47.1 |  47.01 |    47 | /odbc_mysql_svr/
  48 |  48.1 |  48.01 |    48 | /oracle_svr/
  49 |  49.1 |  49.01 |    49 | /postgres_svr/
  50 |  50.1 |  50.01 |    50 | /sqlite_svr/
  51 |  51.1 |  51.01 |    51 | /tiny_svr/
  52 |  52.1 |  52.01 |    52 | /dynamodb_svr/
  53 |  53.1 |  53.01 |    53 | /griddb_svr/
  54 |  54.1 |  54.01 |    54 | /jdbc_post_svr/
  55 |  55.1 |  55.01 |    55 | /mongo_svr/
  56 |  56.1 |  56.01 |    56 | /mysql_svr/
  57 |  57.1 |  57.01 |    57 | /odbc_mysql_svr/
  58 |  58.1 |  58.01 |    58 | /oracle_svr/
  59 |  59.1 |  59.01 |    59 | /postgres_svr/
  60 |  60.1 |  60.01 |    60 | /sqlite_svr/
  61 |  61.1 |  61.01 |    61 | /tiny_svr/
  62 |  62.1 |  62.01 |    62 | /dynamodb_svr/
  63 |  63.1 |  63.01 |    63 | /griddb_svr/
  64 |  64.1 |  64.01 |    64 | /jdbc_post_svr/
  65 |  65.1 |  65.01 |    65 | /mongo_svr/
  66 |  66.1 |  66.01 |    66 | /mysql_svr/
  67 |  67.1 |  67.01 |    67 | /odbc_mysql_svr/
  68 |  68.1 |  68.01 |    68 | /oracle_svr/
  69 |  69.1 |  69.01 |    69 | /postgres_svr/
  70 |  70.1 |  70.01 |    70 | /sqlite_svr/
  71 |  71.1 |  71.01 |    71 | /tiny_svr/
  72 |  72.1 |  72.01 |    72 | /dynamodb_svr/
  73 |  73.1 |  73.01 |    73 | /griddb_svr/
  74 |  74.1 |  74.01 |    74 | /jdbc_post_svr/
  75 |  75.1 |  75.01 |    75 | /mongo_svr/
  76 |  76.1 |  76.01 |    76 | /mysql_svr/
  77 |  77.1 |  77.01 |    77 | /odbc_mysql_svr/
  78 |  78.1 |  78.01 |    78 | /oracle_svr/
  79 |  79.1 |  79.01 |    79 | /postgres_svr/
  80 |  80.1 |  80.01 |    80 | /sqlite_svr/
  81 |  81.1 |  81.01 |    81 | /tiny_svr/
  82 |  82.1 |  82.01 |    82 | /dynamodb_svr/
  83 |  83.1 |  83.01 |    83 | /griddb_svr/
  84 |  84.1 |  84.01 |    84 | /jdbc_post_svr/
  85 |  85.1 |  85.01 |    85 | /mongo_svr/
  86 |  86.1 |  86.01 |    86 | /mysql_svr/
  87 |  87.1 |  87.01 |    87 | /odbc_mysql_svr/
  88 |  88.1 |  88.01 |    88 | /oracle_svr/
  89 |  89.1 |  89.01 |    89 | /postgres_svr/
  90 |  90.1 |  90.01 |    90 | /sqlite_svr/
  91 |  91.1 |  91.01 |    91 | /tiny_svr/
  92 |  92.1 |  92.01 |    92 | /dynamodb_svr/
  93 |  93.1 |  93.01 |    93 | /griddb_svr/
  94 |  94.1 |  94.01 |    94 | /jdbc_post_svr/
  95 |  95.1 |  95.01 |    95 | /mongo_svr/
  96 |  96.1 |  96.01 |    96 | /mysql_svr/
  97 |  97.1 |  97.01 |    97 | /odbc_mysql_svr/
  98 |  98.1 |  98.01 |    98 | /oracle_svr/
  99 |  99.1 |  99.01 |    99 | /postgres_svr/
 100 | 100.1 | 100.01 |   100 | /sqlite_svr/
(101 rows)

--Testcase 490:
SELECT count(*) FROM tntbl3__dynamodb_svr__0;
 count 
-------
    10
(1 row)

--Testcase 491:
SELECT count(*) FROM tntbl3__griddb_svr__0;
 count 
-------
    10
(1 row)

--Testcase 492:
SELECT count(*) FROM tntbl3__jdbc_post_svr__0;
 count 
-------
    10
(1 row)

--Testcase 493:
SELECT count(*) FROM tntbl3__mongo_svr__0;
 count 
-------
    10
(1 row)

--Testcase 494:
SELECT count(*) FROM tntbl3__mysql_svr__0;
 count 
-------
    10
(1 row)

--Testcase 495:
SELECT count(*) FROM tntbl3__odbc_mysql_svr__0;
 count 
-------
    10
(1 row)

--Testcase 496:
SELECT count(*) FROM tntbl3__oracle_svr__0;
 count 
-------
    10
(1 row)

--Testcase 497:
SELECT count(*) FROM tntbl3__postgres_svr__0;
 count 
-------
    10
(1 row)

--Testcase 498:
SELECT count(*) FROM tntbl3__sqlite_svr__0;
 count 
-------
    10
(1 row)

--Testcase 499:
SELECT count(*) FROM tntbl3__tiny_svr__0;
 count 
-------
    10
(1 row)

--Testcase 500:
SELECT count(*) FROM tntbl3__file_svr__0;
 count 
-------
     1
(1 row)

--Testcase 501:
DELETE FROM tntbl3;
WARNING:  file_fdw will be skipped because it does not support modification
-- ALTER SERVER pgspider_svr OPTIONS (DROP batch_size);
-- batch_size server = 20, batch_size table not set, batch_size of FDW (if support) not set, insert 2200 records
--Testcase 502:
-- ALTER SERVER pgspider_svr OPTIONS (ADD batch_size '20');
--Testcase 503:
INSERT INTO tntbl3
    SELECT ('idTable3_'::text || id),
            id,
            id + 0.1,
            id + 0.01,
            id
    FROM generate_series(1, 2200) id;
WARNING:  file_fdw is ignored as an insert target because it does not support modification
--Testcase 504:
SELECT count(*) FROM tntbl3;
 count 
-------
  2201
(1 row)

--Testcase 505:
SELECT count(*) FROM tntbl3__dynamodb_svr__0;
 count 
-------
   220
(1 row)

--Testcase 506:
SELECT count(*) FROM tntbl3__griddb_svr__0;
 count 
-------
   220
(1 row)

--Testcase 507:
SELECT count(*) FROM tntbl3__jdbc_post_svr__0;
 count 
-------
   220
(1 row)

--Testcase 508:
SELECT count(*) FROM tntbl3__mongo_svr__0;
 count 
-------
   220
(1 row)

--Testcase 509:
SELECT count(*) FROM tntbl3__mysql_svr__0;
 count 
-------
   220
(1 row)

--Testcase 510:
SELECT count(*) FROM tntbl3__odbc_mysql_svr__0;
 count 
-------
   220
(1 row)

--Testcase 511:
SELECT count(*) FROM tntbl3__oracle_svr__0;
 count 
-------
   220
(1 row)

--Testcase 512:
SELECT count(*) FROM tntbl3__postgres_svr__0;
 count 
-------
   220
(1 row)

--Testcase 513:
SELECT count(*) FROM tntbl3__sqlite_svr__0;
 count 
-------
   220
(1 row)

--Testcase 514:
SELECT count(*) FROM tntbl3__tiny_svr__0;
 count 
-------
   220
(1 row)

--Testcase 515:
SELECT count(*) FROM tntbl3__file_svr__0;
 count 
-------
     1
(1 row)

--Testcase 516:
DELETE FROM tntbl3 WHERE c1 < 500;
WARNING:  file_fdw will be skipped because it does not support modification
DELETE FROM tntbl3 WHERE c1 < 1000;
WARNING:  file_fdw will be skipped because it does not support modification
DELETE FROM tntbl3 WHERE c1 < 1500;
WARNING:  file_fdw will be skipped because it does not support modification
DELETE FROM tntbl3;
WARNING:  file_fdw will be skipped because it does not support modification
-- ALTER SERVER pgspider_svr OPTIONS (DROP batch_size);
-- batch_size server = 1, batch_size table = 30, batch_size of FDW (if support) not set, insert 2200 records
--Testcase 517:
-- ALTER SERVER pgspider_svr OPTIONS (ADD batch_size '1');
ALTER FOREIGN TABLE tntbl3__griddb_svr__0 OPTIONS (ADD batch_size '30');
ALTER FOREIGN TABLE tntbl3__mysql_svr__0 OPTIONS (ADD batch_size '30');
ALTER FOREIGN TABLE tntbl3__postgres_svr__0 OPTIONS (ADD batch_size '30');
ALTER FOREIGN TABLE tntbl3__sqlite_svr__0 OPTIONS (ADD batch_size '30');
ALTER FOREIGN TABLE tntbl3__tiny_svr__0 OPTIONS (ADD batch_size '30');
--Testcase 518:
INSERT INTO tntbl3
    SELECT ('idTable3_'::text || id),
            id,
            id + 0.1,
            id + 0.01,
            id
    FROM generate_series(1, 2200) id;
WARNING:  file_fdw is ignored as an insert target because it does not support modification
INFO:  Batch Insert for postgres_fdw, batch size = 30
INFO:  Batch Insert for griddb_fdw, batch size = 30
INFO:  Batch Insert for tinybrace_fdw, batch size = 30
INFO:  Batch Insert for sqlite_fdw, batch size = 30
INFO:  Batch Insert for mysql_fdw, batch size = 30
--Testcase 519:
SELECT count(*) FROM tntbl3;
 count 
-------
  2201
(1 row)

--Testcase 520:
SELECT count(*) FROM tntbl3__dynamodb_svr__0;
 count 
-------
   220
(1 row)

--Testcase 521:
SELECT count(*) FROM tntbl3__griddb_svr__0;
 count 
-------
   220
(1 row)

--Testcase 522:
SELECT count(*) FROM tntbl3__jdbc_post_svr__0;
 count 
-------
   220
(1 row)

--Testcase 523:
SELECT count(*) FROM tntbl3__mongo_svr__0;
 count 
-------
   220
(1 row)

--Testcase 524:
SELECT count(*) FROM tntbl3__mysql_svr__0;
 count 
-------
   220
(1 row)

--Testcase 525:
SELECT count(*) FROM tntbl3__odbc_mysql_svr__0;
 count 
-------
   220
(1 row)

--Testcase 526:
SELECT count(*) FROM tntbl3__oracle_svr__0;
 count 
-------
   220
(1 row)

--Testcase 527:
SELECT count(*) FROM tntbl3__postgres_svr__0;
 count 
-------
   220
(1 row)

--Testcase 528:
SELECT count(*) FROM tntbl3__sqlite_svr__0;
 count 
-------
   220
(1 row)

--Testcase 529:
SELECT count(*) FROM tntbl3__tiny_svr__0;
 count 
-------
   220
(1 row)

--Testcase 530:
SELECT count(*) FROM tntbl3__file_svr__0;
 count 
-------
     1
(1 row)

--Testcase 531:
DELETE FROM tntbl3 WHERE c1 < 500;
WARNING:  file_fdw will be skipped because it does not support modification
DELETE FROM tntbl3 WHERE c1 < 1000;
WARNING:  file_fdw will be skipped because it does not support modification
DELETE FROM tntbl3 WHERE c1 < 1500;
WARNING:  file_fdw will be skipped because it does not support modification
DELETE FROM tntbl3;
WARNING:  file_fdw will be skipped because it does not support modification
--Testcase 532:
-- ALTER SERVER pgspider_svr OPTIONS (DROP batch_size);
ALTER FOREIGN TABLE tntbl3__griddb_svr__0 OPTIONS (DROP batch_size);
ALTER FOREIGN TABLE tntbl3__mysql_svr__0 OPTIONS (DROP batch_size);
ALTER FOREIGN TABLE tntbl3__postgres_svr__0 OPTIONS (DROP batch_size);
ALTER FOREIGN TABLE tntbl3__sqlite_svr__0 OPTIONS (DROP batch_size);
ALTER FOREIGN TABLE tntbl3__tiny_svr__0 OPTIONS (DROP batch_size);
-- Auto config:
-- LCM * number of child node < limit
--Testcase 533:
ALTER SERVER postgres_svr OPTIONS (ADD batch_size '4');
ALTER SERVER sqlite_svr OPTIONS (ADD batch_size '6');
ALTER SERVER tiny_svr OPTIONS (ADD batch_size '10');
ALTER SERVER mysql_svr OPTIONS (ADD batch_size '2');
ALTER SERVER griddb_svr OPTIONS (ADD batch_size '3');
--Testcase 534:
INSERT INTO tntbl3
    SELECT ('idTable3_'::text || id),
            id,
            id + 0.1,
            id + 0.01,
            id
    FROM generate_series(1, 2200) id;
WARNING:  file_fdw is ignored as an insert target because it does not support modification
INFO:  Batch Insert for tinybrace_fdw, batch size = 10
INFO:  Batch Insert for mysql_fdw, batch size = 2
INFO:  Batch Insert for sqlite_fdw, batch size = 6
INFO:  Batch Insert for griddb_fdw, batch size = 3
INFO:  Batch Insert for postgres_fdw, batch size = 4
--Testcase 535:
SELECT count(*) FROM tntbl3;
 count 
-------
  2201
(1 row)

--Testcase 536:
SELECT count(*) FROM tntbl3__dynamodb_svr__0;
 count 
-------
   220
(1 row)

--Testcase 537:
SELECT count(*) FROM tntbl3__griddb_svr__0;
 count 
-------
   220
(1 row)

--Testcase 538:
SELECT count(*) FROM tntbl3__jdbc_post_svr__0;
 count 
-------
   220
(1 row)

--Testcase 539:
SELECT count(*) FROM tntbl3__mongo_svr__0;
 count 
-------
   220
(1 row)

--Testcase 540:
SELECT count(*) FROM tntbl3__mysql_svr__0;
 count 
-------
   220
(1 row)

--Testcase 541:
SELECT count(*) FROM tntbl3__odbc_mysql_svr__0;
 count 
-------
   220
(1 row)

--Testcase 542:
SELECT count(*) FROM tntbl3__oracle_svr__0;
 count 
-------
   220
(1 row)

--Testcase 543:
SELECT count(*) FROM tntbl3__postgres_svr__0;
 count 
-------
   220
(1 row)

--Testcase 544:
SELECT count(*) FROM tntbl3__sqlite_svr__0;
 count 
-------
   220
(1 row)

--Testcase 545:
SELECT count(*) FROM tntbl3__tiny_svr__0;
 count 
-------
   220
(1 row)

--Testcase 546:
SELECT count(*) FROM tntbl3__file_svr__0;
 count 
-------
     1
(1 row)

--Testcase 547:
DELETE FROM tntbl3 WHERE c1 < 500;
WARNING:  file_fdw will be skipped because it does not support modification
DELETE FROM tntbl3 WHERE c1 < 1000;
WARNING:  file_fdw will be skipped because it does not support modification
DELETE FROM tntbl3 WHERE c1 < 1500;
WARNING:  file_fdw will be skipped because it does not support modification
DELETE FROM tntbl3;
WARNING:  file_fdw will be skipped because it does not support modification
--Testcase 548:
ALTER SERVER postgres_svr OPTIONS (DROP batch_size);
ALTER SERVER sqlite_svr OPTIONS (DROP batch_size);
ALTER SERVER tiny_svr OPTIONS (DROP batch_size);
ALTER SERVER mysql_svr OPTIONS (DROP batch_size);
ALTER SERVER griddb_svr OPTIONS (DROP batch_size);
-- LCM * number of child node > limit
--Testcase 549:
ALTER SERVER postgres_svr OPTIONS (ADD batch_size '5');
ALTER SERVER sqlite_svr OPTIONS (ADD batch_size '6');
ALTER SERVER tiny_svr OPTIONS (ADD batch_size '7');
ALTER SERVER mysql_svr OPTIONS (ADD batch_size '23');
ALTER SERVER griddb_svr OPTIONS (ADD batch_size '31');
ALTER FOREIGN TABLE tntbl3__griddb_svr__0 RENAME TO tmp_tntbl3__griddb_svr__0;
ALTER FOREIGN TABLE tntbl3__dynamodb_svr__0 RENAME TO tmp_tntbl3__dynamodb_svr__0;
ALTER FOREIGN TABLE tntbl3__jdbc_post_svr__0 RENAME TO tmp_tntbl3__jdbc_post_svr__0;
ALTER FOREIGN TABLE tntbl3__mongo_svr__0 RENAME TO tmp_tntbl3__mongo_svr__0;
ALTER FOREIGN TABLE tntbl3__odbc_mysql_svr__0 RENAME TO tmp_tntbl3__odbc_mysql_svr__0;
ALTER FOREIGN TABLE tntbl3__oracle_svr__0 RENAME TO tmp_tntbl3__oracle_svr__0;
ALTER FOREIGN TABLE tntbl3__file_svr__0 RENAME TO tmp_tntbl3__file_svr__0;
--Testcase 550:
INSERT INTO tntbl3
    SELECT ('idTable3_'::text || id),
            id,
            id + 0.1,
            id + 0.01,
            id
    FROM generate_series(1, 7000000) id;
INFO:  Batch Insert for tinybrace_fdw, batch size = 7
INFO:  Batch Insert for sqlite_fdw, batch size = 6
INFO:  Batch Insert for mysql_fdw, batch size = 23
INFO:  Batch Insert for postgres_fdw, batch size = 5
ALTER FOREIGN TABLE tmp_tntbl3__griddb_svr__0 RENAME TO tntbl3__griddb_svr__0;
ALTER FOREIGN TABLE tmp_tntbl3__dynamodb_svr__0 RENAME TO tntbl3__dynamodb_svr__0;
ALTER FOREIGN TABLE tmp_tntbl3__jdbc_post_svr__0 RENAME TO tntbl3__jdbc_post_svr__0;
ALTER FOREIGN TABLE tmp_tntbl3__mongo_svr__0 RENAME TO tntbl3__mongo_svr__0;
ALTER FOREIGN TABLE tmp_tntbl3__odbc_mysql_svr__0 RENAME TO tntbl3__odbc_mysql_svr__0;
ALTER FOREIGN TABLE tmp_tntbl3__oracle_svr__0 RENAME TO tntbl3__oracle_svr__0;
ALTER FOREIGN TABLE tmp_tntbl3__file_svr__0 RENAME TO tntbl3__file_svr__0;
--Testcase 551:
SELECT count(*) FROM tntbl3;
  count  
---------
 7000001
(1 row)

--Testcase 552:
SELECT count(*) FROM tntbl3__dynamodb_svr__0;
 count 
-------
     0
(1 row)

--Testcase 553:
SELECT count(*) FROM tntbl3__griddb_svr__0;
 count 
-------
     0
(1 row)

--Testcase 554:
SELECT count(*) FROM tntbl3__jdbc_post_svr__0;
 count 
-------
     0
(1 row)

--Testcase 555:
SELECT count(*) FROM tntbl3__mongo_svr__0;
 count 
-------
(0 rows)

--Testcase 556:
SELECT count(*) FROM tntbl3__mysql_svr__0;
  count  
---------
 1750000
(1 row)

--Testcase 557:
SELECT count(*) FROM tntbl3__odbc_mysql_svr__0;
 count 
-------
     0
(1 row)

--Testcase 558:
SELECT count(*) FROM tntbl3__oracle_svr__0;
 count 
-------
     0
(1 row)

--Testcase 559:
SELECT count(*) FROM tntbl3__postgres_svr__0;
  count  
---------
 1750000
(1 row)

--Testcase 560:
SELECT count(*) FROM tntbl3__sqlite_svr__0;
  count  
---------
 1750000
(1 row)

--Testcase 561:
SELECT count(*) FROM tntbl3__tiny_svr__0;
  count  
---------
 1750000
(1 row)

--Testcase 562:
SELECT count(*) FROM tntbl3__file_svr__0;
 count 
-------
     1
(1 row)

--Testcase 563:
DELETE FROM tntbl3__dynamodb_svr__0;
DELETE FROM tntbl3__griddb_svr__0;
DELETE FROM tntbl3__jdbc_post_svr__0;
DELETE FROM tntbl3__mongo_svr__0;
DELETE FROM tntbl3__mysql_svr__0;
DELETE FROM tntbl3__odbc_mysql_svr__0;
DELETE FROM tntbl3__oracle_svr__0;
DELETE FROM tntbl3__postgres_svr__0;
DELETE FROM tntbl3__sqlite_svr__0;
DELETE FROM tntbl3__tiny_svr__0;
DELETE FROM tntbl3__file_svr__0;
ERROR:  cannot delete from foreign table "tntbl3__file_svr__0"
DELETE FROM tntbl3;
WARNING:  file_fdw will be skipped because it does not support modification
--Testcase 564:
ALTER SERVER postgres_svr OPTIONS (DROP batch_size);
ALTER SERVER sqlite_svr OPTIONS (DROP batch_size);
ALTER SERVER tiny_svr OPTIONS (DROP batch_size);
ALTER SERVER mysql_svr OPTIONS (DROP batch_size);
ALTER SERVER griddb_svr OPTIONS (DROP batch_size);
SET client_min_messages = NOTICE;
-- Test insert routing without batch size
ALTER FOREIGN TABLE tntbl3__file_svr__0 RENAME TO tmp_tntbl3__file_svr__0;
INSERT INTO tntbl3
    SELECT ('idTable3_'::text || id),
            id,
            id + 0.1,
            id + 0.01,
            id
    FROM generate_series(1, 3) id;
SELECT c1, __spd_url FROM tntbl3 ORDER BY c1;
 c1 |   __spd_url    
----+----------------
  1 | /tiny_svr/
  2 | /dynamodb_svr/
  3 | /griddb_svr/
(3 rows)

INSERT INTO tntbl3
    SELECT ('idTable3_'::text || id),
            id,
            id + 0.1,
            id + 0.01,
            id
    FROM generate_series(11, 19) id;
SELECT c1, __spd_url FROM tntbl3 ORDER BY c1;
 c1 |    __spd_url     
----+------------------
  1 | /tiny_svr/
  2 | /dynamodb_svr/
  3 | /griddb_svr/
 11 | /jdbc_post_svr/
 12 | /mongo_svr/
 13 | /mysql_svr/
 14 | /odbc_mysql_svr/
 15 | /oracle_svr/
 16 | /postgres_svr/
 17 | /sqlite_svr/
 18 | /tiny_svr/
 19 | /dynamodb_svr/
(12 rows)

INSERT INTO tntbl3
    SELECT ('idTable3_'::text || id),
            id,
            id + 0.1,
            id + 0.01,
            id
    FROM generate_series(21, 44) id;
SELECT c1, __spd_url FROM tntbl3 ORDER BY c1;
 c1 |    __spd_url     
----+------------------
  1 | /tiny_svr/
  2 | /dynamodb_svr/
  3 | /griddb_svr/
 11 | /jdbc_post_svr/
 12 | /mongo_svr/
 13 | /mysql_svr/
 14 | /odbc_mysql_svr/
 15 | /oracle_svr/
 16 | /postgres_svr/
 17 | /sqlite_svr/
 18 | /tiny_svr/
 19 | /dynamodb_svr/
 21 | /griddb_svr/
 22 | /jdbc_post_svr/
 23 | /mongo_svr/
 24 | /mysql_svr/
 25 | /odbc_mysql_svr/
 26 | /oracle_svr/
 27 | /postgres_svr/
 28 | /sqlite_svr/
 29 | /tiny_svr/
 30 | /dynamodb_svr/
 31 | /griddb_svr/
 32 | /jdbc_post_svr/
 33 | /mongo_svr/
 34 | /mysql_svr/
 35 | /odbc_mysql_svr/
 36 | /oracle_svr/
 37 | /postgres_svr/
 38 | /sqlite_svr/
 39 | /tiny_svr/
 40 | /dynamodb_svr/
 41 | /griddb_svr/
 42 | /jdbc_post_svr/
 43 | /mongo_svr/
 44 | /mysql_svr/
(36 rows)

DELETE FROM tntbl3;
-- Test insert routing with batch size
ALTER SERVER postgres_svr OPTIONS (ADD batch_size '3');
ALTER SERVER sqlite_svr OPTIONS (ADD batch_size '2');
ALTER SERVER tiny_svr OPTIONS (ADD batch_size '1');
ALTER SERVER mysql_svr OPTIONS (ADD batch_size '2');
ALTER SERVER griddb_svr OPTIONS (ADD batch_size '2');
INSERT INTO tntbl3
    SELECT ('idTable3_'::text || id),
            id,
            id + 0.1,
            id + 0.01,
            id
    FROM generate_series(1, 3) id;
INFO:  Batch Insert for postgres_fdw, batch size = 3
SELECT c1, __spd_url FROM tntbl3 ORDER BY c1;
 c1 |    __spd_url     
----+------------------
  1 | /odbc_mysql_svr/
  2 | /oracle_svr/
  3 | /postgres_svr/
(3 rows)

INSERT INTO tntbl3
    SELECT ('idTable3_'::text || id),
            id,
            id + 0.1,
            id + 0.01,
            id
    FROM generate_series(11, 19) id;
INFO:  Batch Insert for mysql_fdw, batch size = 2
INFO:  Batch Insert for griddb_fdw, batch size = 2
INFO:  Batch Insert for sqlite_fdw, batch size = 2
SELECT c1, __spd_url FROM tntbl3 ORDER BY c1;
 c1 |    __spd_url     
----+------------------
  1 | /odbc_mysql_svr/
  2 | /oracle_svr/
  3 | /postgres_svr/
 11 | /sqlite_svr/
 12 | /tiny_svr/
 13 | /dynamodb_svr/
 14 | /griddb_svr/
 15 | /jdbc_post_svr/
 16 | /mongo_svr/
 17 | /mysql_svr/
 18 | /odbc_mysql_svr/
 19 | /oracle_svr/
(12 rows)

INSERT INTO tntbl3
    SELECT ('idTable3_'::text || id),
            id,
            id + 0.1,
            id + 0.01,
            id
    FROM generate_series(21, 44) id;
INFO:  Batch Insert for postgres_fdw, batch size = 3
INFO:  Batch Insert for sqlite_fdw, batch size = 2
INFO:  Batch Insert for mysql_fdw, batch size = 2
INFO:  Batch Insert for griddb_fdw, batch size = 2
SELECT c1, __spd_url FROM tntbl3 ORDER BY c1;
 c1 |    __spd_url     
----+------------------
  1 | /odbc_mysql_svr/
  2 | /oracle_svr/
  3 | /postgres_svr/
 11 | /sqlite_svr/
 12 | /tiny_svr/
 13 | /dynamodb_svr/
 14 | /griddb_svr/
 15 | /jdbc_post_svr/
 16 | /mongo_svr/
 17 | /mysql_svr/
 18 | /odbc_mysql_svr/
 19 | /oracle_svr/
 21 | /postgres_svr/
 22 | /sqlite_svr/
 23 | /tiny_svr/
 24 | /dynamodb_svr/
 25 | /griddb_svr/
 26 | /jdbc_post_svr/
 27 | /mongo_svr/
 28 | /mysql_svr/
 29 | /odbc_mysql_svr/
 30 | /oracle_svr/
 31 | /postgres_svr/
 32 | /sqlite_svr/
 33 | /tiny_svr/
 34 | /dynamodb_svr/
 35 | /griddb_svr/
 36 | /jdbc_post_svr/
 37 | /mongo_svr/
 38 | /mysql_svr/
 39 | /odbc_mysql_svr/
 40 | /oracle_svr/
 41 | /postgres_svr/
 42 | /sqlite_svr/
 43 | /tiny_svr/
 44 | /dynamodb_svr/
(36 rows)

INSERT INTO tntbl3(_id, c1, __spd_url) VALUES ('idTable3_50', 50, '/postgres_svr/'),
                                              ('idTable3_51', 51, NULL),
                                              ('idTable3_52', 52, DEFAULT),
                                              ('idTable3_53', 53, '/no_server/');
ERROR:  There is no candidate 'no_server' for INSERT
INSERT INTO tntbl3(_id, c1, __spd_url) VALUES ('idTable3_54', 54, '/tiny_svr/'),
                                              ('idTable3_55', 55, NULL),
                                              ('idTable3_56', 56, DEFAULT);
INFO:  Batch Insert for griddb_fdw, batch size = 2
INSERT INTO tntbl3(_id, c1, __spd_url) VALUES ('idTable3_57', 57, '/mysql_svr/'),
                                              ('idTable3_58', 58, 'wrong_srv'),
                                              ('idTable3_59', 59, DEFAULT);
ERROR:  Failed to parse URL 'wrong_srv'. The first character should be '/'.
SELECT c1, __spd_url FROM tntbl3 ORDER BY c1;
 c1 |    __spd_url     
----+------------------
  1 | /odbc_mysql_svr/
  2 | /oracle_svr/
  3 | /postgres_svr/
 11 | /sqlite_svr/
 12 | /tiny_svr/
 13 | /dynamodb_svr/
 14 | /griddb_svr/
 15 | /jdbc_post_svr/
 16 | /mongo_svr/
 17 | /mysql_svr/
 18 | /odbc_mysql_svr/
 19 | /oracle_svr/
 21 | /postgres_svr/
 22 | /sqlite_svr/
 23 | /tiny_svr/
 24 | /dynamodb_svr/
 25 | /griddb_svr/
 26 | /jdbc_post_svr/
 27 | /mongo_svr/
 28 | /mysql_svr/
 29 | /odbc_mysql_svr/
 30 | /oracle_svr/
 31 | /postgres_svr/
 32 | /sqlite_svr/
 33 | /tiny_svr/
 34 | /dynamodb_svr/
 35 | /griddb_svr/
 36 | /jdbc_post_svr/
 37 | /mongo_svr/
 38 | /mysql_svr/
 39 | /odbc_mysql_svr/
 40 | /oracle_svr/
 41 | /postgres_svr/
 42 | /sqlite_svr/
 43 | /tiny_svr/
 44 | /dynamodb_svr/
 54 | /tiny_svr/
 55 | /griddb_svr/
 56 | /jdbc_post_svr/
(39 rows)

INSERT INTO tntbl3(_id, c1, __spd_url) VALUES ('idTable3_60', 60, '/tiny_svr/'),
                                              ('idTable3_61', 61, NULL),
                                              ('idTable3_62', 62, '/mysql_svr/'),
                                              ('idTable3_63', 63, '/griddb_svr/'),
                                              ('idTable3_64', 64, DEFAULT),
                                              ('idTable3_65', 65, '/postgres_svr/');
INFO:  Batch Insert for postgres_fdw, batch size = 3
INFO:  Batch Insert for griddb_fdw, batch size = 2
INFO:  Batch Insert for mysql_fdw, batch size = 2
SELECT c1, __spd_url FROM tntbl3 ORDER BY c1;
 c1 |    __spd_url     
----+------------------
  1 | /odbc_mysql_svr/
  2 | /oracle_svr/
  3 | /postgres_svr/
 11 | /sqlite_svr/
 12 | /tiny_svr/
 13 | /dynamodb_svr/
 14 | /griddb_svr/
 15 | /jdbc_post_svr/
 16 | /mongo_svr/
 17 | /mysql_svr/
 18 | /odbc_mysql_svr/
 19 | /oracle_svr/
 21 | /postgres_svr/
 22 | /sqlite_svr/
 23 | /tiny_svr/
 24 | /dynamodb_svr/
 25 | /griddb_svr/
 26 | /jdbc_post_svr/
 27 | /mongo_svr/
 28 | /mysql_svr/
 29 | /odbc_mysql_svr/
 30 | /oracle_svr/
 31 | /postgres_svr/
 32 | /sqlite_svr/
 33 | /tiny_svr/
 34 | /dynamodb_svr/
 35 | /griddb_svr/
 36 | /jdbc_post_svr/
 37 | /mongo_svr/
 38 | /mysql_svr/
 39 | /odbc_mysql_svr/
 40 | /oracle_svr/
 41 | /postgres_svr/
 42 | /sqlite_svr/
 43 | /tiny_svr/
 44 | /dynamodb_svr/
 54 | /tiny_svr/
 55 | /griddb_svr/
 56 | /jdbc_post_svr/
 60 | /tiny_svr/
 61 | /mongo_svr/
 62 | /mysql_svr/
 63 | /griddb_svr/
 64 | /mysql_svr/
 65 | /postgres_svr/
(45 rows)

DELETE FROM tntbl3;
ALTER FOREIGN TABLE tmp_tntbl3__file_svr__0 RENAME TO tntbl3__file_svr__0;
--Clean
DELETE FROM tntbl1;
DELETE FROM tntbl2;
DELETE FROM tntbl3;
WARNING:  file_fdw will be skipped because it does not support modification
DELETE FROM tntbl4;
--Reset data
INSERT INTO tntbl1__oracle_svr__0 VALUES (-20, 0, 1.0, 100.0, 1000, '2022-06-22 14:00:00', '2017-08-07 12:00:00+00', 'char array', 'varchar array');
INSERT INTO tntbl1__postgres_svr__0 VALUES (1, 0, 1.0, 100.0, 1000, '2022-06-22 14:00:00', '2022-06-22 14:00:00+07', 'char array', 'varchar array');
INSERT INTO tntbl1__tiny_svr__0 VALUES (100, 0, 1.0, 100.0, 1000, '2022-06-22 14:00:00', '2022-06-22 14:00:00+07', 'tiny array', 'tiny varchar array');
INSERT INTO tntbl1__sqlite_svr__0 VALUES (1000, 0, 1.0, 100.0, 1000, '2022-06-22 14:00:00', '2022-06-22 14:00:00+07', 'sqlite char array', 'sqlite varchar array');
INSERT INTO tntbl2__mongo_svr__0 (c1, c2, c3, c4, c5) VALUES (1, 'foo', true, -1928.121, 1000);
INSERT INTO tntbl2__mongo_svr__0 (c1, c2, c3, c4, c5) VALUES (2, 'varchar', false, 2000.0, 2000);
INSERT INTO tntbl2__odbc_post_svr__0 VALUES ('odbc', 1, 'odbc text', true, 100.0, 10000);
INSERT INTO tntbl3__mongo_svr__0 (c1, c2) VALUES (1, -19.1);
INSERT INTO tntbl3__mongo_svr__0 (c1, c2) VALUES (2, 20.0);
INSERT INTO tntbl3__postgres_svr__0 VALUES ('text_post_id', 1, 1.0, 100.0, 1000);
INSERT INTO tntbl3__sqlite_svr__0 VALUES ('text_sqlite_id', 1, 1.0, 100.0, 1000);
INSERT INTO tntbl3__tiny_svr__0 VALUES ('text_tiny', 1, 1.0, 100.0, 1000);
INSERT INTO tntbl3__jdbc_post_svr__0 VALUES ('jdbc', 10, 10.0, 1000.0, 10000);
INSERT INTO tntbl4__postgres_svr__0 VALUES (10, 'text', true, 10.0, 1000, 'char array', 'varchar array', -1.0, 12, '2004-10-19 10:23:54', '2004-10-19 10:23:54+02', '2001-01-01', '{"product": "test","quantity": 1}', '{"name": "paintings", "tags": ["Scene", "Portrait"], "finished": true }', '2f404849-f62c-4234-b0c8-e230bd694045', point '(1,-45)', E'\\xa7a8a9aaabacadaeaf', B'1111111111', B'10101', interval '1 year 3 hours 20 minutes');
INSERT INTO tntbl4__postgres_svr_2__0 VALUES (20, 'texttext', false, -10.0, -1000, 'char array', 'varchar array', 1.0, 1, '2005-10-19 10:23:54', '2005-10-19 10:23:54+02', '2001-01-01', '{"product": "sample","quantity": 1}', '{"name": "paintings", "tags": ["Scene", "Portrait"], "finished": false }', '2f404849-f62c-4234-b0c8-e230bd694045', point '(1,-45)', E'\\xa7a8a9aaabacadaeaf', B'1111111111', B'10101', interval '1 year 3 hours 20 minutes');
--Verify data
SELECT * FROM tntbl1 ORDER BY 1, 2, 3;
  c1  | c2 | c3 | c4  |  c5  |         c6          |           c7           |                                                                                                                               c8                                                                                                                                |          c9          |   __spd_url    
------+----+----+-----+------+---------------------+------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------+----------------
  -20 |  0 |  1 | 100 | 1000 | 2022-06-22 14:00:00 | 2017-08-07 12:00:00+00 | char array                                                                                                                                                                                                                                                      | varchar array        | /oracle_svr/
    1 |  0 |  1 | 100 | 1000 | 2022-06-22 14:00:00 | 2022-06-22 07:00:00+00 | char array                                                                                                                                                                                                                                                      | varchar array        | /postgres_svr/
  100 |  0 |  1 | 100 | 1000 | 2022-06-22 14:00:00 | 2022-06-22 07:00:00+00 | tiny array                                                                                                                                                                                                                                                      | tiny varchar array   | /tiny_svr/
 1000 |  0 |  1 | 100 | 1000 | 2022-06-22 14:00:00 | 2022-06-22 07:00:00+00 | sqlite char array                                                                                                                                                                                                                                               | sqlite varchar array | /sqlite_svr/
(4 rows)

SELECT c1, c2, c3, c4, c5, __spd_url FROM tntbl2 ORDER BY 1, 2, 3, 4, 5, 6;
 c1 |    c2     | c3 |    c4     |  c5   |    __spd_url    
----+-----------+----+-----------+-------+-----------------
  1 | foo       | t  | -1928.121 |  1000 | /mongo_svr/
  1 | odbc text | t  |       100 | 10000 | /odbc_post_svr/
  2 | varchar   | f  |      2000 |  2000 | /mongo_svr/
(3 rows)

SELECT c1, c2, c3, c4, __spd_url FROM tntbl3 ORDER BY 1, 2, 3, 4, 5;
 c1 |  c2   |  c3  |  c4   |    __spd_url    
----+-------+------+-------+-----------------
  1 | -19.1 |      |       | /mongo_svr/
  1 |     1 |  100 |  1000 | /postgres_svr/
  1 |     1 |  100 |  1000 | /sqlite_svr/
  1 |     1 |  100 |  1000 | /tiny_svr/
  2 |    20 |      |       | /mongo_svr/
 10 |    10 | 1000 | 10000 | /file_svr/
 10 |    10 | 1000 | 10000 | /jdbc_post_svr/
(7 rows)

SELECT * FROM tntbl4 ORDER BY 1, 2, 3;
 c1 |    c2    | c3 | c4  |  c5   |                                                                                                                               c6                                                                                                                                |      c7       | c8 | c9 |         c10         |          c11           |    c12     |                 c13                 |                                   c14                                   |                 c15                  |   c16   |         c17          |    c18     |  c19  |           c20            |    __spd_url     
----+----------+----+-----+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+----+----+---------------------+------------------------+------------+-------------------------------------+-------------------------------------------------------------------------+--------------------------------------+---------+----------------------+------------+-------+--------------------------+------------------
 10 | text     | t  |  10 |  1000 | char array                                                                                                                                                                                                                                                      | varchar array | -1 | 12 | 2004-10-19 10:23:54 | 2004-10-19 08:23:54+00 | 2001-01-01 | {"product": "test","quantity": 1}   | {"name": "paintings", "tags": ["Scene", "Portrait"], "finished": true}  | 2f404849-f62c-4234-b0c8-e230bd694045 | (1,-45) | \xa7a8a9aaabacadaeaf | 1111111111 | 10101 | @ 1 year 3 hours 20 mins | /postgres_svr/
 20 | texttext | f  | -10 | -1000 | char array                                                                                                                                                                                                                                                      | varchar array |  1 |  1 | 2005-10-19 10:23:54 | 2005-10-19 08:23:54+00 | 2001-01-01 | {"product": "sample","quantity": 1} | {"name": "paintings", "tags": ["Scene", "Portrait"], "finished": false} | 2f404849-f62c-4234-b0c8-e230bd694045 | (1,-45) | \xa7a8a9aaabacadaeaf | 1111111111 | 10101 | @ 1 year 3 hours 20 mins | /postgres_svr_2/
(2 rows)

SELECT * FROM tntbl5 ORDER BY 1, 2, 3;
 c1 |  c2  |  __spd_url   
----+------+--------------
 10 | test | /file_svr/
 40 | foo1 | /file_svr_2/
(2 rows)

--Testcase 464:
DROP FOREIGN TABLE tntbl1 CASCADE;
--Testcase 465:
DROP FOREIGN TABLE tntbl2 CASCADE;
--Testcase 466:
DROP FOREIGN TABLE tntbl3 CASCADE;
--Testcase 467:
DROP FOREIGN TABLE tntbl4 CASCADE;
--Testcase 468:
DROP FOREIGN TABLE tntbl5 CASCADE;
--Testcase 469:
DROP USER MAPPING FOR CURRENT_USER SERVER pgspider_svr;
--Testcase 470:
DROP EXTENSION postgres_fdw CASCADE;
NOTICE:  drop cascades to 10 other objects
DETAIL:  drop cascades to server postgres_svr
drop cascades to user mapping for public on server postgres_svr
drop cascades to foreign table tntbl1__postgres_svr__0
drop cascades to foreign table tntbl3__postgres_svr__0
drop cascades to foreign table tntbl4__postgres_svr__0
drop cascades to server postgres_svr_1
drop cascades to user mapping for public on server postgres_svr_1
drop cascades to server postgres_svr_2
drop cascades to user mapping for public on server postgres_svr_2
drop cascades to foreign table tntbl4__postgres_svr_2__0
--Testcase 471:
DROP EXTENSION sqlite_fdw CASCADE;
NOTICE:  drop cascades to 3 other objects
DETAIL:  drop cascades to server sqlite_svr
drop cascades to foreign table tntbl1__sqlite_svr__0
drop cascades to foreign table tntbl3__sqlite_svr__0
--Testcase 472:
DROP EXTENSION tinybrace_fdw CASCADE;
NOTICE:  drop cascades to 4 other objects
DETAIL:  drop cascades to server tiny_svr
drop cascades to user mapping for public on server tiny_svr
drop cascades to foreign table tntbl1__tiny_svr__0
drop cascades to foreign table tntbl3__tiny_svr__0
--Testcase 473:
DROP EXTENSION griddb_fdw CASCADE;
NOTICE:  drop cascades to 4 other objects
DETAIL:  drop cascades to server griddb_svr
drop cascades to user mapping for public on server griddb_svr
drop cascades to foreign table tntbl2__griddb_svr__0
drop cascades to foreign table tntbl3__griddb_svr__0
--Testcase 474:
DROP EXTENSION oracle_fdw CASCADE;
NOTICE:  drop cascades to 4 other objects
DETAIL:  drop cascades to server oracle_svr
drop cascades to user mapping for public on server oracle_svr
drop cascades to foreign table tntbl1__oracle_svr__0
drop cascades to foreign table tntbl3__oracle_svr__0
--Testcase 475:
DROP EXTENSION odbc_fdw CASCADE;
NOTICE:  drop cascades to 6 other objects
DETAIL:  drop cascades to server odbc_mysql_svr
drop cascades to user mapping for public on server odbc_mysql_svr
drop cascades to foreign table tntbl3__odbc_mysql_svr__0
drop cascades to server odbc_post_svr
drop cascades to user mapping for public on server odbc_post_svr
drop cascades to foreign table tntbl2__odbc_post_svr__0
--Testcase 476:
DROP EXTENSION jdbc_fdw CASCADE;
NOTICE:  drop cascades to 6 other objects
DETAIL:  drop cascades to server jdbc_mysql_svr
drop cascades to user mapping for public on server jdbc_mysql_svr
drop cascades to foreign table tntbl2__jdbc_mysql_svr__0
drop cascades to server jdbc_post_svr
drop cascades to user mapping for public on server jdbc_post_svr
drop cascades to foreign table tntbl3__jdbc_post_svr__0
--Testcase 477:
DROP EXTENSION mysql_fdw CASCADE;
NOTICE:  drop cascades to 4 other objects
DETAIL:  drop cascades to server mysql_svr
drop cascades to user mapping for public on server mysql_svr
drop cascades to foreign table tntbl1__mysql_svr__0
drop cascades to foreign table tntbl3__mysql_svr__0
--Testcase 478:
DROP EXTENSION mongo_fdw CASCADE;
NOTICE:  drop cascades to 4 other objects
DETAIL:  drop cascades to server mongo_svr
drop cascades to user mapping for public on server mongo_svr
drop cascades to foreign table tntbl2__mongo_svr__0
drop cascades to foreign table tntbl3__mongo_svr__0
--Testcase 479:
DROP EXTENSION dynamodb_fdw CASCADE;
NOTICE:  drop cascades to 4 other objects
DETAIL:  drop cascades to server dynamodb_svr
drop cascades to user mapping for public on server dynamodb_svr
drop cascades to foreign table tntbl2__dynamodb_svr__0
drop cascades to foreign table tntbl3__dynamodb_svr__0
--Testcase 480:
DROP EXTENSION file_fdw CASCADE;
NOTICE:  drop cascades to 5 other objects
DETAIL:  drop cascades to server file_svr
drop cascades to foreign table tntbl5__file_svr__0
drop cascades to foreign table tntbl3__file_svr__0
drop cascades to server file_svr_2
drop cascades to foreign table tntbl5__file_svr__2
--Testcase 481:
DROP SERVER pgspider_svr CASCADE;
--Testcase 482:
DROP EXTENSION pgspider_core_fdw CASCADE;
