\set ECHO none
--Testcase 1:
SET datestyle = ISO;
--Testcase 2:
SET timezone = 'UTC';
--Testcase 3:
DELETE FROM pg_spd_node_info;
--Testcase 4:
CREATE EXTENSION pgspider_core_fdw;
--Testcase 5:
CREATE SERVER pgspider_svr FOREIGN DATA WRAPPER pgspider_core_fdw OPTIONS (host :PGSPIDER_SERVER1);
--Testcase 6:
CREATE USER MAPPING FOR CURRENT_USER SERVER pgspider_svr;
--Testcase 7:
CREATE EXTENSION jdbc_fdw;
--Testcase 8:
CREATE SERVER jdbc_mysql_svr FOREIGN DATA WRAPPER jdbc_fdw OPTIONS(
drivername :JDBC_MYSQL_DRIVERNAME,
url :JDBC_MYSQL_URL,
querytimeout '15',
jarfile :JDBC_MYSQL_DRIVERPATH,
maxheapsize '600'
);
--Testcase 32:
CREATE USER MAPPING FOR public SERVER jdbc_mysql_svr OPTIONS(username :JDBC_MYSQL_USER, password :JDBC_MYSQL_PASS);
--Testcase 33:
CREATE SERVER jdbc_post_svr FOREIGN DATA WRAPPER jdbc_fdw OPTIONS(
drivername :JDBC_POSTGRES_DRIVERNAME,
url :JDBC_POSTGRES_URL,
querytimeout '15',
jarfile :JDBC_POSTGRES_DRIVERPATH,
maxheapsize '600'
);
--Testcase 9:
CREATE USER MAPPING FOR public SERVER jdbc_post_svr OPTIONS(username :JDBC_POSTGRES_USER, password :JDBC_POSTGRES_PASS);
-- Create multi tenant tables
-- tntbl3
--Testcase 10:
CREATE FOREIGN TABLE tntbl3 (_id text, c1 int, c2 real, c3 double precision, c4 bigint, __spd_url text) SERVER pgspider_svr;
-- Foreign tables
--Testcase 11:
CREATE FOREIGN TABLE tntbl3__jdbc_mysql_svr__0 (_id text OPTIONS (key 'true'), c1 int, c2 real, c3 double precision, c4 bigint) SERVER jdbc_mysql_svr OPTIONS (table_name 'tntbl3');
CREATE FOREIGN TABLE tntbl3__jdbc_post_svr__0 (_id text OPTIONS (key 'true'), c1 int, c2 real, c3 double precision, c4 bigint) SERVER jdbc_post_svr OPTIONS (table_name 'tntbl3');
-- Reset data of remote table before test
DELETE FROM tntbl3__jdbc_mysql_svr__0;
DELETE FROM tntbl3__jdbc_post_svr__0;
INSERT INTO tntbl3__jdbc_post_svr__0 VALUES ('jdbc', 10, 10.0, 1000.0, 10000);
INSERT INTO tntbl3__jdbc_mysql_svr__0 VALUES ('jdbc_mysql', 10, 10.0, 1000.0, 10000);
SELECT * FROM tntbl3 ORDER BY c1, _id;
    _id     | c1 | c2 |  c3  |  c4   |    __spd_url     
------------+----+----+------+-------+------------------
 jdbc       | 10 | 10 | 1000 | 10000 | /jdbc_post_svr/
 jdbc_mysql | 10 | 10 | 1000 | 10000 | /jdbc_mysql_svr/
(2 rows)

-----------------------------------------------------------------------------------
-- *** Start test for tntbl3 *** --
--
-- INSERT
-- insert with DEFAULT in the target_list
--
--Testcase 198:
Set pgspider_core_fdw.throw_error_ifdead to false;
INSERT INTO tntbl3 (_id, c1, c2, c3, c4) VALUES ('@', DEFAULT, DEFAULT, DEFAULT, DEFAULT);
--Testcase 199:
INSERT INTO tntbl3 (_id, c2, c3) VALUES ('_3', 3.0, DEFAULT);
--Testcase 200:
INSERT INTO tntbl3 (_id, c1, c2, c3) VALUES ('_4', DEFAULT, 5.0, DEFAULT);
--Testcase 201:
INSERT INTO tntbl3 VALUES ('test1', DEFAULT, 5.0, 600.0, 1000);
--Testcase 202:
INSERT INTO tntbl3 VALUES ('test2', DEFAULT, 7.0);
--Testcase 203:
SELECT * FROM tntbl3 ORDER BY c1, _id;
    _id     | c1 | c2 |  c3  |  c4   |    __spd_url     
------------+----+----+------+-------+------------------
 jdbc       | 10 | 10 | 1000 | 10000 | /jdbc_post_svr/
 jdbc_mysql | 10 | 10 | 1000 | 10000 | /jdbc_mysql_svr/
 @          |    |    |      |       | /jdbc_mysql_svr/
 _3         |    |  3 |      |       | /jdbc_post_svr/
 _4         |    |  5 |      |       | /jdbc_mysql_svr/
 test1      |    |  5 |  600 |  1000 | /jdbc_post_svr/
 test2      |    |  7 |      |       | /jdbc_mysql_svr/
(7 rows)

--
-- insert with similar expression / target_list VALUES (all fail)
--
--Testcase 204:
INSERT INTO tntbl3 (_id, c1, c2, c3) VALUES ('wrong1', DEFAULT, DEFAULT);
ERROR:  INSERT has more target columns than expressions
LINE 1: INSERT INTO tntbl3 (_id, c1, c2, c3) VALUES ('wrong1', DEFAU...
                                         ^
--Testcase 205:
INSERT INTO tntbl3 (_id, c1, c2, c3) VALUES ('wrong2', 1, 2.0);
ERROR:  INSERT has more target columns than expressions
LINE 1: INSERT INTO tntbl3 (_id, c1, c2, c3) VALUES ('wrong2', 1, 2....
                                         ^
--Testcase 206:
INSERT INTO tntbl3 (_id, c1) VALUES ('wrong3', 1, 2);
ERROR:  INSERT has more expressions than target columns
LINE 1: INSERT INTO tntbl3 (_id, c1) VALUES ('wrong3', 1, 2);
                                                          ^
--Testcase 207:
INSERT INTO tntbl3 (_id, c1) VALUES ('wrong4',DEFAULT, DEFAULT);
ERROR:  INSERT has more expressions than target columns
LINE 1: ...RT INTO tntbl3 (_id, c1) VALUES ('wrong4',DEFAULT, DEFAULT);
                                                              ^
--Testcase 208:
SELECT * FROM tntbl3 ORDER BY c1, _id;
    _id     | c1 | c2 |  c3  |  c4   |    __spd_url     
------------+----+----+------+-------+------------------
 jdbc       | 10 | 10 | 1000 | 10000 | /jdbc_post_svr/
 jdbc_mysql | 10 | 10 | 1000 | 10000 | /jdbc_mysql_svr/
 @          |    |    |      |       | /jdbc_mysql_svr/
 _3         |    |  3 |      |       | /jdbc_post_svr/
 _4         |    |  5 |      |       | /jdbc_mysql_svr/
 test1      |    |  5 |  600 |  1000 | /jdbc_post_svr/
 test2      |    |  7 |      |       | /jdbc_mysql_svr/
(7 rows)

--
-- VALUES test
--
--Testcase 209:
INSERT INTO tntbl3 VALUES('test3', 10, 2.0, 20.0, 2000), ('test4', -1, 2.0, DEFAULT, 3000),
    ((SELECT 'test5'), (SELECT 90), (SELECT i FROM (VALUES(3.0)) as foo (i)), 30.0, 4000);
--Testcase 210:
SELECT * FROM tntbl3 ORDER BY c1, _id;
    _id     | c1 | c2 |  c3  |  c4   |    __spd_url     
------------+----+----+------+-------+------------------
 test4      | -1 |  2 |      |  3000 | /jdbc_mysql_svr/
 jdbc       | 10 | 10 | 1000 | 10000 | /jdbc_post_svr/
 jdbc_mysql | 10 | 10 | 1000 | 10000 | /jdbc_mysql_svr/
 test3      | 10 |  2 |   20 |  2000 | /jdbc_post_svr/
 test5      | 90 |  3 |   30 |  4000 | /jdbc_post_svr/
 @          |    |    |      |       | /jdbc_mysql_svr/
 _3         |    |  3 |      |       | /jdbc_post_svr/
 _4         |    |  5 |      |       | /jdbc_mysql_svr/
 test1      |    |  5 |  600 |  1000 | /jdbc_post_svr/
 test2      |    |  7 |      |       | /jdbc_mysql_svr/
(10 rows)

--
-- TOASTed value test
--
--Testcase 211:
INSERT INTO tntbl3 VALUES(repeat('x', 25), 20, 4.0, 40.0, 5000);
--Testcase 212:
SELECT c1, c2, _id FROM tntbl3 ORDER BY c1, _id;
 c1 | c2 |            _id            
----+----+---------------------------
 -1 |  2 | test4
 10 | 10 | jdbc
 10 | 10 | jdbc_mysql
 10 |  2 | test3
 20 |  4 | xxxxxxxxxxxxxxxxxxxxxxxxx
 90 |  3 | test5
    |    | @
    |  3 | _3
    |  5 | _4
    |  5 | test1
    |  7 | test2
(11 rows)

--
-- INSERT with IN feature
--
--Testcase 213:
INSERT INTO tntbl3 IN ('/sqlite_svr/') VALUES ('_test', 10, 5.0, 50.0, 5000);
ERROR:  There is no candidate for INSERT.
--Testcase 214:
INSERT INTO tntbl3 IN ('/dynamodb_svr/', '/mongo_svr/', '/griddb_svr/', '/mysql_svr/', '/postgres_svr/', '/postgres_svr_1/') VALUES ('_infea', 20, 6.0, 60.0, 6000);
ERROR:  There is no candidate for INSERT.
--
-- UPDATE
--
--Testcase 215:
SELECT _id, c1, c2, c3, c4 FROM tntbl3 ORDER BY c1, _id;
            _id            | c1 | c2 |  c3  |  c4   
---------------------------+----+----+------+-------
 test4                     | -1 |  2 |      |  3000
 jdbc                      | 10 | 10 | 1000 | 10000
 jdbc_mysql                | 10 | 10 | 1000 | 10000
 test3                     | 10 |  2 |   20 |  2000
 xxxxxxxxxxxxxxxxxxxxxxxxx | 20 |  4 |   40 |  5000
 test5                     | 90 |  3 |   30 |  4000
 @                         |    |    |      |      
 _3                        |    |  3 |      |      
 _4                        |    |  5 |      |      
 test1                     |    |  5 |  600 |  1000
 test2                     |    |  7 |      |      
(11 rows)

--Testcase 216:
UPDATE tntbl3 SET c3 = DEFAULT, c4 = DEFAULT;
--Testcase 217:
SELECT _id, c1, c2, c3, c4 FROM tntbl3 ORDER BY c1, _id;
            _id            | c1 | c2 | c3 | c4 
---------------------------+----+----+----+----
 test4                     | -1 |  2 |    |   
 jdbc                      | 10 | 10 |    |   
 jdbc_mysql                | 10 | 10 |    |   
 test3                     | 10 |  2 |    |   
 xxxxxxxxxxxxxxxxxxxxxxxxx | 20 |  4 |    |   
 test5                     | 90 |  3 |    |   
 @                         |    |    |    |   
 _3                        |    |  3 |    |   
 _4                        |    |  5 |    |   
 test1                     |    |  5 |    |   
 test2                     |    |  7 |    |   
(11 rows)

-- aliases for the UPDATE target table
--Testcase 218:
UPDATE tntbl3 AS t SET c1 = 10 WHERE t.c2 = 2.0;
--Testcase 219:
SELECT _id, c1, c2, c3, c4 FROM tntbl3 ORDER BY c1, _id;
            _id            | c1 | c2 | c3 | c4 
---------------------------+----+----+----+----
 jdbc                      | 10 | 10 |    |   
 jdbc_mysql                | 10 | 10 |    |   
 test3                     | 10 |  2 |    |   
 test4                     | 10 |  2 |    |   
 xxxxxxxxxxxxxxxxxxxxxxxxx | 20 |  4 |    |   
 test5                     | 90 |  3 |    |   
 @                         |    |    |    |   
 _3                        |    |  3 |    |   
 _4                        |    |  5 |    |   
 test1                     |    |  5 |    |   
 test2                     |    |  7 |    |   
(11 rows)

--Testcase 220:
UPDATE tntbl3 t SET c1 = t.c1 + 10 WHERE t.c2 = 4.0;
--Testcase 221:
SELECT _id, c1, c2, c3, c4 FROM tntbl3 ORDER BY c1, _id;
            _id            | c1 | c2 | c3 | c4 
---------------------------+----+----+----+----
 jdbc                      | 10 | 10 |    |   
 jdbc_mysql                | 10 | 10 |    |   
 test3                     | 10 |  2 |    |   
 test4                     | 10 |  2 |    |   
 xxxxxxxxxxxxxxxxxxxxxxxxx | 30 |  4 |    |   
 test5                     | 90 |  3 |    |   
 @                         |    |    |    |   
 _3                        |    |  3 |    |   
 _4                        |    |  5 |    |   
 test1                     |    |  5 |    |   
 test2                     |    |  7 |    |   
(11 rows)

--
-- Test VALUES in FROM
--
--Testcase 222:
UPDATE tntbl3 SET c1=v.i FROM (VALUES(100, 5)) AS v(i, j)
  WHERE tntbl3.c1 = v.j;
--Testcase 223:
SELECT _id, c1, c2, c3, c4 FROM tntbl3 ORDER BY c1, _id;
            _id            | c1 | c2 | c3 | c4 
---------------------------+----+----+----+----
 jdbc                      | 10 | 10 |    |   
 jdbc_mysql                | 10 | 10 |    |   
 test3                     | 10 |  2 |    |   
 test4                     | 10 |  2 |    |   
 xxxxxxxxxxxxxxxxxxxxxxxxx | 30 |  4 |    |   
 test5                     | 90 |  3 |    |   
 @                         |    |    |    |   
 _3                        |    |  3 |    |   
 _4                        |    |  5 |    |   
 test1                     |    |  5 |    |   
 test2                     |    |  7 |    |   
(11 rows)

-- fail, wrong data type:
--Testcase 224:
UPDATE tntbl3 SET c1 = v.* FROM (VALUES(100, 2000)) AS v(i, j)
  WHERE tntbl3.c4 = v.j;
ERROR:  column "c1" is of type integer but expression is of type record
LINE 1: UPDATE tntbl3 SET c1 = v.* FROM (VALUES(100, 2000)) AS v(i, ...
                               ^
HINT:  You will need to rewrite or cast the expression.
--
-- Test multiple-set-clause syntax
--
--Testcase 225:
-- Commmented, fail due to oracle_fdw. Not reported yet.
INSERT INTO tntbl3 (SELECT _id || '1', c1 + 1, c2 + 1, c3 FROM tntbl3 ORDER BY 1, 2, 3);
--Testcase 226:
SELECT _id, c1, c2, c3, c4 FROM tntbl3 ORDER BY c1, _id;
            _id             | c1 | c2 | c3 | c4 
----------------------------+----+----+----+----
 jdbc                       | 10 | 10 |    |   
 jdbc_mysql                 | 10 | 10 |    |   
 test3                      | 10 |  2 |    |   
 test4                      | 10 |  2 |    |   
 jdbc1                      | 11 | 11 |    |   
 jdbc_mysql1                | 11 | 11 |    |   
 test31                     | 11 |  3 |    |   
 test41                     | 11 |  3 |    |   
 xxxxxxxxxxxxxxxxxxxxxxxxx  | 30 |  4 |    |   
 xxxxxxxxxxxxxxxxxxxxxxxxx1 | 31 |  5 |    |   
 test5                      | 90 |  3 |    |   
 test51                     | 91 |  4 |    |   
 @                          |    |    |    |   
 @1                         |    |    |    |   
 _3                         |    |  3 |    |   
 _31                        |    |  4 |    |   
 _4                         |    |  5 |    |   
 _41                        |    |  6 |    |   
 test1                      |    |  5 |    |   
 test11                     |    |  6 |    |   
 test2                      |    |  7 |    |   
 test21                     |    |  8 |    |   
(22 rows)

--Testcase 227:
UPDATE tntbl3 SET (_id, c1, c2) = ('bugle', c1 + 11, DEFAULT) WHERE c2 = 8.0;
--Testcase 228:
SELECT _id, c1, c2, c3, c4 FROM tntbl3 ORDER BY c1, _id;
            _id             | c1 | c2 | c3 | c4 
----------------------------+----+----+----+----
 jdbc                       | 10 | 10 |    |   
 jdbc_mysql                 | 10 | 10 |    |   
 test3                      | 10 |  2 |    |   
 test4                      | 10 |  2 |    |   
 jdbc1                      | 11 | 11 |    |   
 jdbc_mysql1                | 11 | 11 |    |   
 test31                     | 11 |  3 |    |   
 test41                     | 11 |  3 |    |   
 xxxxxxxxxxxxxxxxxxxxxxxxx  | 30 |  4 |    |   
 xxxxxxxxxxxxxxxxxxxxxxxxx1 | 31 |  5 |    |   
 test5                      | 90 |  3 |    |   
 test51                     | 91 |  4 |    |   
 @                          |    |    |    |   
 @1                         |    |    |    |   
 _3                         |    |  3 |    |   
 _31                        |    |  4 |    |   
 _4                         |    |  5 |    |   
 _41                        |    |  6 |    |   
 bugle                      |    |    |    |   
 test1                      |    |  5 |    |   
 test11                     |    |  6 |    |   
 test2                      |    |  7 |    |   
(22 rows)

--Testcase 229:
UPDATE tntbl3 SET (_id, c3) = (_id || 'car1', c2 + c3), c1 = c1 + 1 WHERE c1 = 10;
--Testcase 230:
SELECT _id, c1, c2, c3, c4 FROM tntbl3 ORDER BY c1, _id;
            _id             | c1 | c2 | c3 | c4 
----------------------------+----+----+----+----
 jdbc1                      | 11 | 11 |    |   
 jdbccar1                   | 11 | 10 |    |   
 jdbc_mysql1                | 11 | 11 |    |   
 jdbc_mysqlcar1             | 11 | 10 |    |   
 test31                     | 11 |  3 |    |   
 test3car1                  | 11 |  2 |    |   
 test41                     | 11 |  3 |    |   
 test4car1                  | 11 |  2 |    |   
 xxxxxxxxxxxxxxxxxxxxxxxxx  | 30 |  4 |    |   
 xxxxxxxxxxxxxxxxxxxxxxxxx1 | 31 |  5 |    |   
 test5                      | 90 |  3 |    |   
 test51                     | 91 |  4 |    |   
 @                          |    |    |    |   
 @1                         |    |    |    |   
 _3                         |    |  3 |    |   
 _31                        |    |  4 |    |   
 _4                         |    |  5 |    |   
 _41                        |    |  6 |    |   
 bugle                      |    |    |    |   
 test1                      |    |  5 |    |   
 test11                     |    |  6 |    |   
 test2                      |    |  7 |    |   
(22 rows)

-- fail, multi assignment to same column:
--Testcase 231:
UPDATE tntbl3 SET (_id, c2) = ('car2', c2 + c3), c2 = c1 + 1 WHERE c4 = 3000;
ERROR:  multiple assignments to same column "c2"
-- uncorrelated sub-SELECT:
--Testcase 232:
UPDATE tntbl3
  SET (c2, c3) = (SELECT c3, c2 FROM tntbl3 where c1 = 11 and _id = 'jdbccar1')
  WHERE c2 = 2.0 AND c3 = 20.0;
--Testcase 233:
SELECT _id, c1, c2, c3, c4 FROM tntbl3 ORDER BY c1, _id;
            _id             | c1 | c2 | c3 | c4 
----------------------------+----+----+----+----
 jdbc1                      | 11 | 11 |    |   
 jdbccar1                   | 11 | 10 |    |   
 jdbc_mysql1                | 11 | 11 |    |   
 jdbc_mysqlcar1             | 11 | 10 |    |   
 test31                     | 11 |  3 |    |   
 test3car1                  | 11 |  2 |    |   
 test41                     | 11 |  3 |    |   
 test4car1                  | 11 |  2 |    |   
 xxxxxxxxxxxxxxxxxxxxxxxxx  | 30 |  4 |    |   
 xxxxxxxxxxxxxxxxxxxxxxxxx1 | 31 |  5 |    |   
 test5                      | 90 |  3 |    |   
 test51                     | 91 |  4 |    |   
 @                          |    |    |    |   
 @1                         |    |    |    |   
 _3                         |    |  3 |    |   
 _31                        |    |  4 |    |   
 _4                         |    |  5 |    |   
 _41                        |    |  6 |    |   
 bugle                      |    |    |    |   
 test1                      |    |  5 |    |   
 test11                     |    |  6 |    |   
 test2                      |    |  7 |    |   
(22 rows)

-- correlated sub-SELECT:
--Testcase 234:
UPDATE tntbl3 o
  SET (c2, c3) = (SELECT c3+1, c2 FROM tntbl3 i
               where i.c3 = o.c3 and i.c2 = o.c2 and i.c1 is not distinct FROM o.c1);
--Testcase 235:
SELECT _id, c1, c2, c3, c4 FROM tntbl3 ORDER BY c1, _id;
            _id             | c1 | c2 | c3 | c4 
----------------------------+----+----+----+----
 jdbc1                      | 11 |    |    |   
 jdbccar1                   | 11 |    |    |   
 jdbc_mysql1                | 11 |    |    |   
 jdbc_mysqlcar1             | 11 |    |    |   
 test31                     | 11 |    |    |   
 test3car1                  | 11 |    |    |   
 test41                     | 11 |    |    |   
 test4car1                  | 11 |    |    |   
 xxxxxxxxxxxxxxxxxxxxxxxxx  | 30 |    |    |   
 xxxxxxxxxxxxxxxxxxxxxxxxx1 | 31 |    |    |   
 test5                      | 90 |    |    |   
 test51                     | 91 |    |    |   
 @                          |    |    |    |   
 @1                         |    |    |    |   
 _3                         |    |    |    |   
 _31                        |    |    |    |   
 _4                         |    |    |    |   
 _41                        |    |    |    |   
 bugle                      |    |    |    |   
 test1                      |    |    |    |   
 test11                     |    |    |    |   
 test2                      |    |    |    |   
(22 rows)

-- fail, multiple rows supplied:
--Testcase 236:
UPDATE tntbl3 SET (c3, c2) = (SELECT c2 + 1 , c3 FROM tntbl3);
ERROR:  more than one row returned by a subquery used as an expression
-- set to null if no rows supplied:
--Testcase 237:
UPDATE tntbl3 SET (c3, c2) = (SELECT c2 + 1, c3 FROM tntbl3 where c4 = 1000)
  WHERE c1 = 11;
--Testcase 238:
SELECT _id, c1, c2, c3, c4 FROM tntbl3 ORDER BY c1, _id;
            _id             | c1 | c2 | c3 | c4 
----------------------------+----+----+----+----
 jdbc1                      | 11 |    |    |   
 jdbccar1                   | 11 |    |    |   
 jdbc_mysql1                | 11 |    |    |   
 jdbc_mysqlcar1             | 11 |    |    |   
 test31                     | 11 |    |    |   
 test3car1                  | 11 |    |    |   
 test41                     | 11 |    |    |   
 test4car1                  | 11 |    |    |   
 xxxxxxxxxxxxxxxxxxxxxxxxx  | 30 |    |    |   
 xxxxxxxxxxxxxxxxxxxxxxxxx1 | 31 |    |    |   
 test5                      | 90 |    |    |   
 test51                     | 91 |    |    |   
 @                          |    |    |    |   
 @1                         |    |    |    |   
 _3                         |    |    |    |   
 _31                        |    |    |    |   
 _4                         |    |    |    |   
 _41                        |    |    |    |   
 bugle                      |    |    |    |   
 test1                      |    |    |    |   
 test11                     |    |    |    |   
 test2                      |    |    |    |   
(22 rows)

-- *-expansion should work in this context:
--Testcase 239:
UPDATE tntbl3 SET (c1, c3) = ROW(v.*) FROM (VALUES(11, 20)) AS v(i, j)
  WHERE tntbl3.c1 = v.i;
-- you might expect this to work, but syntactically it's not a RowExpr:
--Testcase 240:
UPDATE tntbl3 SET (c1, c3) = (v.*) FROM (VALUES(11, 20)) AS v(i, j)
  WHERE tntbl3.c1 = v.i;
ERROR:  source for a multiple-column UPDATE item must be a sub-SELECT or ROW() expression
LINE 1: UPDATE tntbl3 SET (c1, c3) = (v.*) FROM (VALUES(11, 20)) AS ...
                                      ^
-- if an alias for the target table is specified, don't allow references
-- to the original table name
--Testcase 241:
UPDATE tntbl3 AS t SET c1 = tntbl3.c1 + 10 WHERE t.c2 = 2.0;
ERROR:  invalid reference to FROM-clause entry for table "tntbl3"
LINE 1: UPDATE tntbl3 AS t SET c1 = tntbl3.c1 + 10 WHERE t.c2 = 2.0;
                                    ^
HINT:  Perhaps you meant to reference the table alias "t".
-- Make sure that we can update to a TOASTed value.
--Testcase 242:
UPDATE tntbl3 SET _id = repeat('x', 25) WHERE c1 = 20 and c2 = 41;
--Testcase 243:
SELECT c1, c2, _id FROM tntbl3 ORDER BY c1, _id;
 c1 | c2 |            _id             
----+----+----------------------------
 11 |    | jdbc1
 11 |    | jdbccar1
 11 |    | jdbc_mysql1
 11 |    | jdbc_mysqlcar1
 11 |    | test31
 11 |    | test3car1
 11 |    | test41
 11 |    | test4car1
 30 |    | xxxxxxxxxxxxxxxxxxxxxxxxx
 31 |    | xxxxxxxxxxxxxxxxxxxxxxxxx1
 90 |    | test5
 91 |    | test51
    |    | @
    |    | @1
    |    | _3
    |    | _31
    |    | _4
    |    | _41
    |    | bugle
    |    | test1
    |    | test11
    |    | test2
(22 rows)

-- Check multi-assignment with a Result node to handle a one-time filter.
--Testcase 244:
EXPLAIN (VERBOSE, COSTS OFF)
UPDATE tntbl3 t
  SET (c2, c3) = (SELECT c3, c2 FROM tntbl3 s WHERE s.c2 = t.c2)
  WHERE CURRENT_USER = SESSION_USER;
                                                      QUERY PLAN                                                       
-----------------------------------------------------------------------------------------------------------------------
 Update on public.tntbl3 t
   Node: jdbc_mysql_svr / Status: Alive
     Remote SQL: UPDATE tntbl3 SET c2 = ?, c3 = ? WHERE _id=?
   Node: jdbc_post_svr / Status: Alive
     Remote SQL: UPDATE tntbl3 SET c2 = ?, c3 = ? WHERE _id=?
   ->  Result
         Output: (($1)::real), (($2)::double precision), ((SubPlan 1 (returns $1,$2))), t._id, t._id, t.__spd_url, t.*
         One-Time Filter: (CURRENT_USER = SESSION_USER)
         ->  Foreign Scan on public.tntbl3 t
               Output: $1, $2, (SubPlan 1 (returns $1,$2)), t._id, t._id, t.__spd_url, t.*
               Filter: (CURRENT_USER = SESSION_USER)
               Node: jdbc_mysql_svr / Status: Alive
                 Remote SQL: SELECT _id, c1, c2, c3, c4 FROM tntbl3
               Node: jdbc_post_svr / Status: Alive
                 Remote SQL: SELECT _id, c1, c2, c3, c4 FROM tntbl3
               SubPlan 1 (returns $1,$2)
                 ->  Foreign Scan on public.tntbl3 s
                       Output: s.c3, s.c2
                       Filter: (s.c2 = t.c2)
                       Node: jdbc_mysql_svr / Status: Alive
                         Remote SQL: SELECT c2, c3 FROM tntbl3
                       Node: jdbc_post_svr / Status: Alive
                         Remote SQL: SELECT c2, c3 FROM tntbl3
(23 rows)

--Testcase 245:
UPDATE tntbl3 t
  SET (c2, c3) = (SELECT c3, c2 FROM tntbl3 s WHERE s.c2 = t.c2)
  WHERE CURRENT_USER = SESSION_USER;
--Testcase 246:
SELECT _id, c1, c2, c3, c4 FROM tntbl3 ORDER BY _id, c1;
            _id             | c1 | c2 | c3 | c4 
----------------------------+----+----+----+----
 @                          |    |    |    |   
 @1                         |    |    |    |   
 _3                         |    |    |    |   
 _31                        |    |    |    |   
 _4                         |    |    |    |   
 _41                        |    |    |    |   
 bugle                      |    |    |    |   
 jdbc1                      | 11 |    |    |   
 jdbccar1                   | 11 |    |    |   
 jdbc_mysql1                | 11 |    |    |   
 jdbc_mysqlcar1             | 11 |    |    |   
 test1                      |    |    |    |   
 test11                     |    |    |    |   
 test2                      |    |    |    |   
 test31                     | 11 |    |    |   
 test3car1                  | 11 |    |    |   
 test41                     | 11 |    |    |   
 test4car1                  | 11 |    |    |   
 test5                      | 90 |    |    |   
 test51                     | 91 |    |    |   
 xxxxxxxxxxxxxxxxxxxxxxxxx  | 30 |    |    |   
 xxxxxxxxxxxxxxxxxxxxxxxxx1 | 31 |    |    |   
(22 rows)

--
-- UPDATE with IN feature
--
--Testcase 247:
UPDATE tntbl3 IN ('/jdbc_mysql_svr/') SET c3 = 56563.0;
--Testcase 248:
UPDATE tntbl3 IN ('/jdbc_post_svr/', '/odbc_mysql_svr/', '/oracle_svr/') SET c3 = 222.0;
--
-- DELETE
--
-- allow an alias to be specified for DELETE's target table
--Testcase 249:
DELETE FROM tntbl3 AS dt WHERE dt.c1 > 35;
-- if an alias is specified, don't allow the original table name
-- to be referenced
--Testcase 250:
DELETE FROM tntbl3 dt WHERE tntbl3.c1 > 25;
ERROR:  invalid reference to FROM-clause entry for table "tntbl3"
LINE 1: DELETE FROM tntbl3 dt WHERE tntbl3.c1 > 25;
                                    ^
HINT:  Perhaps you meant to reference the table alias "dt".
--Testcase 251:
SELECT c1, c3, _id FROM tntbl3 ORDER BY c1, c3, _id;
 c1 |  c3   |            _id             
----+-------+----------------------------
 11 |   222 | jdbccar1
 11 |   222 | jdbc_mysql1
 11 |   222 | test3car1
 11 |   222 | test41
 11 | 56563 | jdbc1
 11 | 56563 | jdbc_mysqlcar1
 11 | 56563 | test31
 11 | 56563 | test4car1
 30 | 56563 | xxxxxxxxxxxxxxxxxxxxxxxxx
 31 |   222 | xxxxxxxxxxxxxxxxxxxxxxxxx1
    |   222 | @1
    |   222 | _3
    |   222 | _41
    |   222 | bugle
    |   222 | test1
    | 56563 | @
    | 56563 | _31
    | 56563 | _4
    | 56563 | test11
    | 56563 | test2
(20 rows)

-- delete a row with a TOASTed value
--Testcase 252:
DELETE FROM tntbl3 WHERE c1 > 10;
--Testcase 253:
SELECT c1, c3, _id FROM tntbl3 ORDER BY c1, _id;
 c1 |  c3   |  _id   
----+-------+--------
    | 56563 | @
    |   222 | @1
    |   222 | _3
    | 56563 | _31
    | 56563 | _4
    |   222 | _41
    |   222 | bugle
    |   222 | test1
    | 56563 | test11
    | 56563 | test2
(10 rows)

--
-- DELETE with IN feature
--
--Testcase 254:
DELETE FROM tntbl3 IN ('/jdbc_mysql_svr/') WHERE c1 = 10;
--Testcase 255:
DELETE FROM tntbl3 IN ('/dynamodb_svr/', '/odbc_mysql_svr/', '/griddb_svr/', '/oracle_svr/', '/tiny_svr/') WHERE c4 = 3000;
ERROR:  No child node support modification.
--
-- Check behavior of disable_transaction_feature_check
--
-- Check value of disable_transaction_feature_check
--Testcase 70:
ALTER FOREIGN TABLE tntbl3 OPTIONS (disable_transaction_feature_check 'false');
--Testcase 348:
INSERT INTO tntbl3 (_id, c1, c2, c3, c4) VALUES ('_20', DEFAULT, DEFAULT, DEFAULT, DEFAULT);
ERROR:  Child node jdbc_mysql_svr does not support transaction.
--Testcase 349:
INSERT INTO tntbl3 (_id, c2, c3) VALUES ('_30', 3.0, DEFAULT);
ERROR:  Child node jdbc_mysql_svr does not support transaction.
--Testcase 350:
INSERT INTO tntbl3 VALUES(repeat('x', 10), 20, 4.0, 40.0, 5000);
ERROR:  Child node jdbc_mysql_svr does not support transaction.
--Testcase 351:
SELECT * FROM tntbl3 ORDER BY c1, _id;
  _id   | c1 | c2 |  c3   | c4 |    __spd_url     
--------+----+----+-------+----+------------------
 @      |    |    | 56563 |    | /jdbc_mysql_svr/
 @1     |    |    |   222 |    | /jdbc_post_svr/
 _3     |    |    |   222 |    | /jdbc_post_svr/
 _31    |    |    | 56563 |    | /jdbc_mysql_svr/
 _4     |    |    | 56563 |    | /jdbc_mysql_svr/
 _41    |    |    |   222 |    | /jdbc_post_svr/
 bugle  |    |    |   222 |    | /jdbc_post_svr/
 test1  |    |    |   222 |    | /jdbc_post_svr/
 test11 |    |    | 56563 |    | /jdbc_mysql_svr/
 test2  |    |    | 56563 |    | /jdbc_mysql_svr/
(10 rows)

--Testcase 352:
INSERT INTO tntbl3 IN ('/dynamodb_svr/', '/mongo_svr/', '/griddb_svr/', '/mysql_svr/', '/postgres_svr/', '/postgres_svr_1/') VALUES ('_infea', 20, 6.0, 60.0, 6000);
ERROR:  There is no candidate for INSERT.
--Testcase 353:
SELECT * FROM tntbl3 ORDER BY c1, _id;
  _id   | c1 | c2 |  c3   | c4 |    __spd_url     
--------+----+----+-------+----+------------------
 @      |    |    | 56563 |    | /jdbc_mysql_svr/
 @1     |    |    |   222 |    | /jdbc_post_svr/
 _3     |    |    |   222 |    | /jdbc_post_svr/
 _31    |    |    | 56563 |    | /jdbc_mysql_svr/
 _4     |    |    | 56563 |    | /jdbc_mysql_svr/
 _41    |    |    |   222 |    | /jdbc_post_svr/
 bugle  |    |    |   222 |    | /jdbc_post_svr/
 test1  |    |    |   222 |    | /jdbc_post_svr/
 test11 |    |    | 56563 |    | /jdbc_mysql_svr/
 test2  |    |    | 56563 |    | /jdbc_mysql_svr/
(10 rows)

--Testcase 354:
UPDATE tntbl3 SET (c3, c2) = (SELECT c2 + 1 , c3 FROM tntbl3);
ERROR:  Child node jdbc_mysql_svr does not support transaction.
--Testcase 355:
SELECT * FROM tntbl3 ORDER BY c1, _id;
  _id   | c1 | c2 |  c3   | c4 |    __spd_url     
--------+----+----+-------+----+------------------
 @      |    |    | 56563 |    | /jdbc_mysql_svr/
 @1     |    |    |   222 |    | /jdbc_post_svr/
 _3     |    |    |   222 |    | /jdbc_post_svr/
 _31    |    |    | 56563 |    | /jdbc_mysql_svr/
 _4     |    |    | 56563 |    | /jdbc_mysql_svr/
 _41    |    |    |   222 |    | /jdbc_post_svr/
 bugle  |    |    |   222 |    | /jdbc_post_svr/
 test1  |    |    |   222 |    | /jdbc_post_svr/
 test11 |    |    | 56563 |    | /jdbc_mysql_svr/
 test2  |    |    | 56563 |    | /jdbc_mysql_svr/
(10 rows)

--Testcase 356:
UPDATE tntbl3 IN ('/jdbc_mysql_svr/') SET c3 = 56.0;
ERROR:  Child node jdbc_mysql_svr does not support transaction.
--Testcase 357:
SELECT * FROM tntbl3 ORDER BY c1, _id;
  _id   | c1 | c2 |  c3   | c4 |    __spd_url     
--------+----+----+-------+----+------------------
 @      |    |    | 56563 |    | /jdbc_mysql_svr/
 @1     |    |    |   222 |    | /jdbc_post_svr/
 _3     |    |    |   222 |    | /jdbc_post_svr/
 _31    |    |    | 56563 |    | /jdbc_mysql_svr/
 _4     |    |    | 56563 |    | /jdbc_mysql_svr/
 _41    |    |    |   222 |    | /jdbc_post_svr/
 bugle  |    |    |   222 |    | /jdbc_post_svr/
 test1  |    |    |   222 |    | /jdbc_post_svr/
 test11 |    |    | 56563 |    | /jdbc_mysql_svr/
 test2  |    |    | 56563 |    | /jdbc_mysql_svr/
(10 rows)

--Testcase 358:
DELETE FROM tntbl3 WHERE c1 > 10;
ERROR:  Child node jdbc_mysql_svr does not support transaction.
--Testcase 359:
SELECT * FROM tntbl3 ORDER BY c1, _id;
  _id   | c1 | c2 |  c3   | c4 |    __spd_url     
--------+----+----+-------+----+------------------
 @      |    |    | 56563 |    | /jdbc_mysql_svr/
 @1     |    |    |   222 |    | /jdbc_post_svr/
 _3     |    |    |   222 |    | /jdbc_post_svr/
 _31    |    |    | 56563 |    | /jdbc_mysql_svr/
 _4     |    |    | 56563 |    | /jdbc_mysql_svr/
 _41    |    |    |   222 |    | /jdbc_post_svr/
 bugle  |    |    |   222 |    | /jdbc_post_svr/
 test1  |    |    |   222 |    | /jdbc_post_svr/
 test11 |    |    | 56563 |    | /jdbc_mysql_svr/
 test2  |    |    | 56563 |    | /jdbc_mysql_svr/
(10 rows)

--Testcase 360:
DELETE FROM tntbl3 IN ('/jdbc_mysql_svr/') WHERE c3 = 56.0;
ERROR:  Child node jdbc_mysql_svr does not support transaction.
--Testcase 361:
SELECT * FROM tntbl3 ORDER BY c1, _id;
  _id   | c1 | c2 |  c3   | c4 |    __spd_url     
--------+----+----+-------+----+------------------
 @      |    |    | 56563 |    | /jdbc_mysql_svr/
 @1     |    |    |   222 |    | /jdbc_post_svr/
 _3     |    |    |   222 |    | /jdbc_post_svr/
 _31    |    |    | 56563 |    | /jdbc_mysql_svr/
 _4     |    |    | 56563 |    | /jdbc_mysql_svr/
 _41    |    |    |   222 |    | /jdbc_post_svr/
 bugle  |    |    |   222 |    | /jdbc_post_svr/
 test1  |    |    |   222 |    | /jdbc_post_svr/
 test11 |    |    | 56563 |    | /jdbc_mysql_svr/
 test2  |    |    | 56563 |    | /jdbc_mysql_svr/
(10 rows)

-- Reset value of disable_transaction_feature_check
ALTER FOREIGN TABLE tntbl3 OPTIONS (SET disable_transaction_feature_check 'true');
--
--
-- Test with __spd_url
--
--Testcase 362:
DELETE FROM tntbl3 WHERE __spd_url = '/jdbc_mysql_svr/';
SELECT * FROM tntbl3 ORDER BY c1, _id;
  _id  | c1 | c2 | c3  | c4 |    __spd_url    
-------+----+----+-----+----+-----------------
 @1    |    |    | 222 |    | /jdbc_post_svr/
 _3    |    |    | 222 |    | /jdbc_post_svr/
 _41   |    |    | 222 |    | /jdbc_post_svr/
 bugle |    |    | 222 |    | /jdbc_post_svr/
 test1 |    |    | 222 |    | /jdbc_post_svr/
(5 rows)

--Testcase 363:
DELETE FROM tntbl3 WHERE __spd_url IS NOT NULL;
SELECT * FROM tntbl3 ORDER BY c1, _id;
 _id | c1 | c2 | c3 | c4 | __spd_url 
-----+----+----+----+----+-----------
(0 rows)

--Testcase 364:
INSERT INTO tntbl3 VALUES ('foo', 30, 5.0, 50.0, 6000);
--Duplicate key column when INSERT with SELECT *. Expect error.
--Testcase 365:
INSERT INTO tntbl3 (SELECT * FROM tntbl3 ORDER BY 1, 2, 3);
ERROR:  Error occurred on a child table "tntbl3__jdbc_mysql_svr__0".
DETAIL:  remote server returned an error
--Testcase 366:
SELECT * FROM tntbl3 ORDER BY c1, _id;
 _id | c1 | c2 | c3 |  c4  |    __spd_url     
-----+----+----+----+------+------------------
 foo | 30 |  5 | 50 | 6000 | /jdbc_mysql_svr/
(1 row)

--Testcase 367:
UPDATE tntbl3 SET _id = _id || '@' WHERE __spd_url = '/jdbc_mysql_svr/';
--Testcase 368:
SELECT * FROM tntbl3 ORDER BY c1, _id;
 _id  | c1 | c2 | c3 |  c4  |    __spd_url     
------+----+----+----+------+------------------
 foo@ | 30 |  5 | 50 | 6000 | /jdbc_mysql_svr/
(1 row)

--Testcase 369:
DELETE FROM tntbl3;
--Testcase 370:
INSERT INTO tntbl3 (SELECT * FROM tntbl3 ORDER BY 1, 2, 3);
--Testcase 371:
SELECT * FROM tntbl3 ORDER BY c1, _id;
 _id | c1 | c2 | c3 | c4 | __spd_url 
-----+----+----+----+----+-----------
(0 rows)

--Testcase 372:
INSERT INTO tntbl3 VALUES(repeat('x', 10), 20, 4.0, 40.0, 5000);
--Testcase 373:
SELECT _id, sum(c1), avg(c2) FROM tntbl3 WHERE __spd_url IS NOT NULL GROUP BY _id HAVING _id IS NOT NULL LIMIT 5;
    _id     | sum | avg 
------------+-----+-----
 xxxxxxxxxx |  20 |   4
(1 row)

--Testcase 374:
INSERT INTO tntbl3 VALUES ('foo', 30, 5.0, 50.0, 6000, '/postgres_svr/');
ERROR:  There is no candidate for INSERT.
--Testcase 375:
SELECT * FROM tntbl3 ORDER BY c1, _id;
    _id     | c1 | c2 | c3 |  c4  |    __spd_url    
------------+----+----+----+------+-----------------
 xxxxxxxxxx | 20 |  4 | 40 | 5000 | /jdbc_post_svr/
(1 row)

--
-- Test with optional options: tntbl3
--
--
--
-- ON CONFLICT, this work only on postgres_fdw
--
--Testcase 420:
INSERT INTO tntbl3(_id, c1) VALUES('key$', 12);  -- duplicate key
--Testcase 421:
INSERT INTO tntbl3(_id, c1) VALUES('key$', 12) ON CONFLICT DO NOTHING; -- works
ERROR:  ON CONFLICT clause is not supported
--Testcase 422:
INSERT INTO tntbl3(_id, c1) VALUES('key$', 12) ON CONFLICT (_id, c1) DO NOTHING; -- unsupported
ERROR:  there is no unique or exclusion constraint matching the ON CONFLICT specification
--Testcase 423:
INSERT INTO tntbl3(_id, c1) VALUES('key$', 12) ON CONFLICT (_id, c1) DO UPDATE SET c2 = 'conficted!'; -- unsupported
ERROR:  invalid input syntax for type real: "conficted!"
LINE 1: ...y$', 12) ON CONFLICT (_id, c1) DO UPDATE SET c2 = 'conficted...
                                                             ^
--
-- WITH CHECK, this work only on postgres_fdw
--
--Testcase 424:
CREATE VIEW rw_view AS SELECT * FROM tntbl3
  WHERE c2 < c3 WITH CHECK OPTION;
--Testcase 425:
\d+ rw_view
                                 View "public.rw_view"
  Column   |       Type       | Collation | Nullable | Default | Storage  | Description 
-----------+------------------+-----------+----------+---------+----------+-------------
 _id       | text             |           |          |         | extended | 
 c1        | integer          |           |          |         | plain    | 
 c2        | real             |           |          |         | plain    | 
 c3        | double precision |           |          |         | plain    | 
 c4        | bigint           |           |          |         | plain    | 
 __spd_url | text             |           |          |         | extended | 
View definition:
 SELECT tntbl3._id,
    tntbl3.c1,
    tntbl3.c2,
    tntbl3.c3,
    tntbl3.c4,
    tntbl3.__spd_url
   FROM tntbl3
  WHERE tntbl3.c2 < tntbl3.c3;
Options: check_option=cascaded

--Testcase 426:
EXPLAIN (VERBOSE, COSTS OFF)
INSERT INTO rw_view(_id, c2, c3) VALUES ('id1', 5, 0);
ERROR:  WITH CHECK clause is not supported
--Testcase 427:
INSERT INTO rw_view(_id, c2, c3) VALUES ('id1', 5, 0); -- should fail
ERROR:  WITH CHECK clause is not supported
--Testcase 428:
EXPLAIN (VERBOSE, COSTS OFF)
INSERT INTO rw_view(_id, c2, c3) VALUES ('id2', 5, 3000);
ERROR:  WITH CHECK clause is not supported
--Testcase 429:
INSERT INTO rw_view(_id, c2, c3) VALUES ('id2', 5, 3000); -- ok
ERROR:  WITH CHECK clause is not supported
--Testcase 430:
SELECT _id, c1, c2, c3, c4 FROM tntbl3 ORDER BY c1, _id;
    _id     | c1 | c2 | c3 |  c4  
------------+----+----+----+------
 key$       | 12 |    |    |     
 xxxxxxxxxx | 20 |  4 | 40 | 5000
(2 rows)

--Testcase 431:
EXPLAIN (VERBOSE, COSTS OFF)
UPDATE rw_view SET c2 = c2 + 10000;
ERROR:  WITH CHECK clause is not supported
--Testcase 432:
UPDATE rw_view SET c2 = c2 + 10000; -- should fail
ERROR:  WITH CHECK clause is not supported
--Testcase 433:
EXPLAIN (VERBOSE, COSTS OFF)
UPDATE rw_view SET c2 = c2 + 15;
ERROR:  WITH CHECK clause is not supported
--Testcase 434:
UPDATE rw_view SET c2 = c2 + 15; -- ok
ERROR:  WITH CHECK clause is not supported
--Testcase 435:
SELECT _id, c1, c2, c3, c4 FROM tntbl3 ORDER BY c1, _id;
    _id     | c1 | c2 | c3 |  c4  
------------+----+----+----+------
 key$       | 12 |    |    |     
 xxxxxxxxxx | 20 |  4 | 40 | 5000
(2 rows)

--Testcase 436:
DROP VIEW rw_view;
--
-- RETURNING
--
--Testcase 437:
INSERT INTO tntbl3 VALUES ('0000', 20, 5.0, 50.0, 5000) RETURNING *;
ERROR:  RETURNING clause is not supported
--Testcase 438:
INSERT INTO tntbl3 (_id, c1, c2, c3, c4) VALUES ('_key_', 30, 4.0, 50.0, 6000) RETURNING c1, c2, c3;
ERROR:  RETURNING clause is not supported
--Testcase 439:
UPDATE tntbl3 SET c2 = 7.0 WHERE c1 = 20 AND c3 = 50.0 RETURNING (tntbl3), *;
ERROR:  RETURNING clause is not supported
--Testcase 440:
DELETE FROM tntbl3 WHERE c3 = 50.0 RETURNING _id, c1, c2;
ERROR:  RETURNING clause is not supported
--Testcase 441:
DELETE FROM tntbl3 RETURNING *;
ERROR:  RETURNING clause is not supported
-- *** Finish test for tntbl3 *** --
--
-- Test case bulk insert
--
--Clean
--Testcase 442:
DELETE FROM tntbl3;
--Testcase 443:
SELECT * FROM tntbl3;
 _id | c1 | c2 | c3 | c4 | __spd_url 
-----+----+----+----+----+-----------
(0 rows)

SET client_min_messages = INFO;
-- Auto config: batch_size of FDW = 10, insert 30 records
-- ALTER SERVER pgspider_svr OPTIONS (DROP batch_size);
--Testcase 444:
INSERT INTO tntbl3
	SELECT to_char(id, 'FM00000'), id, id/10, id * 20.5, id * 100	FROM generate_series(1, 30) id;
--Testcase 445:
SELECT * FROM tntbl3 ORDER BY 1,2;
  _id  | c1 | c2 |  c3   |  c4  |    __spd_url     
-------+----+----+-------+------+------------------
 00001 |  1 |  0 |  20.5 |  100 | /jdbc_post_svr/
 00002 |  2 |  0 |    41 |  200 | /jdbc_mysql_svr/
 00003 |  3 |  0 |  61.5 |  300 | /jdbc_post_svr/
 00004 |  4 |  0 |    82 |  400 | /jdbc_mysql_svr/
 00005 |  5 |  0 | 102.5 |  500 | /jdbc_post_svr/
 00006 |  6 |  0 |   123 |  600 | /jdbc_mysql_svr/
 00007 |  7 |  0 | 143.5 |  700 | /jdbc_post_svr/
 00008 |  8 |  0 |   164 |  800 | /jdbc_mysql_svr/
 00009 |  9 |  0 | 184.5 |  900 | /jdbc_post_svr/
 00010 | 10 |  1 |   205 | 1000 | /jdbc_mysql_svr/
 00011 | 11 |  1 | 225.5 | 1100 | /jdbc_post_svr/
 00012 | 12 |  1 |   246 | 1200 | /jdbc_mysql_svr/
 00013 | 13 |  1 | 266.5 | 1300 | /jdbc_post_svr/
 00014 | 14 |  1 |   287 | 1400 | /jdbc_mysql_svr/
 00015 | 15 |  1 | 307.5 | 1500 | /jdbc_post_svr/
 00016 | 16 |  1 |   328 | 1600 | /jdbc_mysql_svr/
 00017 | 17 |  1 | 348.5 | 1700 | /jdbc_post_svr/
 00018 | 18 |  1 |   369 | 1800 | /jdbc_mysql_svr/
 00019 | 19 |  1 | 389.5 | 1900 | /jdbc_post_svr/
 00020 | 20 |  2 |   410 | 2000 | /jdbc_mysql_svr/
 00021 | 21 |  2 | 430.5 | 2100 | /jdbc_post_svr/
 00022 | 22 |  2 |   451 | 2200 | /jdbc_mysql_svr/
 00023 | 23 |  2 | 471.5 | 2300 | /jdbc_post_svr/
 00024 | 24 |  2 |   492 | 2400 | /jdbc_mysql_svr/
 00025 | 25 |  2 | 512.5 | 2500 | /jdbc_post_svr/
 00026 | 26 |  2 |   533 | 2600 | /jdbc_mysql_svr/
 00027 | 27 |  2 | 553.5 | 2700 | /jdbc_post_svr/
 00028 | 28 |  2 |   574 | 2800 | /jdbc_mysql_svr/
 00029 | 29 |  2 | 594.5 | 2900 | /jdbc_post_svr/
 00030 | 30 |  3 |   615 | 3000 | /jdbc_mysql_svr/
(30 rows)

--Testcase 446:
SELECT * FROM tntbl3__jdbc_mysql_svr__0 ORDER BY 1,2;
  _id  | c1 | c2 | c3  |  c4  
-------+----+----+-----+------
 00002 |  2 |  0 |  41 |  200
 00004 |  4 |  0 |  82 |  400
 00006 |  6 |  0 | 123 |  600
 00008 |  8 |  0 | 164 |  800
 00010 | 10 |  1 | 205 | 1000
 00012 | 12 |  1 | 246 | 1200
 00014 | 14 |  1 | 287 | 1400
 00016 | 16 |  1 | 328 | 1600
 00018 | 18 |  1 | 369 | 1800
 00020 | 20 |  2 | 410 | 2000
 00022 | 22 |  2 | 451 | 2200
 00024 | 24 |  2 | 492 | 2400
 00026 | 26 |  2 | 533 | 2600
 00028 | 28 |  2 | 574 | 2800
 00030 | 30 |  3 | 615 | 3000
(15 rows)

--Testcase 447:
SELECT * FROM tntbl3__jdbc_post_svr__0 ORDER BY 1,2;
  _id  | c1 | c2 |  c3   |  c4  
-------+----+----+-------+------
 00001 |  1 |  0 |  20.5 |  100
 00003 |  3 |  0 |  61.5 |  300
 00005 |  5 |  0 | 102.5 |  500
 00007 |  7 |  0 | 143.5 |  700
 00009 |  9 |  0 | 184.5 |  900
 00011 | 11 |  1 | 225.5 | 1100
 00013 | 13 |  1 | 266.5 | 1300
 00015 | 15 |  1 | 307.5 | 1500
 00017 | 17 |  1 | 348.5 | 1700
 00019 | 19 |  1 | 389.5 | 1900
 00021 | 21 |  2 | 430.5 | 2100
 00023 | 23 |  2 | 471.5 | 2300
 00025 | 25 |  2 | 512.5 | 2500
 00027 | 27 |  2 | 553.5 | 2700
 00029 | 29 |  2 | 594.5 | 2900
(15 rows)

--Clean
--Testcase 110:
DELETE FROM tntbl3;
--Reset data
INSERT INTO tntbl3__jdbc_post_svr__0 VALUES ('jdbc', 10, 10.0, 1000.0, 10000);
INSERT INTO tntbl3__jdbc_mysql_svr__0 VALUES ('jdbc_mysql', 10, 10.0, 1000.0, 10000);
--Testcase 111:
DROP FOREIGN TABLE tntbl3 CASCADE;
--Testcase 112:
DROP EXTENSION jdbc_fdw CASCADE;
NOTICE:  drop cascades to 6 other objects
DETAIL:  drop cascades to server jdbc_mysql_svr
drop cascades to user mapping for public on server jdbc_mysql_svr
drop cascades to foreign table tntbl3__jdbc_mysql_svr__0
drop cascades to server jdbc_post_svr
drop cascades to user mapping for public on server jdbc_post_svr
drop cascades to foreign table tntbl3__jdbc_post_svr__0
--Testcase 113:
DROP USER MAPPING FOR CURRENT_USER SERVER pgspider_svr;
--Testcase 114:
DROP SERVER pgspider_svr CASCADE;
--Testcase 115:
DROP EXTENSION pgspider_core_fdw CASCADE;
