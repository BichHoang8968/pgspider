\set ECHO none
--Testcase 1:
SET datestyle = ISO;
--Testcase 2:
SET timezone = 'UTC';
--Testcase 3:
DELETE FROM pg_spd_node_info;
--Testcase 4:
CREATE EXTENSION pgspider_core_fdw;
--Testcase 5:
CREATE SERVER pgspider_svr FOREIGN DATA WRAPPER pgspider_core_fdw OPTIONS (host :PGSPIDER_SERVER1);
--Testcase 6:
CREATE USER MAPPING FOR CURRENT_USER SERVER pgspider_svr;
-- Extensions
--Testcase 7:
CREATE EXTENSION dynamodb_fdw;
-- Used data sources
-- Data sources
-- tntbl1: dynamodb_svr
-- key: c1, c2
--Testcase 8:
CREATE SERVER dynamodb_svr FOREIGN DATA WRAPPER dynamodb_fdw
  OPTIONS (endpoint :DYNAMODB_ENDPOINT1);
--Testcase 9:
CREATE USER MAPPING FOR public SERVER dynamodb_svr
  OPTIONS (user :DYNAMODB_USER, password :DYNAMODB_PASS);
-- Create multi tenant tables
-- tntbl1
--Testcase 10:
CREATE FOREIGN TABLE tntbl1 (c1 int, c2 smallint, c3 float, c4 double precision, c5 bigint, c8 char(30), c9 varchar(50), __spd_url text) SERVER pgspider_svr;
-- Foreign tables
--Testcase 11:
CREATE FOREIGN TABLE tntbl1__dynamodb_svr__0 (c1 int, c2 smallint, c3 float, c4 double precision, c5 bigint, c8 char(30), c9 varchar(50)) SERVER dynamodb_svr OPTIONS (table_name 'tntbl1', partition_key 'c1');
-- Reset data of remote table before test
DELETE FROM tntbl1__dynamodb_svr__0;
-- SELECT FROM table if there is any record
--Testcase 12:
SELECT * FROM tntbl1 ORDER BY 1, 2, 3;
 c1 | c2 | c3 | c4 | c5 | c8 | c9 | __spd_url 
----+----+----+----+----+----+----+-----------
(0 rows)

--
-- INSERT
-- insert with DEFAULT in the target_list
--
--Testcase 13:
INSERT INTO tntbl1 (c1, c2, c3, c4, c5, c8, c9) VALUES (1, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT);
--Testcase 14:
INSERT INTO tntbl1 (c1, c2) VALUES (3, DEFAULT);
--Testcase 15:
INSERT INTO tntbl1 (c1, c2, c3) VALUES (4, 5, DEFAULT);
--Testcase 16:
INSERT INTO tntbl1 VALUES (5, 6, 2.6, 5453.454, 5989);
--Testcase 17:
INSERT INTO tntbl1 VALUES (6, 7);
--Testcase 18:
SELECT * FROM tntbl1 ORDER BY 1, 2, 3;
 c1 | c2 | c3  |    c4    |  c5  | c8 | c9 |   __spd_url    
----+----+-----+----------+------+----+----+----------------
  1 |    |     |          |      |    |    | /dynamodb_svr/
  3 |    |     |          |      |    |    | /dynamodb_svr/
  4 |  5 |     |          |      |    |    | /dynamodb_svr/
  5 |  6 | 2.6 | 5453.454 | 5989 |    |    | /dynamodb_svr/
  6 |  7 |     |          |      |    |    | /dynamodb_svr/
(5 rows)

--
-- insert with similar expression / target_list VALUES (all fail)
--
--Testcase 19:
INSERT INTO tntbl1 (c1, c2, c3, c4, c5, c8, c9) VALUES (10, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT);
ERROR:  INSERT has more target columns than expressions
LINE 1: INSERT INTO tntbl1 (c1, c2, c3, c4, c5, c8, c9) VALUES (10, ...
                                                    ^
--Testcase 20:
INSERT INTO tntbl1 (c1, c2, c3) VALUES (12, DEFAULT);
ERROR:  INSERT has more target columns than expressions
LINE 1: INSERT INTO tntbl1 (c1, c2, c3) VALUES (12, DEFAULT);
                                    ^
--Testcase 21:
INSERT INTO tntbl1 (c1, c2) VALUES (13, 2, 5);
ERROR:  INSERT has more expressions than target columns
LINE 1: INSERT INTO tntbl1 (c1, c2) VALUES (13, 2, 5);
                                                   ^
--Testcase 22:
INSERT INTO tntbl1 (c1, c2) VALUES (14, DEFAULT, 6);
ERROR:  INSERT has more expressions than target columns
LINE 1: INSERT INTO tntbl1 (c1, c2) VALUES (14, DEFAULT, 6);
                                                         ^
--Testcase 23:
SELECT * FROM tntbl1 ORDER BY 1, 2, 3;
 c1 | c2 | c3  |    c4    |  c5  | c8 | c9 |   __spd_url    
----+----+-----+----------+------+----+----+----------------
  1 |    |     |          |      |    |    | /dynamodb_svr/
  3 |    |     |          |      |    |    | /dynamodb_svr/
  4 |  5 |     |          |      |    |    | /dynamodb_svr/
  5 |  6 | 2.6 | 5453.454 | 5989 |    |    | /dynamodb_svr/
  6 |  7 |     |          |      |    |    | /dynamodb_svr/
(5 rows)

--
-- VALUES test
--
--Testcase 24:
INSERT INTO tntbl1 VALUES (10, 20, 3.0, 452.254, 599, '40', 'abc'), (-1, 2, DEFAULT, DEFAULT, 69845, 'Beera', 'John Does'),
    ((SELECT 2), (SELECT i FROM (VALUES(3)) as foo (i)), 4.0, 656.212, 5944, 'VALUES are fun!', 'foo');
--Testcase 25:
SELECT * FROM tntbl1 ORDER BY 1, 2, 3;
 c1 | c2 | c3  |    c4    |  c5   |               c8               |    c9     |   __spd_url    
----+----+-----+----------+-------+--------------------------------+-----------+----------------
 -1 |  2 |     |          | 69845 | Beera                          | John Does | /dynamodb_svr/
  1 |    |     |          |       |                                |           | /dynamodb_svr/
  2 |  3 |   4 |  656.212 |  5944 | VALUES are fun!                | foo       | /dynamodb_svr/
  3 |    |     |          |       |                                |           | /dynamodb_svr/
  4 |  5 |     |          |       |                                |           | /dynamodb_svr/
  5 |  6 | 2.6 | 5453.454 |  5989 |                                |           | /dynamodb_svr/
  6 |  7 |     |          |       |                                |           | /dynamodb_svr/
 10 | 20 |   3 |  452.254 |   599 | 40                             | abc       | /dynamodb_svr/
(8 rows)

--
-- TOASTed value test
--
--Testcase 26:
INSERT INTO tntbl1 VALUES (9, 9, 902.12, 9545.03, 3122, repeat('x', 25), repeat('a', 25));
--Testcase 27:
SELECT * FROM tntbl1 ORDER BY 1, 2, 3;
 c1 | c2 |   c3   |    c4    |  c5   |               c8               |            c9             |   __spd_url    
----+----+--------+----------+-------+--------------------------------+---------------------------+----------------
 -1 |  2 |        |          | 69845 | Beera                          | John Does                 | /dynamodb_svr/
  1 |    |        |          |       |                                |                           | /dynamodb_svr/
  2 |  3 |      4 |  656.212 |  5944 | VALUES are fun!                | foo                       | /dynamodb_svr/
  3 |    |        |          |       |                                |                           | /dynamodb_svr/
  4 |  5 |        |          |       |                                |                           | /dynamodb_svr/
  5 |  6 |    2.6 | 5453.454 |  5989 |                                |                           | /dynamodb_svr/
  6 |  7 |        |          |       |                                |                           | /dynamodb_svr/
  9 |  9 | 902.12 |  9545.03 |  3122 | xxxxxxxxxxxxxxxxxxxxxxxxx      | aaaaaaaaaaaaaaaaaaaaaaaaa | /dynamodb_svr/
 10 | 20 |      3 |  452.254 |   599 | 40                             | abc                       | /dynamodb_svr/
(9 rows)

--
-- INSERT with IN feature, this feature not work yet
--
--Testcase 28:
INSERT INTO tntbl1 IN ('/postgres_svr/') VALUES (-10, 20, 82.21, 213.12, 9565, 'One', 'OneOne');
ERROR:  Can not use INSERT with IN
--
-- UPDATE
--
--Testcase 29:
SELECT c1, c2, c3, c4, c5, c8, c9 FROM tntbl1 ORDER BY 1, 2, 3;
 c1 | c2 |   c3   |    c4    |  c5   |               c8               |            c9             
----+----+--------+----------+-------+--------------------------------+---------------------------
 -1 |  2 |        |          | 69845 | Beera                          | John Does
  1 |    |        |          |       |                                | 
  2 |  3 |      4 |  656.212 |  5944 | VALUES are fun!                | foo
  3 |    |        |          |       |                                | 
  4 |  5 |        |          |       |                                | 
  5 |  6 |    2.6 | 5453.454 |  5989 |                                | 
  6 |  7 |        |          |       |                                | 
  9 |  9 | 902.12 |  9545.03 |  3122 | xxxxxxxxxxxxxxxxxxxxxxxxx      | aaaaaaaaaaaaaaaaaaaaaaaaa
 10 | 20 |      3 |  452.254 |   599 | 40                             | abc
(9 rows)

--Testcase 30:
UPDATE tntbl1 SET c4 = DEFAULT;
--Testcase 31:
SELECT c1, c2, c3, c4, c5, c8, c9 FROM tntbl1 ORDER BY 1, 2, 3;
 c1 | c2 |   c3   | c4 |  c5   |               c8               |            c9             
----+----+--------+----+-------+--------------------------------+---------------------------
 -1 |  2 |        |    | 69845 | Beera                          | John Does
  1 |    |        |    |       |                                | 
  2 |  3 |      4 |    |  5944 | VALUES are fun!                | foo
  3 |    |        |    |       |                                | 
  4 |  5 |        |    |       |                                | 
  5 |  6 |    2.6 |    |  5989 |                                | 
  6 |  7 |        |    |       |                                | 
  9 |  9 | 902.12 |    |  3122 | xxxxxxxxxxxxxxxxxxxxxxxxx      | aaaaaaaaaaaaaaaaaaaaaaaaa
 10 | 20 |      3 |    |   599 | 40                             | abc
(9 rows)

-- aliases for the UPDATE target table
--Testcase 32:
UPDATE tntbl1 AS t SET c2 = 10 WHERE t.c3 = 902.12;
--Testcase 33:
SELECT c1, c2, c3, c4, c5, c8, c9 FROM tntbl1 ORDER BY 1, 2, 3;
 c1 | c2 |   c3   | c4 |  c5   |               c8               |            c9             
----+----+--------+----+-------+--------------------------------+---------------------------
 -1 |  2 |        |    | 69845 | Beera                          | John Does
  1 |    |        |    |       |                                | 
  2 |  3 |      4 |    |  5944 | VALUES are fun!                | foo
  3 |    |        |    |       |                                | 
  4 |  5 |        |    |       |                                | 
  5 |  6 |    2.6 |    |  5989 |                                | 
  6 |  7 |        |    |       |                                | 
  9 | 10 | 902.12 |    |  3122 | xxxxxxxxxxxxxxxxxxxxxxxxx      | aaaaaaaaaaaaaaaaaaaaaaaaa
 10 | 20 |      3 |    |   599 | 40                             | abc
(9 rows)

--Testcase 34:
UPDATE tntbl1 t SET c2 = t.c2 + 10 WHERE t.c3 = 3.0;
--Testcase 35:
SELECT c1, c2, c3, c4, c5, c8, c9 FROM tntbl1 ORDER BY 1, 2, 3;
 c1 | c2 |   c3   | c4 |  c5   |               c8               |            c9             
----+----+--------+----+-------+--------------------------------+---------------------------
 -1 |  2 |        |    | 69845 | Beera                          | John Does
  1 |    |        |    |       |                                | 
  2 |  3 |      4 |    |  5944 | VALUES are fun!                | foo
  3 |    |        |    |       |                                | 
  4 |  5 |        |    |       |                                | 
  5 |  6 |    2.6 |    |  5989 |                                | 
  6 |  7 |        |    |       |                                | 
  9 | 10 | 902.12 |    |  3122 | xxxxxxxxxxxxxxxxxxxxxxxxx      | aaaaaaaaaaaaaaaaaaaaaaaaa
 10 | 30 |      3 |    |   599 | 40                             | abc
(9 rows)

--
-- Test VALUES in FROM
--
--Testcase 36:
UPDATE tntbl1 SET c1=v.i FROM (VALUES(20, 0)) AS v(i, j)
  WHERE tntbl1.c2 = v.j;
--Testcase 37:
SELECT c1, c2, c3, c4, c5, c8, c9 FROM tntbl1 ORDER BY 1, 2, 3;
 c1 | c2 |   c3   | c4 |  c5   |               c8               |            c9             
----+----+--------+----+-------+--------------------------------+---------------------------
 -1 |  2 |        |    | 69845 | Beera                          | John Does
  1 |    |        |    |       |                                | 
  2 |  3 |      4 |    |  5944 | VALUES are fun!                | foo
  3 |    |        |    |       |                                | 
  4 |  5 |        |    |       |                                | 
  5 |  6 |    2.6 |    |  5989 |                                | 
  6 |  7 |        |    |       |                                | 
  9 | 10 | 902.12 |    |  3122 | xxxxxxxxxxxxxxxxxxxxxxxxx      | aaaaaaaaaaaaaaaaaaaaaaaaa
 10 | 30 |      3 |    |   599 | 40                             | abc
(9 rows)

-- fail, wrong data type:
--Testcase 38:
UPDATE tntbl1 SET c1 = v.* FROM (VALUES(30, 0)) AS v(i, j)
  WHERE tntbl1.c2 = v.j;
ERROR:  column "c1" is of type integer but expression is of type record
LINE 1: UPDATE tntbl1 SET c1 = v.* FROM (VALUES(30, 0)) AS v(i, j)
                               ^
HINT:  You will need to rewrite or cast the expression.
--
-- Test multiple-set-clause syntax
--
--Testcase 39:
INSERT INTO tntbl1 SELECT c1+20, c2+50, c3 FROM tntbl1;
--Testcase 40:
SELECT c1, c2, c3, c4, c5, c8, c9 FROM tntbl1 ORDER BY 1, 2, 3;
 c1 | c2 |   c3   | c4 |  c5   |               c8               |            c9             
----+----+--------+----+-------+--------------------------------+---------------------------
 -1 |  2 |        |    | 69845 | Beera                          | John Does
  1 |    |        |    |       |                                | 
  2 |  3 |      4 |    |  5944 | VALUES are fun!                | foo
  3 |    |        |    |       |                                | 
  4 |  5 |        |    |       |                                | 
  5 |  6 |    2.6 |    |  5989 |                                | 
  6 |  7 |        |    |       |                                | 
  9 | 10 | 902.12 |    |  3122 | xxxxxxxxxxxxxxxxxxxxxxxxx      | aaaaaaaaaaaaaaaaaaaaaaaaa
 10 | 30 |      3 |    |   599 | 40                             | abc
 19 | 52 |        |    |       |                                | 
 21 |    |        |    |       |                                | 
 22 | 53 |      4 |    |       |                                | 
 23 |    |        |    |       |                                | 
 24 | 55 |        |    |       |                                | 
 25 | 56 |    2.6 |    |       |                                | 
 26 | 57 |        |    |       |                                | 
 29 | 60 | 902.12 |    |       |                                | 
 30 | 80 |      3 |    |       |                                | 
(18 rows)

--Testcase 41:
UPDATE tntbl1 SET (c8,c3,c2) = ('bugle', c3+11, DEFAULT) WHERE c9 = 'foo';
--Testcase 42:
SELECT c1, c2, c3, c4, c5, c8, c9 FROM tntbl1 ORDER BY 1, 2, 3;
 c1 | c2 |   c3   | c4 |  c5   |               c8               |            c9             
----+----+--------+----+-------+--------------------------------+---------------------------
 -1 |  2 |        |    | 69845 | Beera                          | John Does
  1 |    |        |    |       |                                | 
  2 |    |     15 |    |  5944 | bugle                          | foo
  3 |    |        |    |       |                                | 
  4 |  5 |        |    |       |                                | 
  5 |  6 |    2.6 |    |  5989 |                                | 
  6 |  7 |        |    |       |                                | 
  9 | 10 | 902.12 |    |  3122 | xxxxxxxxxxxxxxxxxxxxxxxxx      | aaaaaaaaaaaaaaaaaaaaaaaaa
 10 | 30 |      3 |    |   599 | 40                             | abc
 19 | 52 |        |    |       |                                | 
 21 |    |        |    |       |                                | 
 22 | 53 |      4 |    |       |                                | 
 23 |    |        |    |       |                                | 
 24 | 55 |        |    |       |                                | 
 25 | 56 |    2.6 |    |       |                                | 
 26 | 57 |        |    |       |                                | 
 29 | 60 | 902.12 |    |       |                                | 
 30 | 80 |      3 |    |       |                                | 
(18 rows)

--Testcase 43:
UPDATE tntbl1 SET (c9,c4) = ('car', c1+c3), c2 = c2 + 1 WHERE c5 = 3122;
--Testcase 44:
SELECT c1, c2, c3, c4, c5, c8, c9 FROM tntbl1 ORDER BY 1, 2, 3;
 c1 | c2 |   c3   |   c4   |  c5   |               c8               |    c9     
----+----+--------+--------+-------+--------------------------------+-----------
 -1 |  2 |        |        | 69845 | Beera                          | John Does
  1 |    |        |        |       |                                | 
  2 |    |     15 |        |  5944 | bugle                          | foo
  3 |    |        |        |       |                                | 
  4 |  5 |        |        |       |                                | 
  5 |  6 |    2.6 |        |  5989 |                                | 
  6 |  7 |        |        |       |                                | 
  9 | 11 | 902.12 | 911.12 |  3122 | xxxxxxxxxxxxxxxxxxxxxxxxx      | car
 10 | 30 |      3 |        |   599 | 40                             | abc
 19 | 52 |        |        |       |                                | 
 21 |    |        |        |       |                                | 
 22 | 53 |      4 |        |       |                                | 
 23 |    |        |        |       |                                | 
 24 | 55 |        |        |       |                                | 
 25 | 56 |    2.6 |        |       |                                | 
 26 | 57 |        |        |       |                                | 
 29 | 60 | 902.12 |        |       |                                | 
 30 | 80 |      3 |        |       |                                | 
(18 rows)

-- fail, multi assignment to same column:
--Testcase 45:
UPDATE tntbl1 SET (c9,c5) = ('car', c1+c5), c5 = c1 + 1 WHERE c2 = 20;
ERROR:  multiple assignments to same column "c5"
-- uncorrelated sub-SELECT:
--Testcase 46:
UPDATE tntbl1
  SET (c2,c3) = (SELECT c2,c3 FROM tntbl1 where c3 = 3 and c9 = 'abc')
  WHERE c1 = 30 AND c2 = 80.0;
--Testcase 47:
SELECT c1, c2, c3, c4, c5, c8, c9 FROM tntbl1 ORDER BY 1, 2, 3;
 c1 | c2 |   c3   |   c4   |  c5   |               c8               |    c9     
----+----+--------+--------+-------+--------------------------------+-----------
 -1 |  2 |        |        | 69845 | Beera                          | John Does
  1 |    |        |        |       |                                | 
  2 |    |     15 |        |  5944 | bugle                          | foo
  3 |    |        |        |       |                                | 
  4 |  5 |        |        |       |                                | 
  5 |  6 |    2.6 |        |  5989 |                                | 
  6 |  7 |        |        |       |                                | 
  9 | 11 | 902.12 | 911.12 |  3122 | xxxxxxxxxxxxxxxxxxxxxxxxx      | car
 10 | 30 |      3 |        |   599 | 40                             | abc
 19 | 52 |        |        |       |                                | 
 21 |    |        |        |       |                                | 
 22 | 53 |      4 |        |       |                                | 
 23 |    |        |        |       |                                | 
 24 | 55 |        |        |       |                                | 
 25 | 56 |    2.6 |        |       |                                | 
 26 | 57 |        |        |       |                                | 
 29 | 60 | 902.12 |        |       |                                | 
 30 | 30 |      3 |        |       |                                | 
(18 rows)

-- correlated sub-SELECT:
--Testcase 48:
UPDATE tntbl1 o
  SET (c4,c5) = (SELECT c4+1,c5 FROM tntbl1 i
               where i.c4=o.c3 and i.c5=o.c5 and i.c5 is not distinct FROM o.c5);
--Testcase 49:
SELECT c1, c2, c3, c4, c5, c8, c9 FROM tntbl1 ORDER BY 1, 2, 3;
 c1 | c2 |   c3   | c4 | c5 |               c8               |    c9     
----+----+--------+----+----+--------------------------------+-----------
 -1 |  2 |        |    |    | Beera                          | John Does
  1 |    |        |    |    |                                | 
  2 |    |     15 |    |    | bugle                          | foo
  3 |    |        |    |    |                                | 
  4 |  5 |        |    |    |                                | 
  5 |  6 |    2.6 |    |    |                                | 
  6 |  7 |        |    |    |                                | 
  9 | 11 | 902.12 |    |    | xxxxxxxxxxxxxxxxxxxxxxxxx      | car
 10 | 30 |      3 |    |    | 40                             | abc
 19 | 52 |        |    |    |                                | 
 21 |    |        |    |    |                                | 
 22 | 53 |      4 |    |    |                                | 
 23 |    |        |    |    |                                | 
 24 | 55 |        |    |    |                                | 
 25 | 56 |    2.6 |    |    |                                | 
 26 | 57 |        |    |    |                                | 
 29 | 60 | 902.12 |    |    |                                | 
 30 | 30 |      3 |    |    |                                | 
(18 rows)

-- fail, multiple rows supplied:
--Testcase 50:
UPDATE tntbl1 SET (c1,c2) = (SELECT c2+1,c1 FROM tntbl1);
ERROR:  more than one row returned by a subquery used as an expression
-- set to null if no rows supplied:
--Testcase 51:
UPDATE tntbl1 SET (c2,c3) = (SELECT c2+1,c3 FROM tntbl1 where c2 = 11)
  WHERE c2 = 52;
--Testcase 52:
SELECT c1, c2, c3, c4, c5, c8, c9 FROM tntbl1 ORDER BY 1, 2, 3;
 c1 | c2 |   c3   | c4 | c5 |               c8               |    c9     
----+----+--------+----+----+--------------------------------+-----------
 -1 |  2 |        |    |    | Beera                          | John Does
  1 |    |        |    |    |                                | 
  2 |    |     15 |    |    | bugle                          | foo
  3 |    |        |    |    |                                | 
  4 |  5 |        |    |    |                                | 
  5 |  6 |    2.6 |    |    |                                | 
  6 |  7 |        |    |    |                                | 
  9 | 11 | 902.12 |    |    | xxxxxxxxxxxxxxxxxxxxxxxxx      | car
 10 | 30 |      3 |    |    | 40                             | abc
 19 | 12 | 902.12 |    |    |                                | 
 21 |    |        |    |    |                                | 
 22 | 53 |      4 |    |    |                                | 
 23 |    |        |    |    |                                | 
 24 | 55 |        |    |    |                                | 
 25 | 56 |    2.6 |    |    |                                | 
 26 | 57 |        |    |    |                                | 
 29 | 60 | 902.12 |    |    |                                | 
 30 | 30 |      3 |    |    |                                | 
(18 rows)

-- *-expansion should work in this context:
--Testcase 53:
UPDATE tntbl1 SET (c2,c3) = ROW(v.*) FROM (VALUES(2, 100)) AS v(i, j)
  WHERE tntbl1.c2 = v.i;
-- you might expect this to work, but syntactically it's not a RowExpr:
--Testcase 54:
UPDATE tntbl1 SET (c1,c2) = (v.*) FROM (VALUES(2, 101)) AS v(i, j)
  WHERE tntbl1.c2 = v.i;
ERROR:  source for a multiple-column UPDATE item must be a sub-SELECT or ROW() expression
LINE 1: UPDATE tntbl1 SET (c1,c2) = (v.*) FROM (VALUES(2, 101)) AS v...
                                     ^
-- if an alias for the target table is specified, don't allow references
-- to the original table name
--Testcase 55:
UPDATE tntbl1 AS t SET c2 = tntbl1.c2 + 10 WHERE t.c2 = 10;
ERROR:  invalid reference to FROM-clause entry for table "tntbl1"
LINE 1: UPDATE tntbl1 AS t SET c2 = tntbl1.c2 + 10 WHERE t.c2 = 10;
                                    ^
HINT:  Perhaps you meant to reference the table alias "t".
-- Make sure that we can update to a TOASTed value.
--Testcase 56:
UPDATE tntbl1 SET c9 = repeat('x', 25) WHERE c9 = 'car';
--Testcase 57:
SELECT c1, c2, c9 FROM tntbl1 ORDER BY 1, 2, 3;
 c1 | c2 |            c9             
----+----+---------------------------
 -1 |  2 | John Does
  1 |    | 
  2 |    | foo
  3 |    | 
  4 |  5 | 
  5 |  6 | 
  6 |  7 | 
  9 | 11 | xxxxxxxxxxxxxxxxxxxxxxxxx
 10 | 30 | abc
 19 | 12 | 
 21 |    | 
 22 | 53 | 
 23 |    | 
 24 | 55 | 
 25 | 56 | 
 26 | 57 | 
 29 | 60 | 
 30 | 30 | 
(18 rows)

-- Check multi-assignment with a Result node to handle a one-time filter.
--Testcase 58:
EXPLAIN (VERBOSE, COSTS OFF)
UPDATE tntbl1 t
  SET (c2, c3) = (SELECT c3, c2 FROM tntbl1 s WHERE s.c2 = t.c2)
  WHERE CURRENT_USER = SESSION_USER;
                                                    QUERY PLAN                                                     
-------------------------------------------------------------------------------------------------------------------
 Update on public.tntbl1 t
   Node: dynamodb_svr / Status: Alive
     Remote SQL: UPDATE tntbl1 SET c2 = ? SET c3 = ? WHERE c1 = ?
   ->  Result
         Output: (($1)::smallint), (($2)::double precision), ((SubPlan 1 (returns $1,$2))), t.c1, t.__spd_url, t.*
         One-Time Filter: (CURRENT_USER = SESSION_USER)
         ->  Foreign Scan on public.tntbl1 t
               Output: $1, $2, (SubPlan 1 (returns $1,$2)), t.c1, t.__spd_url, t.*
               Filter: (CURRENT_USER = SESSION_USER)
               Node: dynamodb_svr / Status: Alive
                 Remote SQL: SELECT c1, c2, c3, c4, c5, c8, c9 FROM tntbl1
               SubPlan 1 (returns $1,$2)
                 ->  Foreign Scan on public.tntbl1 s
                       Output: s.c3, s.c2
                       Filter: (s.c2 = t.c2)
                       Node: dynamodb_svr / Status: Alive
                         Remote SQL: SELECT c2, c3 FROM tntbl1
(17 rows)

--Testcase 59:
UPDATE tntbl1 t
  SET (c2, c3) = (SELECT c3, c2 FROM tntbl1 s WHERE s.c2 = t.c2 AND s.c3 = 100)
  WHERE CURRENT_USER = SESSION_USER;
--Testcase 60:
SELECT c2, c3, c9 FROM tntbl1 ORDER BY 1, 2, 3;
 c2  | c3 |            c9             
-----+----+---------------------------
 100 |  2 | John Does
     |    | abc
     |    | foo
     |    | xxxxxxxxxxxxxxxxxxxxxxxxx
     |    | 
     |    | 
     |    | 
     |    | 
     |    | 
     |    | 
     |    | 
     |    | 
     |    | 
     |    | 
     |    | 
     |    | 
     |    | 
     |    | 
(18 rows)

--
-- UPDATE with IN feature
--
--Testcase 61:
UPDATE tntbl1 IN ('/postgres_svr/', '/sqlite_svr/') SET c3 = 22.2;
ERROR:  No child node support modification.
--
-- DELETE
--
-- allow an alias to be specified for DELETE's target table
--Testcase 62:
DELETE FROM tntbl1 AS dt WHERE dt.c1 > 75;
-- if an alias is specified, don't allow the original table name
-- to be referenced
--Testcase 63:
DELETE FROM tntbl1 dt WHERE tntbl1.c1 > 25;
ERROR:  invalid reference to FROM-clause entry for table "tntbl1"
LINE 1: DELETE FROM tntbl1 dt WHERE tntbl1.c1 > 25;
                                    ^
HINT:  Perhaps you meant to reference the table alias "dt".
--Testcase 64:
SELECT c1, c2, c9 FROM tntbl1 ORDER BY 1, 2, 3;
 c1 | c2  |            c9             
----+-----+---------------------------
 -1 | 100 | John Does
  1 |     | 
  2 |     | foo
  3 |     | 
  4 |     | 
  5 |     | 
  6 |     | 
  9 |     | xxxxxxxxxxxxxxxxxxxxxxxxx
 10 |     | abc
 19 |     | 
 21 |     | 
 22 |     | 
 23 |     | 
 24 |     | 
 25 |     | 
 26 |     | 
 29 |     | 
 30 |     | 
(18 rows)

-- delete a row with a TOASTed value
--Testcase 65:
DELETE FROM tntbl1 WHERE c2 > 2;
--Testcase 66:
SELECT c1, c2, c9 FROM tntbl1 ORDER BY 1, 2, 3;
 c1 | c2 |            c9             
----+----+---------------------------
  1 |    | 
  2 |    | foo
  3 |    | 
  4 |    | 
  5 |    | 
  6 |    | 
  9 |    | xxxxxxxxxxxxxxxxxxxxxxxxx
 10 |    | abc
 19 |    | 
 21 |    | 
 22 |    | 
 23 |    | 
 24 |    | 
 25 |    | 
 26 |    | 
 29 |    | 
 30 |    | 
(17 rows)

--
-- DELETE with IN feature
--
--Testcase 67:
DELETE FROM tntbl1 IN ('/postgres_svr/') WHERE c1 = 20;
ERROR:  No child node support modification.
--Testcase 68:
SELECT * FROM tntbl1 ORDER BY 1, 2, 3;
 c1 | c2 | c3 | c4 | c5 |               c8               |            c9             |   __spd_url    
----+----+----+----+----+--------------------------------+---------------------------+----------------
  1 |    |    |    |    |                                |                           | /dynamodb_svr/
  2 |    |    |    |    | bugle                          | foo                       | /dynamodb_svr/
  3 |    |    |    |    |                                |                           | /dynamodb_svr/
  4 |    |    |    |    |                                |                           | /dynamodb_svr/
  5 |    |    |    |    |                                |                           | /dynamodb_svr/
  6 |    |    |    |    |                                |                           | /dynamodb_svr/
  9 |    |    |    |    | xxxxxxxxxxxxxxxxxxxxxxxxx      | xxxxxxxxxxxxxxxxxxxxxxxxx | /dynamodb_svr/
 10 |    |    |    |    | 40                             | abc                       | /dynamodb_svr/
 19 |    |    |    |    |                                |                           | /dynamodb_svr/
 21 |    |    |    |    |                                |                           | /dynamodb_svr/
 22 |    |    |    |    |                                |                           | /dynamodb_svr/
 23 |    |    |    |    |                                |                           | /dynamodb_svr/
 24 |    |    |    |    |                                |                           | /dynamodb_svr/
 25 |    |    |    |    |                                |                           | /dynamodb_svr/
 26 |    |    |    |    |                                |                           | /dynamodb_svr/
 29 |    |    |    |    |                                |                           | /dynamodb_svr/
 30 |    |    |    |    |                                |                           | /dynamodb_svr/
(17 rows)

--Testcase 69:
DELETE FROM tntbl1 IN ('/sqlite_svr/', '/tiny_svr/', '/mysql_svr/') WHERE c5 = 1000;
ERROR:  No child node support modification.
--Testcase 70:
SELECT * FROM tntbl1 ORDER BY 1, 2, 3;
 c1 | c2 | c3 | c4 | c5 |               c8               |            c9             |   __spd_url    
----+----+----+----+----+--------------------------------+---------------------------+----------------
  1 |    |    |    |    |                                |                           | /dynamodb_svr/
  2 |    |    |    |    | bugle                          | foo                       | /dynamodb_svr/
  3 |    |    |    |    |                                |                           | /dynamodb_svr/
  4 |    |    |    |    |                                |                           | /dynamodb_svr/
  5 |    |    |    |    |                                |                           | /dynamodb_svr/
  6 |    |    |    |    |                                |                           | /dynamodb_svr/
  9 |    |    |    |    | xxxxxxxxxxxxxxxxxxxxxxxxx      | xxxxxxxxxxxxxxxxxxxxxxxxx | /dynamodb_svr/
 10 |    |    |    |    | 40                             | abc                       | /dynamodb_svr/
 19 |    |    |    |    |                                |                           | /dynamodb_svr/
 21 |    |    |    |    |                                |                           | /dynamodb_svr/
 22 |    |    |    |    |                                |                           | /dynamodb_svr/
 23 |    |    |    |    |                                |                           | /dynamodb_svr/
 24 |    |    |    |    |                                |                           | /dynamodb_svr/
 25 |    |    |    |    |                                |                           | /dynamodb_svr/
 26 |    |    |    |    |                                |                           | /dynamodb_svr/
 29 |    |    |    |    |                                |                           | /dynamodb_svr/
 30 |    |    |    |    |                                |                           | /dynamodb_svr/
(17 rows)

--
-- Check behavior of disable_transaction_feature_check
--
-- Check value of disable_transaction_feature_check
--Testcase 71:
ALTER FOREIGN TABLE tntbl1 OPTIONS (disable_transaction_feature_check 'false');
--Testcase 72:
INSERT INTO tntbl1 VALUES (200, 70, 2.0, 200.0, 3000, DEFAULT, 'abc', 'foo');
ERROR:  Child node dynamodb_svr does not support transaction.
--Testcase 73:
SELECT * FROM tntbl1 ORDER BY 1, 2, 3;
 c1 | c2 | c3 | c4 | c5 |               c8               |            c9             |   __spd_url    
----+----+----+----+----+--------------------------------+---------------------------+----------------
  1 |    |    |    |    |                                |                           | /dynamodb_svr/
  2 |    |    |    |    | bugle                          | foo                       | /dynamodb_svr/
  3 |    |    |    |    |                                |                           | /dynamodb_svr/
  4 |    |    |    |    |                                |                           | /dynamodb_svr/
  5 |    |    |    |    |                                |                           | /dynamodb_svr/
  6 |    |    |    |    |                                |                           | /dynamodb_svr/
  9 |    |    |    |    | xxxxxxxxxxxxxxxxxxxxxxxxx      | xxxxxxxxxxxxxxxxxxxxxxxxx | /dynamodb_svr/
 10 |    |    |    |    | 40                             | abc                       | /dynamodb_svr/
 19 |    |    |    |    |                                |                           | /dynamodb_svr/
 21 |    |    |    |    |                                |                           | /dynamodb_svr/
 22 |    |    |    |    |                                |                           | /dynamodb_svr/
 23 |    |    |    |    |                                |                           | /dynamodb_svr/
 24 |    |    |    |    |                                |                           | /dynamodb_svr/
 25 |    |    |    |    |                                |                           | /dynamodb_svr/
 26 |    |    |    |    |                                |                           | /dynamodb_svr/
 29 |    |    |    |    |                                |                           | /dynamodb_svr/
 30 |    |    |    |    |                                |                           | /dynamodb_svr/
(17 rows)

--Testcase 74:
INSERT INTO tntbl1 VALUES (100, 20, 3.0, 300.0, 4000, interval '2 months ago', '40', 'abc'), (-100, 30, DEFAULT, DEFAULT, 2000, interval '1 year 3 hours 20 minutes', 'Beera', 'John Does'),
    ((SELECT 200), (SELECT i FROM (VALUES(3)) as foo (i)), 250, 400.212, 5000, interval '1 year 2 months 3 days', 'VALUES are fun!', 'foo');
ERROR:  Child node dynamodb_svr does not support transaction.
--Testcase 75:
SELECT * FROM tntbl1 ORDER BY 1, 2, 3;
 c1 | c2 | c3 | c4 | c5 |               c8               |            c9             |   __spd_url    
----+----+----+----+----+--------------------------------+---------------------------+----------------
  1 |    |    |    |    |                                |                           | /dynamodb_svr/
  2 |    |    |    |    | bugle                          | foo                       | /dynamodb_svr/
  3 |    |    |    |    |                                |                           | /dynamodb_svr/
  4 |    |    |    |    |                                |                           | /dynamodb_svr/
  5 |    |    |    |    |                                |                           | /dynamodb_svr/
  6 |    |    |    |    |                                |                           | /dynamodb_svr/
  9 |    |    |    |    | xxxxxxxxxxxxxxxxxxxxxxxxx      | xxxxxxxxxxxxxxxxxxxxxxxxx | /dynamodb_svr/
 10 |    |    |    |    | 40                             | abc                       | /dynamodb_svr/
 19 |    |    |    |    |                                |                           | /dynamodb_svr/
 21 |    |    |    |    |                                |                           | /dynamodb_svr/
 22 |    |    |    |    |                                |                           | /dynamodb_svr/
 23 |    |    |    |    |                                |                           | /dynamodb_svr/
 24 |    |    |    |    |                                |                           | /dynamodb_svr/
 25 |    |    |    |    |                                |                           | /dynamodb_svr/
 26 |    |    |    |    |                                |                           | /dynamodb_svr/
 29 |    |    |    |    |                                |                           | /dynamodb_svr/
 30 |    |    |    |    |                                |                           | /dynamodb_svr/
(17 rows)

--Testcase 76:
INSERT INTO tntbl1 VALUES (900, 80, 6.0, 400.03, 6000, interval '1 months ago', repeat('x', 10), repeat('a', 20));
ERROR:  Child node dynamodb_svr does not support transaction.
--Testcase 77:
SELECT * FROM tntbl1 ORDER BY 1, 2, 3;
 c1 | c2 | c3 | c4 | c5 |               c8               |            c9             |   __spd_url    
----+----+----+----+----+--------------------------------+---------------------------+----------------
  1 |    |    |    |    |                                |                           | /dynamodb_svr/
  2 |    |    |    |    | bugle                          | foo                       | /dynamodb_svr/
  3 |    |    |    |    |                                |                           | /dynamodb_svr/
  4 |    |    |    |    |                                |                           | /dynamodb_svr/
  5 |    |    |    |    |                                |                           | /dynamodb_svr/
  6 |    |    |    |    |                                |                           | /dynamodb_svr/
  9 |    |    |    |    | xxxxxxxxxxxxxxxxxxxxxxxxx      | xxxxxxxxxxxxxxxxxxxxxxxxx | /dynamodb_svr/
 10 |    |    |    |    | 40                             | abc                       | /dynamodb_svr/
 19 |    |    |    |    |                                |                           | /dynamodb_svr/
 21 |    |    |    |    |                                |                           | /dynamodb_svr/
 22 |    |    |    |    |                                |                           | /dynamodb_svr/
 23 |    |    |    |    |                                |                           | /dynamodb_svr/
 24 |    |    |    |    |                                |                           | /dynamodb_svr/
 25 |    |    |    |    |                                |                           | /dynamodb_svr/
 26 |    |    |    |    |                                |                           | /dynamodb_svr/
 29 |    |    |    |    |                                |                           | /dynamodb_svr/
 30 |    |    |    |    |                                |                           | /dynamodb_svr/
(17 rows)

--Testcase 78:
UPDATE tntbl1 SET c2 = 10.001 WHERE c1 = 100;
ERROR:  Child node dynamodb_svr does not support transaction.
--Testcase 79:
DELETE FROM tntbl1 WHERE c1 > 100;
ERROR:  Child node dynamodb_svr does not support transaction.
--Testcase 80:
SELECT * FROM tntbl1 ORDER BY 1, 2, 3;
 c1 | c2 | c3 | c4 | c5 |               c8               |            c9             |   __spd_url    
----+----+----+----+----+--------------------------------+---------------------------+----------------
  1 |    |    |    |    |                                |                           | /dynamodb_svr/
  2 |    |    |    |    | bugle                          | foo                       | /dynamodb_svr/
  3 |    |    |    |    |                                |                           | /dynamodb_svr/
  4 |    |    |    |    |                                |                           | /dynamodb_svr/
  5 |    |    |    |    |                                |                           | /dynamodb_svr/
  6 |    |    |    |    |                                |                           | /dynamodb_svr/
  9 |    |    |    |    | xxxxxxxxxxxxxxxxxxxxxxxxx      | xxxxxxxxxxxxxxxxxxxxxxxxx | /dynamodb_svr/
 10 |    |    |    |    | 40                             | abc                       | /dynamodb_svr/
 19 |    |    |    |    |                                |                           | /dynamodb_svr/
 21 |    |    |    |    |                                |                           | /dynamodb_svr/
 22 |    |    |    |    |                                |                           | /dynamodb_svr/
 23 |    |    |    |    |                                |                           | /dynamodb_svr/
 24 |    |    |    |    |                                |                           | /dynamodb_svr/
 25 |    |    |    |    |                                |                           | /dynamodb_svr/
 26 |    |    |    |    |                                |                           | /dynamodb_svr/
 29 |    |    |    |    |                                |                           | /dynamodb_svr/
 30 |    |    |    |    |                                |                           | /dynamodb_svr/
(17 rows)

--Testcase 87:
ALTER FOREIGN TABLE tntbl1 OPTIONS (SET disable_transaction_feature_check 'true');
--Testcase 81:
INSERT INTO tntbl1 IN ('/oracle_svr/', '/tiny_svr/') VALUES (600, 120, 73.265, 78523.5, 5421659, 'Two', 'TwoTwo');
ERROR:  Can not use INSERT with IN
--Testcase 82:
SELECT * FROM tntbl1 ORDER BY 1, 2, 3;
 c1 | c2 | c3 | c4 | c5 |               c8               |            c9             |   __spd_url    
----+----+----+----+----+--------------------------------+---------------------------+----------------
  1 |    |    |    |    |                                |                           | /dynamodb_svr/
  2 |    |    |    |    | bugle                          | foo                       | /dynamodb_svr/
  3 |    |    |    |    |                                |                           | /dynamodb_svr/
  4 |    |    |    |    |                                |                           | /dynamodb_svr/
  5 |    |    |    |    |                                |                           | /dynamodb_svr/
  6 |    |    |    |    |                                |                           | /dynamodb_svr/
  9 |    |    |    |    | xxxxxxxxxxxxxxxxxxxxxxxxx      | xxxxxxxxxxxxxxxxxxxxxxxxx | /dynamodb_svr/
 10 |    |    |    |    | 40                             | abc                       | /dynamodb_svr/
 19 |    |    |    |    |                                |                           | /dynamodb_svr/
 21 |    |    |    |    |                                |                           | /dynamodb_svr/
 22 |    |    |    |    |                                |                           | /dynamodb_svr/
 23 |    |    |    |    |                                |                           | /dynamodb_svr/
 24 |    |    |    |    |                                |                           | /dynamodb_svr/
 25 |    |    |    |    |                                |                           | /dynamodb_svr/
 26 |    |    |    |    |                                |                           | /dynamodb_svr/
 29 |    |    |    |    |                                |                           | /dynamodb_svr/
 30 |    |    |    |    |                                |                           | /dynamodb_svr/
(17 rows)

--Testcase 83:
UPDATE tntbl1 IN ('/dynamodb_svr/') SET c4 = 60.0;
--Testcase 84:
SELECT * FROM tntbl1 ORDER BY 1, 2, 3;
 c1 | c2 | c3 | c4 | c5 |               c8               |            c9             |   __spd_url    
----+----+----+----+----+--------------------------------+---------------------------+----------------
  1 |    |    | 60 |    |                                |                           | /dynamodb_svr/
  2 |    |    | 60 |    | bugle                          | foo                       | /dynamodb_svr/
  3 |    |    | 60 |    |                                |                           | /dynamodb_svr/
  4 |    |    | 60 |    |                                |                           | /dynamodb_svr/
  5 |    |    | 60 |    |                                |                           | /dynamodb_svr/
  6 |    |    | 60 |    |                                |                           | /dynamodb_svr/
  9 |    |    | 60 |    | xxxxxxxxxxxxxxxxxxxxxxxxx      | xxxxxxxxxxxxxxxxxxxxxxxxx | /dynamodb_svr/
 10 |    |    | 60 |    | 40                             | abc                       | /dynamodb_svr/
 19 |    |    | 60 |    |                                |                           | /dynamodb_svr/
 21 |    |    | 60 |    |                                |                           | /dynamodb_svr/
 22 |    |    | 60 |    |                                |                           | /dynamodb_svr/
 23 |    |    | 60 |    |                                |                           | /dynamodb_svr/
 24 |    |    | 60 |    |                                |                           | /dynamodb_svr/
 25 |    |    | 60 |    |                                |                           | /dynamodb_svr/
 26 |    |    | 60 |    |                                |                           | /dynamodb_svr/
 29 |    |    | 60 |    |                                |                           | /dynamodb_svr/
 30 |    |    | 60 |    |                                |                           | /dynamodb_svr/
(17 rows)

--Testcase 85:
DELETE FROM tntbl1 IN ('/sqlite_svr/', '/tiny_svr/', '/mysql_svr/') WHERE c5 = 4000;
ERROR:  No child node support modification.
--Testcase 86:
SELECT * FROM tntbl1 ORDER BY 1, 2, 3;
 c1 | c2 | c3 | c4 | c5 |               c8               |            c9             |   __spd_url    
----+----+----+----+----+--------------------------------+---------------------------+----------------
  1 |    |    | 60 |    |                                |                           | /dynamodb_svr/
  2 |    |    | 60 |    | bugle                          | foo                       | /dynamodb_svr/
  3 |    |    | 60 |    |                                |                           | /dynamodb_svr/
  4 |    |    | 60 |    |                                |                           | /dynamodb_svr/
  5 |    |    | 60 |    |                                |                           | /dynamodb_svr/
  6 |    |    | 60 |    |                                |                           | /dynamodb_svr/
  9 |    |    | 60 |    | xxxxxxxxxxxxxxxxxxxxxxxxx      | xxxxxxxxxxxxxxxxxxxxxxxxx | /dynamodb_svr/
 10 |    |    | 60 |    | 40                             | abc                       | /dynamodb_svr/
 19 |    |    | 60 |    |                                |                           | /dynamodb_svr/
 21 |    |    | 60 |    |                                |                           | /dynamodb_svr/
 22 |    |    | 60 |    |                                |                           | /dynamodb_svr/
 23 |    |    | 60 |    |                                |                           | /dynamodb_svr/
 24 |    |    | 60 |    |                                |                           | /dynamodb_svr/
 25 |    |    | 60 |    |                                |                           | /dynamodb_svr/
 26 |    |    | 60 |    |                                |                           | /dynamodb_svr/
 29 |    |    | 60 |    |                                |                           | /dynamodb_svr/
 30 |    |    | 60 |    |                                |                           | /dynamodb_svr/
(17 rows)

--
-- Test with optional options: tntbl1
--
--
-- ON CONFLICT, this work only on postgres_fdw
--
--Testcase 88:
INSERT INTO tntbl1(c1, c2) VALUES(11, 12);  -- duplicate key
--Testcase 89:
INSERT INTO tntbl1(c1, c2) VALUES(11, 12) ON CONFLICT DO NOTHING; -- works
ERROR:  ON CONFLICT clause is not supported
--Testcase 90:
INSERT INTO tntbl1(c1, c2) VALUES(11, 12) ON CONFLICT (c1, c2) DO NOTHING; -- unsupported
ERROR:  there is no unique or exclusion constraint matching the ON CONFLICT specification
--Testcase 91:
INSERT INTO tntbl1(c1, c2) VALUES(11, 12) ON CONFLICT (c1, c2) DO UPDATE SET c3 = 562.3213; -- unsupported
ERROR:  there is no unique or exclusion constraint matching the ON CONFLICT specification
--
-- WITH CHECK, this work only on postgres_fdw
--
--Testcase 92:
CREATE VIEW rw_view AS SELECT * FROM tntbl1
  WHERE c1 < c2 WITH CHECK OPTION;
--Testcase 93:
\d+ rw_view
                                    View "public.rw_view"
  Column   |         Type          | Collation | Nullable | Default | Storage  | Description 
-----------+-----------------------+-----------+----------+---------+----------+-------------
 c1        | integer               |           |          |         | plain    | 
 c2        | smallint              |           |          |         | plain    | 
 c3        | double precision      |           |          |         | plain    | 
 c4        | double precision      |           |          |         | plain    | 
 c5        | bigint                |           |          |         | plain    | 
 c8        | character(30)         |           |          |         | extended | 
 c9        | character varying(50) |           |          |         | extended | 
 __spd_url | text                  |           |          |         | extended | 
View definition:
 SELECT tntbl1.c1,
    tntbl1.c2,
    tntbl1.c3,
    tntbl1.c4,
    tntbl1.c5,
    tntbl1.c8,
    tntbl1.c9,
    tntbl1.__spd_url
   FROM tntbl1
  WHERE tntbl1.c1 < tntbl1.c2;
Options: check_option=cascaded

--Testcase 94:
EXPLAIN (VERBOSE, COSTS OFF)
INSERT INTO rw_view(c1, c2) VALUES (5, 0);
ERROR:  WITH CHECK clause is not supported
--Testcase 95:
INSERT INTO rw_view(c1, c2) VALUES (5, 0); -- should fail
ERROR:  WITH CHECK clause is not supported
--Testcase 96:
EXPLAIN (VERBOSE, COSTS OFF)
INSERT INTO rw_view(c1, c2) VALUES (0, 15);
ERROR:  WITH CHECK clause is not supported
--Testcase 97:
INSERT INTO rw_view(c1, c2) VALUES (0, 15); -- ok
ERROR:  WITH CHECK clause is not supported
--Testcase 98:
SELECT * FROM tntbl1 ORDER BY 1, 2, 3;
 c1 | c2 | c3 | c4 | c5 |               c8               |            c9             |   __spd_url    
----+----+----+----+----+--------------------------------+---------------------------+----------------
  1 |    |    | 60 |    |                                |                           | /dynamodb_svr/
  2 |    |    | 60 |    | bugle                          | foo                       | /dynamodb_svr/
  3 |    |    | 60 |    |                                |                           | /dynamodb_svr/
  4 |    |    | 60 |    |                                |                           | /dynamodb_svr/
  5 |    |    | 60 |    |                                |                           | /dynamodb_svr/
  6 |    |    | 60 |    |                                |                           | /dynamodb_svr/
  9 |    |    | 60 |    | xxxxxxxxxxxxxxxxxxxxxxxxx      | xxxxxxxxxxxxxxxxxxxxxxxxx | /dynamodb_svr/
 10 |    |    | 60 |    | 40                             | abc                       | /dynamodb_svr/
 11 | 12 |    |    |    |                                |                           | /dynamodb_svr/
 19 |    |    | 60 |    |                                |                           | /dynamodb_svr/
 21 |    |    | 60 |    |                                |                           | /dynamodb_svr/
 22 |    |    | 60 |    |                                |                           | /dynamodb_svr/
 23 |    |    | 60 |    |                                |                           | /dynamodb_svr/
 24 |    |    | 60 |    |                                |                           | /dynamodb_svr/
 25 |    |    | 60 |    |                                |                           | /dynamodb_svr/
 26 |    |    | 60 |    |                                |                           | /dynamodb_svr/
 29 |    |    | 60 |    |                                |                           | /dynamodb_svr/
 30 |    |    | 60 |    |                                |                           | /dynamodb_svr/
(18 rows)

--Testcase 99:
EXPLAIN (VERBOSE, COSTS OFF)
UPDATE rw_view SET c1 = c1 + 100;
ERROR:  WITH CHECK clause is not supported
--Testcase 100:
UPDATE rw_view SET c1 = c1 + 100; -- should fail
ERROR:  WITH CHECK clause is not supported
--Testcase 101:
EXPLAIN (VERBOSE, COSTS OFF)
UPDATE rw_view SET c2 = c2 + 15;
ERROR:  WITH CHECK clause is not supported
--Testcase 102:
UPDATE rw_view SET c2 = c2 + 15; -- ok
ERROR:  WITH CHECK clause is not supported
--Testcase 103:
SELECT * FROM tntbl1 ORDER BY 1, 2, 3;
 c1 | c2 | c3 | c4 | c5 |               c8               |            c9             |   __spd_url    
----+----+----+----+----+--------------------------------+---------------------------+----------------
  1 |    |    | 60 |    |                                |                           | /dynamodb_svr/
  2 |    |    | 60 |    | bugle                          | foo                       | /dynamodb_svr/
  3 |    |    | 60 |    |                                |                           | /dynamodb_svr/
  4 |    |    | 60 |    |                                |                           | /dynamodb_svr/
  5 |    |    | 60 |    |                                |                           | /dynamodb_svr/
  6 |    |    | 60 |    |                                |                           | /dynamodb_svr/
  9 |    |    | 60 |    | xxxxxxxxxxxxxxxxxxxxxxxxx      | xxxxxxxxxxxxxxxxxxxxxxxxx | /dynamodb_svr/
 10 |    |    | 60 |    | 40                             | abc                       | /dynamodb_svr/
 11 | 12 |    |    |    |                                |                           | /dynamodb_svr/
 19 |    |    | 60 |    |                                |                           | /dynamodb_svr/
 21 |    |    | 60 |    |                                |                           | /dynamodb_svr/
 22 |    |    | 60 |    |                                |                           | /dynamodb_svr/
 23 |    |    | 60 |    |                                |                           | /dynamodb_svr/
 24 |    |    | 60 |    |                                |                           | /dynamodb_svr/
 25 |    |    | 60 |    |                                |                           | /dynamodb_svr/
 26 |    |    | 60 |    |                                |                           | /dynamodb_svr/
 29 |    |    | 60 |    |                                |                           | /dynamodb_svr/
 30 |    |    | 60 |    |                                |                           | /dynamodb_svr/
(18 rows)

--Testcase 104:
DROP VIEW rw_view;
--
-- RETURNING
--
--Testcase 105:
INSERT INTO tntbl1 VALUES (1, 2, 3.0, 6.0, 21, 'test1', 'test1') RETURNING *;
ERROR:  RETURNING clause is not supported
--Testcase 106:
INSERT INTO tntbl1 (c1, c2, c3, c4, c5) VALUES (2, 3, 4.0, 5.0, 6) RETURNING c1, c4;
ERROR:  RETURNING clause is not supported
--Testcase 108:
DELETE FROM tntbl1 WHERE c4 = 6.0 RETURNING c1, c2;
ERROR:  RETURNING clause is not supported
--Testcase 109:
DELETE FROM tntbl1 RETURNING *;
ERROR:  RETURNING clause is not supported
--Clean
DELETE FROM tntbl1;
--Testcase 110:
DROP FOREIGN TABLE tntbl1 CASCADE;
--Testcase 111:
DROP USER MAPPING FOR CURRENT_USER SERVER pgspider_svr;
--Testcase 112:
DROP EXTENSION dynamodb_fdw CASCADE;
NOTICE:  drop cascades to 3 other objects
DETAIL:  drop cascades to server dynamodb_svr
drop cascades to user mapping for public on server dynamodb_svr
drop cascades to foreign table tntbl1__dynamodb_svr__0
--Testcase 113:
DROP SERVER pgspider_svr CASCADE;
--Testcase 114:
DROP EXTENSION pgspider_core_fdw CASCADE;
